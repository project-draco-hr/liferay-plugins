{
  if (!isAccountExists(emailAddress)) {
    return;
  }
  User user=getUser();
  String filePath=getMessageFilePath(emailAddress,folderName,messageUid);
  try {
    FileUtil.write(filePath,message.toString());
  }
 catch (  IOException ioe) {
    _log.error(ioe,ioe);
  }
  String subject=message.getString("subject");
  String body=message.getString("body");
  try {
    Indexer.addMessage(user.getCompanyId(),user.getGroup().getGroupId(),user.getUserId(),emailAddress,_encodeFolderName(folderName),messageUid,subject,body);
  }
 catch (  Exception e) {
    _log.error(e,e);
  }
}
