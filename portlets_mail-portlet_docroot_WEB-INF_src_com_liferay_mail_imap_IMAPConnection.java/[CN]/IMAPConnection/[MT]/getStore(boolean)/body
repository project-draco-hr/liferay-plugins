{
  Store store=null;
  String storeKey=_incomingHostName + _outgoingHostName + _login;
  if (useOldStores) {
    store=_allStores.get(storeKey);
    if (Validator.isNotNull(store) && !store.isConnected()) {
      store.close();
      store=null;
    }
  }
  if (Validator.isNull(store)) {
    Session session=getSession();
    if (_incomingSecure) {
      store=session.getStore("imaps");
    }
 else {
      store=session.getStore("imap");
    }
    store.addConnectionListener(new ConnectionListener(storeKey));
    store.connect(_incomingHostName,_incomingPort,_login,_password);
    if (useOldStores) {
      _allStores.put(storeKey,store);
    }
  }
  return store;
}
