{
  Group group=GroupLocalServiceUtil.getGroup(companyId,GroupConstants.GUEST);
  addJournalStructure(defaultUserId,group.getGroupId());
  addJournalTemplate(defaultUserId,group.getGroupId());
  ServiceContext serviceContext=new ServiceContext();
  serviceContext.setAddCommunityPermissions(true);
  serviceContext.setAddGuestPermissions(true);
  serviceContext.setScopeGroupId(group.getGroupId());
  IGFolder igFolder=IGFolderLocalServiceUtil.addFolder(defaultUserId,0,"Web Content","Images used for content",serviceContext);
  IGImage cellBgIGImage=addIGImage(defaultUserId,igFolder.getFolderId(),"cell_bg.png",serviceContext);
  IGImage portalMashupIGImage=addIGImage(defaultUserId,igFolder.getFolderId(),"portal_mashup.png",serviceContext);
  IGImage sevenCogsAdIGImage=addIGImage(defaultUserId,igFolder.getFolderId(),"sevencogs_ad.png",serviceContext);
  IGImage sharedWorkspacesIGImage=addIGImage(defaultUserId,igFolder.getFolderId(),"shared_workspaces.png",serviceContext);
  IGImage socialNetworkingIGImage=addIGImage(defaultUserId,igFolder.getFolderId(),"social_network.png",serviceContext);
  IGImage webPublishingIGImage=addIGImage(defaultUserId,igFolder.getFolderId(),"web_publishing.png",serviceContext);
  Layout layout=addLayout(group,"Welcome",false,"/home","2_columns_iii");
  String portletId=addPortletId(layout,PortletKeys.JOURNAL_CONTENT,"column-1");
  removePortletBorder(layout,portletId);
  serviceContext.setAssetTagNames(new String[]{"liferay","welcome"});
  JournalArticle journalArticle=addJournalArticle(defaultUserId,group.getGroupId(),"Welcome","welcome.xml",serviceContext);
  String content=StringUtil.replace(journalArticle.getContent(),new String[]{"[$CELL_BG_IG_IMAGE_UUID$]","[$GROUP_ID$]","[$PORTAL_MASHUPS_IG_IMAGE_UUID$]","[$SHARED_WORKSPACES_IG_IMAGE_UUID$]","[$SOCIAL_NETWORKING_IG_IMAGE_UUID$]","[$WEB_PUBLISHING_IG_IMAGE_UUID$]"},new String[]{String.valueOf(cellBgIGImage.getUuid()),String.valueOf(group.getGroupId()),String.valueOf(portalMashupIGImage.getUuid()),String.valueOf(sharedWorkspacesIGImage.getUuid()),String.valueOf(socialNetworkingIGImage.getUuid()),String.valueOf(webPublishingIGImage.getUuid())});
  JournalArticleLocalServiceUtil.updateContent(group.getGroupId(),journalArticle.getArticleId(),journalArticle.getVersion(),content);
  configureJournalContent(layout,portletId,journalArticle.getArticleId());
  portletId=addPortletId(layout,PortletKeys.JOURNAL_CONTENT,"column-2");
  removePortletBorder(layout,portletId);
  serviceContext.setAssetTagNames(new String[]{"liferay","7cogs"});
  journalArticle=addJournalArticle(defaultUserId,group.getGroupId(),"7 Cogs Ad","7cogs_ad.xml",serviceContext);
  content=StringUtil.replace(journalArticle.getContent(),new String[]{"[$GROUP_ID$]","[$SEVEN_COGS_IG_IMAGE_UUID$]"},new String[]{String.valueOf(group.getGroupId()),String.valueOf(sevenCogsAdIGImage.getUuid())});
  JournalArticleLocalServiceUtil.updateContent(group.getGroupId(),journalArticle.getArticleId(),journalArticle.getVersion(),content);
  configureJournalContent(layout,portletId,journalArticle.getArticleId());
  portletId=addPortletId(layout,PortletKeys.JOURNAL_CONTENT,"column-2");
  removePortletBorder(layout,portletId);
  serviceContext.setAssetTagNames(new String[]{"welcome"});
  journalArticle=addJournalArticle(defaultUserId,group.getGroupId(),"Welcome Note","welcome_note.xml",serviceContext);
  configureJournalContent(layout,portletId,journalArticle.getArticleId());
  portletId=addPortletId(layout,PortletKeys.JOURNAL_CONTENT,"column-2");
  serviceContext.setAssetTagNames(new String[]{"login","users","welcome"});
  journalArticle=addJournalArticle(defaultUserId,group.getGroupId(),"Welcome Login","welcome_login.xml",serviceContext);
  content=StringUtil.replace(journalArticle.getContent(),"[$COMPANY_ID$]",String.valueOf(companyId));
  JournalArticleLocalServiceUtil.updateContent(group.getGroupId(),journalArticle.getArticleId(),journalArticle.getVersion(),content);
  configureJournalContent(layout,portletId,journalArticle.getArticleId());
  configurePortletTitle(layout,portletId,"Current Users");
  addPortletId(layout,PortletKeys.LOGIN,"column-2");
}
