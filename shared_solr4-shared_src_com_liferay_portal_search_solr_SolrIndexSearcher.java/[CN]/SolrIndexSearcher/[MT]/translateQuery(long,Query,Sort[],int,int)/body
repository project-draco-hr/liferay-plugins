{
  QueryConfig queryConfig=query.getQueryConfig();
  SolrQuery solrQuery=new SolrQuery();
  solrQuery.setIncludeScore(queryConfig.isScoreEnabled());
  QueryTranslatorUtil.translateForSolr(query);
  String queryString=query.toString();
  StringBundler sb=new StringBundler(6);
  sb.append(queryString);
  sb.append(StringPool.SPACE);
  sb.append(StringPool.PLUS);
  sb.append(Field.COMPANY_ID);
  sb.append(StringPool.COLON);
  sb.append(companyId);
  solrQuery.setQuery(sb.toString());
  if ((start == QueryUtil.ALL_POS) && (end == QueryUtil.ALL_POS)) {
    solrQuery.setRows(0);
  }
 else {
    solrQuery.setRows(end - start);
    solrQuery.setStart(start);
  }
  if (sorts != null) {
    for (    Sort sort : sorts) {
      if (sort == null) {
        continue;
      }
      String sortFieldName=DocumentImpl.getSortFieldName(sort,"score");
      ORDER order=ORDER.asc;
      if (sort.isReverse() || sortFieldName.equals("score")) {
        order=ORDER.desc;
      }
      solrQuery.addSort(new SortClause(sortFieldName,order));
    }
  }
  return solrQuery;
}
