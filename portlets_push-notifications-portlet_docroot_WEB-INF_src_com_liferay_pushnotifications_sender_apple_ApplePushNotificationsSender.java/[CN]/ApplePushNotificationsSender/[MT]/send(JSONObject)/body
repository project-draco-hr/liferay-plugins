{
  long userId=jsonObj.getLong("userId");
  String payload=null;
  try {
    List<String> tokens=PushNotificationsDeviceLocalServiceUtil.getTokens(userId,IOS,QueryUtil.ALL_POS,QueryUtil.ALL_POS);
    if (tokens.isEmpty()) {
      return;
    }
    payload=buildPayload(jsonObj);
    _apnsService.push(tokens,payload);
  }
 catch (  Exception e) {
    _log.error("Could not send notification " + payload,e);
  }
}
