{
  ExpandoColumn column=ExpandoColumnLocalServiceUtil.getColumn(companyId,className,name,columnName);
  DBCollection collection=MongoDBUtil.getCollection(companyId,className,name);
  List<ExpandoValue> values=new ArrayList<ExpandoValue>();
  DBCursor cursor=null;
  if (Validator.isNotNull(data)) {
    BasicDBObject query=new BasicDBObject();
    ExpandoValue value=new MongoExpandoValue();
    value.setColumnId(column.getColumnId());
    value.setData(data);
    try {
      query.put(columnName,getData(column,value));
    }
 catch (    PortalException e) {
      throw new SystemException(e);
    }
    cursor=collection.find(query);
  }
 else {
    cursor=collection.find();
  }
  if ((start != QueryUtil.ALL_POS) && end != QueryUtil.ALL_POS) {
    cursor=cursor.skip(start).limit(end - start);
  }
  for (  DBObject dbObject : cursor.toArray()) {
    BasicDBObject basicDBObject=(BasicDBObject)dbObject;
    ExpandoValue value=new MongoExpandoValue();
    value.setCompanyId(basicDBObject.getLong("companyId"));
    value.setTableId(basicDBObject.getLong("tableId"));
    value.setColumnId(column.getColumnId());
    value.setRowId(basicDBObject.getLong("rowId"));
    value.setClassNameId(basicDBObject.getLong("classNameId"));
    value.setClassPK(basicDBObject.getLong("classPK"));
    try {
      putData(column,value,dbObject);
    }
 catch (    PortalException e) {
      throw new SystemException(e);
    }
    values.add(value);
  }
  return values;
}
