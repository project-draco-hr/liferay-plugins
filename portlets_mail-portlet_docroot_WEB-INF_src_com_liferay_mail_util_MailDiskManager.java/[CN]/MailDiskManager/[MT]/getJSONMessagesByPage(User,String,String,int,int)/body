{
  if (Validator.isNull(user) || Validator.isNull(emailAddress) || Validator.isNull(folderName)) {
    return null;
  }
  try {
    String folderFilePath=_getFolderFilePath(user,emailAddress,folderName);
    JSONObject jsonFolderObj=JSONFactoryUtil.createJSONObject(FileUtil.read(folderFilePath));
    int messageCount=jsonFolderObj.getInt("messageCount");
    long[] messageUids=getMessageUidsByFolder(user,emailAddress,folderName);
    int messagesOnDiskCount=messageUids.length;
    return getJSONPaginatedMessages(user,emailAddress,folderName,messageUids,pageNumber,messagesPerPage,messageCount,messagesOnDiskCount);
  }
 catch (  IOException ioe) {
    _log.error(ioe,ioe);
  }
catch (  JSONException jsone) {
    _log.error(jsone,jsone);
  }
  return null;
}
