{
  int begin=(messagesOnDiskCount + 1) - (messagesPerPage * pageNumber) - 1;
  int end=messagesOnDiskCount - (messagesPerPage * (pageNumber - 1)) - 1;
  if (begin < 0) {
    begin=0;
  }
  double pageCount=Math.ceil((double)messageCount / messagesPerPage);
  JSONObject jsonObj=JSONFactoryUtil.createJSONObject();
  JSONArray jsonArray=JSONFactoryUtil.createJSONArray();
  jsonObj.put("messages",jsonArray);
  jsonObj.put("messageCount",messageCount);
  jsonObj.put("messagesPerPage",messagesPerPage);
  jsonObj.put("pageCount",(int)pageCount);
  jsonObj.put("pageNumber",pageNumber);
  for (int i=begin; i <= end; i++) {
    jsonArray.put(getJSONMessageByUid(user,emailAddress,folderName,messageUidsOnDisk[i]));
  }
  return jsonObj;
}
