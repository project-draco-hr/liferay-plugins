{
  Response samlResponse=context.getOutboundSAMLMessage();
  try {
    if (context.getOuboundSAMLMessageSigningCredential() != null) {
      OpenSAMLUtil.signObject(context.getOutboundSAMLMessage(),context.getOuboundSAMLMessageSigningCredential());
    }
    String encodedSAMLResponse=OpenSAMLUtil.encodeSAMLObject(samlResponse);
    response.setHeader(HttpHeaders.CACHE_CONTROL,HttpHeaders.CACHE_CONTROL_NO_CACHE_NO_STORE_VALUE);
    response.setHeader(HttpHeaders.PRAGMA,HttpHeaders.CACHE_CONTROL_NO_CACHE_VALUE);
    request.setAttribute("SAMLResponse",encodedSAMLResponse);
    if (context.getRelayState() != null) {
      request.setAttribute("RelayState",context.getRelayState());
    }
    request.setAttribute("action",context.getPeerEntityEndpoint().getLocation());
  }
 catch (  Exception e) {
    throw new PortalException(e);
  }
  try {
    request.getRequestDispatcher("/html/portal/saml/http_post_binding.jsp").include(request,response);
  }
 catch (  Exception e) {
    throw new SystemException(e);
  }
}
