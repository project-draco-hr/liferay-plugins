{
  String wsdl=getWSDL(url,userToken);
  Date now=new Date();
  validate(name);
  long wsrpConsumerId=CounterLocalServiceUtil.increment();
  WSRPConsumer wsrpConsumer=wsrpConsumerPersistence.create(wsrpConsumerId);
  if (serviceContext != null) {
    String uuid=serviceContext.getUuid();
    if (Validator.isNotNull(uuid)) {
      wsrpConsumer.setUuid(uuid);
    }
  }
  wsrpConsumer.setCompanyId(companyId);
  wsrpConsumer.setCreateDate(now);
  wsrpConsumer.setModifiedDate(now);
  wsrpConsumer.setName(name);
  wsrpConsumer.setUrl(url);
  wsrpConsumer.setWsdl(wsdl);
  wsrpConsumerPersistence.update(wsrpConsumer,false);
  return wsrpConsumer;
}
