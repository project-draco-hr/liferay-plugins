{
  com.liferay.mail.model.Message storedMessage=null;
  try {
    storedMessage=MessageLocalServiceUtil.getRemoteMessage(storedFolderId,oldest);
  }
 catch (  NoSuchMessageException nsme) {
    return null;
  }
  long messageId=storedMessage.getRemoteMessageId();
  Message message=getMessage(imapFolder,messageId);
  if (message == null) {
    MessageLocalServiceUtil.deleteMessage(storedMessage);
    return getMessage(storedFolderId,imapFolder,oldest);
  }
 else {
    return message;
  }
}
