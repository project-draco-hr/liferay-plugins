{
  Message message=MessageLocalServiceUtil.getRemoteMessage(folderId,oldest);
  if (message == null) {
    return null;
  }
 else {
    javax.mail.Message remoteMessage=getMessage(imapFolder,message.getRemoteMessageId());
    if (remoteMessage == null) {
      MessageLocalServiceUtil.deleteMessage(message);
      return getStoredMessage(imapFolder,folderId,oldest);
    }
 else {
      return remoteMessage;
    }
  }
}
