{
  IMAPFolder imapFolder=null;
  try {
    imapFolder=openFolder(storedFolderId);
    Message message=getMessage(imapFolder,messageId);
    if (message == null) {
      throw new MailException(MailException.MESSAGE_NOT_FOUND_ON_SERVER);
    }
    Part part=getPart(message,contentPath);
    return part.getInputStream();
  }
 catch (  MessagingException me) {
    throw new MailException(me);
  }
 finally {
    closeFolder(imapFolder,false);
  }
}
