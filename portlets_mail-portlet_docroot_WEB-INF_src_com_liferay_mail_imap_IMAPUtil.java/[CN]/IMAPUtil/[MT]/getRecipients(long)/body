{
  try {
    com.liferay.mail.model.Message storedMessage=MessageLocalServiceUtil.getMessage(storedMessageId);
    StringBundler sb=new StringBundler(6);
    sb.append(storedMessage.getTo());
    sb.append(StringPool.COMMA);
    sb.append(storedMessage.getCc());
    sb.append(StringPool.COMMA);
    sb.append(storedMessage.getBcc());
    sb.append(StringPool.COMMA);
    return InternetAddress.parse(sb.toString(),true);
  }
 catch (  AddressException ae) {
    throw new MailException(MailException.MESSAGE_INVALID_ADDRESS,ae);
  }
}
