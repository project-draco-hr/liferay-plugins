{
  StringBuilder sb=new StringBuilder();
  sb.append("/consumer");
  addPathElement(sb,portletURL.getPortletId());
  portletURL.addParameterIncludedInPath("p_p_id");
  WindowState windowState=portletURL.getWindowState();
  if (windowState != null) {
    addPathElement(sb,windowState.toString());
  }
 else {
    addPathElement(sb,null);
  }
  portletURL.addParameterIncludedInPath("p_p_state");
  PortletMode portletMode=portletURL.getPortletMode();
  if (portletMode != null) {
    addPathElement(sb,portletMode.toString());
  }
 else {
    addPathElement(sb,null);
  }
  portletURL.addParameterIncludedInPath("p_p_mode");
  addPathElement(sb,portletURL.getResourceID());
  portletURL.addParameterIncludedInPath("p_p_resource_id");
  addPathElement(sb,portletURL.getCacheability());
  portletURL.addParameterIncludedInPath("p_p_cacheability");
  Map<String,String[]> parameterMap=portletURL.getParameterMap();
  String[] navigationalState=parameterMap.get("wsrp-navigationalState");
  if (navigationalState != null && navigationalState.length > 0) {
    addPathElement(sb,navigationalState[0]);
    portletURL.addParameterIncludedInPath("wsrp-navigationalState");
  }
  return sb.toString();
}
