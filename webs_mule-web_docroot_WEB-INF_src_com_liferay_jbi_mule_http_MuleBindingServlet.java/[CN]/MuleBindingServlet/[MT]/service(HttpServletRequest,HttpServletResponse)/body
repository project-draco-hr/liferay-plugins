{
  String contentType=request.getHeader(HttpHeaders.CONTENT_TYPE);
  if (_log.isDebugEnabled()) {
    _log.debug("Content type " + contentType);
  }
  if ((contentType != null) && (contentType.startsWith(ContentTypes.MULTIPART_FORM_DATA))) {
    request=PortalUtil.getUploadServletRequest(request);
  }
  try {
    MuleClient client=new MuleClient();
    Map payload=new HashMap();
    Enumeration enu=request.getParameterNames();
    while (enu.hasMoreElements()) {
      try {
        String name=(String)enu.nextElement();
        String value=request.getParameter(name);
        payload.put(name,value);
      }
 catch (      Exception e) {
      }
    }
    UMOMessage message=client.send(_endpoint,payload,null);
    String result=(String)message.getPayload();
    response.setContentType("text/xml");
    try {
      ServletResponseUtil.write(response,result);
    }
 catch (    Exception e) {
      if (_log.isWarnEnabled()) {
        _log.warn(e,e);
      }
    }
  }
 catch (  UMOException ue) {
  }
}
