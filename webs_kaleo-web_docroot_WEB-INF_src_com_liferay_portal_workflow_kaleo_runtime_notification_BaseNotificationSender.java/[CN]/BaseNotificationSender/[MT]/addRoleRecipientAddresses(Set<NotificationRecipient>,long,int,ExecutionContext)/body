{
  if (roleType == RoleConstants.TYPE_REGULAR) {
    List<User> users=UserLocalServiceUtil.getRoleUsers(roleId);
    for (    User user : users) {
      if (user.isActive()) {
        NotificationRecipient notificationRecipient=new NotificationRecipient(user);
        notificationRecipients.add(notificationRecipient);
      }
    }
  }
 else {
    KaleoInstanceToken kaleoInstanceToken=executionContext.getKaleoInstanceToken();
    long groupId=kaleoInstanceToken.getGroupId();
    List<UserGroupRole> userGroupRoles=UserGroupRoleLocalServiceUtil.getUserGroupRolesByGroupAndRole(groupId,roleId);
    for (    UserGroupRole userGroupRole : userGroupRoles) {
      User user=userGroupRole.getUser();
      if (user.isActive()) {
        NotificationRecipient notificationRecipient=new NotificationRecipient(user);
        notificationRecipients.add(notificationRecipient);
      }
    }
    List<UserGroupGroupRole> userGroupGroupRoles=UserGroupGroupRoleLocalServiceUtil.getUserGroupGroupRolesByGroupAndRole(groupId,roleId);
    for (    UserGroupGroupRole userGroupGroupRole : userGroupGroupRoles) {
      long userGroupId=userGroupGroupRole.getUserGroupId();
      List<User> users=UserLocalServiceUtil.getUserGroupUsers(userGroupId);
      for (      User user : users) {
        if (user.isActive()) {
          NotificationRecipient notificationRecipient=new NotificationRecipient(user);
          notificationRecipients.add(notificationRecipient);
        }
      }
    }
  }
}
