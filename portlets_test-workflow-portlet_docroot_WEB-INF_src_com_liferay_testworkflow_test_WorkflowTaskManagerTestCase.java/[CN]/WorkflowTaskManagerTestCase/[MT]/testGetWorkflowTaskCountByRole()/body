{
  int count=WorkflowTaskManagerUtil.getWorkflowTaskCountByRole(companyId,guestRoleId,null);
  assertEquals(0,count);
  WorkflowInstance workflowInstance=WorkflowInstanceManagerUtil.startWorkflowInstance(companyId,defaultUserId,DEFINITION_NAME_3,_workflowDefinition.getVersion(),null,null);
  List<WorkflowInstance> childrenWorkflowInstances=workflowInstance.getChildrenWorkflowInstances();
  for (  WorkflowInstance childWorkflowInstance : childrenWorkflowInstances) {
    List<WorkflowTask> childWorkflowTasks=WorkflowTaskManagerUtil.getWorkflowTasksByWorkflowInstance(companyId,childWorkflowInstance.getWorkflowInstanceId(),null,QueryUtil.ALL_POS,QueryUtil.ALL_POS,WorkflowComparatorFactoryUtil.getTaskNameComparator(true));
    assertEquals(1,childWorkflowTasks.size());
    WorkflowTask childWorkflowTask=childWorkflowTasks.get(0);
    assertEquals(0L,childWorkflowTask.getAssigneeRoleId());
    childWorkflowTask=WorkflowTaskManagerUtil.assignWorkflowTaskToRole(companyId,defaultUserId,childWorkflowTask.getWorkflowTaskId(),guestRoleId,null,null);
    childWorkflowTask=WorkflowTaskManagerUtil.assignWorkflowTaskToUser(companyId,defaultUserId,childWorkflowTask.getWorkflowTaskId(),defaultUserId,null,null);
    assertEquals(guestRoleId,childWorkflowTask.getAssigneeRoleId());
  }
  count=WorkflowTaskManagerUtil.getWorkflowTaskCountByRole(companyId,guestRoleId,null);
  assertEquals(3,count);
  count=WorkflowTaskManagerUtil.getWorkflowTaskCountByRole(companyId,guestRoleId,Boolean.TRUE);
  assertEquals(0,count);
  count=WorkflowTaskManagerUtil.getWorkflowTaskCountByRole(companyId,guestRoleId,Boolean.FALSE);
  assertEquals(3,count);
  for (  WorkflowInstance childWorkflowInstance : childrenWorkflowInstances) {
    List<WorkflowTask> childWorkflowTasks=WorkflowTaskManagerUtil.getWorkflowTasksByWorkflowInstance(companyId,childWorkflowInstance.getWorkflowInstanceId(),null,QueryUtil.ALL_POS,QueryUtil.ALL_POS,WorkflowComparatorFactoryUtil.getTaskNameComparator(true));
    assertEquals(1,childWorkflowTasks.size());
    WorkflowTask childWorkflowTask=childWorkflowTasks.get(0);
    WorkflowTaskManagerUtil.completeWorkflowTask(companyId,defaultUserId,childWorkflowTask.getWorkflowTaskId(),null,null,null);
  }
  count=WorkflowTaskManagerUtil.getWorkflowTaskCountByRole(companyId,guestRoleId,null);
  assertEquals(3,count);
  count=WorkflowTaskManagerUtil.getWorkflowTaskCountByRole(companyId,guestRoleId,Boolean.TRUE);
  assertEquals(3,count);
  count=WorkflowTaskManagerUtil.getWorkflowTaskCountByRole(companyId,guestRoleId,Boolean.FALSE);
  assertEquals(0,count);
  WorkflowInstanceManagerUtil.deleteWorkflowInstance(companyId,workflowInstance.getWorkflowInstanceId());
}
