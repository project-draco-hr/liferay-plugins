{
  StagedModelDataHandlerUtil.importReferenceStagedModel(portletDataContext,consumerPortlet,WSRPConsumer.class,consumerPortlet.getWsrpConsumerId());
  Map<Long,Long> consumerIds=(Map<Long,Long>)portletDataContext.getNewPrimaryKeysMap(WSRPConsumer.class);
  long consumerId=MapUtil.getLong(consumerIds,consumerPortlet.getWsrpConsumerId(),consumerPortlet.getWsrpConsumerId());
  ServiceContext serviceContext=portletDataContext.createServiceContext(consumerPortlet);
  WSRPConsumerPortlet importedConsumerPortlet=null;
  if (portletDataContext.isDataStrategyMirror()) {
    WSRPConsumerPortlet existingConsumerPortlet=WSRPConsumerPortletLocalServiceUtil.fetchWSRPConsumerPortletByUuidAndCompanyId(consumerPortlet.getUuid(),portletDataContext.getCompanyId());
    if (existingConsumerPortlet == null) {
      serviceContext.setUuid(consumerPortlet.getUuid());
      importedConsumerPortlet=WSRPConsumerPortletLocalServiceUtil.addWSRPConsumerPortlet(consumerId,consumerPortlet.getName(),consumerPortlet.getPortletHandle(),serviceContext);
    }
 else {
      existingConsumerPortlet.setWsrpConsumerId(consumerId);
      existingConsumerPortlet.setName(consumerPortlet.getName());
      existingConsumerPortlet.setPortletHandle(consumerPortlet.getPortletHandle());
      importedConsumerPortlet=WSRPConsumerPortletLocalServiceUtil.updateWSRPConsumerPortlet(existingConsumerPortlet);
    }
  }
 else {
    importedConsumerPortlet=WSRPConsumerPortletLocalServiceUtil.addWSRPConsumerPortlet(consumerId,consumerPortlet.getName(),consumerPortlet.getPortletHandle(),serviceContext);
  }
  portletDataContext.importClassedModel(consumerPortlet,importedConsumerPortlet);
}
