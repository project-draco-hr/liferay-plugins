{
  Connection con=null;
  PreparedStatement ps=null;
  ResultSet rs=null;
  try {
    con=DataAccess.getUpgradeOptimizedConnection();
    StringBuilder sb=new StringBuilder(11);
    sb.append("select classPK from ExpandoValue ");
    sb.append("inner join ExpandoColumn on ");
    sb.append("((ExpandoValue.columnId = ExpandoColumn.columnId) and ");
    sb.append("(ExpandoColumn.name = 'socialOfficeEnabled')) ");
    sb.append("inner join ExpandoTable on ");
    sb.append("((ExpandoValue.tableId = ExpandoTable.tableId) and ");
    sb.append("(ExpandoTable.name = '");
    sb.append(ExpandoTableConstants.DEFAULT_TABLE_NAME);
    sb.append("')) where (ExpandoValue.classNameId = '");
    sb.append(PortalUtil.getClassNameId(Group.class));
    sb.append("') and (ExpandoValue.data_ = 'true')");
    ps=con.prepareStatement(sb.toString());
    rs=ps.executeQuery();
    while (rs.next()) {
      long classPK=rs.getLong("classPK");
      LayoutSetLocalServiceUtil.updateLookAndFeel(classPK,"so_WAR_sotheme","01",StringPool.BLANK,false);
    }
  }
  finally {
    DataAccess.cleanUp(con,ps,rs);
  }
}
