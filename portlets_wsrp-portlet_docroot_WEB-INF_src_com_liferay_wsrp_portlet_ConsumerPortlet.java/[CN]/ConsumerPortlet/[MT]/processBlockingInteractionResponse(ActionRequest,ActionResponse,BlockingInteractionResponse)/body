{
  PortletSession portletSession=actionRequest.getPortletSession();
  UpdateResponse updateResponse=blockingInteractionResponse.getUpdateResponse();
  String redirectURL=blockingInteractionResponse.getRedirectURL();
  if (Validator.isNotNull(redirectURL)) {
    actionResponse.sendRedirect(redirectURL);
    return;
  }
  portletSession.setAttribute(_MARKUP_CONTEXT,updateResponse.getMarkupContext());
  portletSession.setAttribute(_NAVIGATIONAL_CONTEXT,updateResponse.getNavigationalContext());
  portletSession.setAttribute(_PORTLET_CONTEXT,updateResponse.getPortletContext());
  String mode=updateResponse.getNewMode();
  if (Validator.isNotNull(mode)) {
    actionResponse.setPortletMode(new PortletMode(mode.substring(5)));
  }
  String windowState=updateResponse.getNewWindowState();
  if (Validator.isNotNull(windowState)) {
    actionResponse.setWindowState(new WindowState(windowState.substring(5)));
  }
  portletSession.setAttribute(_SESSION_CONTEXT,updateResponse.getSessionContext());
}
