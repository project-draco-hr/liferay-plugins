{
  String url=ParamUtil.getString(actionRequest,"url");
  File tempFile=null;
  try {
    URL urlObj=new URL(url);
    InputStream inputStream=urlObj.openStream();
    tempFile=FileUtil.createTempFile();
    FileUtil.write(tempFile,inputStream);
    String deployDir=PrefsPropsUtil.getString(PropsKeys.AUTO_DEPLOY_DEPLOY_DIR);
    String fileName=url.substring(url.lastIndexOf(CharPool.SLASH) + 1);
    String destination=deployDir + StringPool.SLASH + fileName;
    File destinationFile=new File(destination);
    boolean moved=FileUtil.move(tempFile,destinationFile);
    if (!moved) {
      FileUtil.copyFile(tempFile,destinationFile);
      FileUtil.delete(tempFile);
    }
    SessionMessages.add(actionRequest,"pluginDownloaded");
  }
 catch (  MalformedURLException murle) {
    SessionErrors.add(actionRequest,"invalidUrl",murle);
  }
catch (  IOException ioe) {
    SessionErrors.add(actionRequest,"errorConnectingToUrl",ioe);
  }
 finally {
    if (tempFile != null) {
      tempFile.delete();
    }
  }
}
