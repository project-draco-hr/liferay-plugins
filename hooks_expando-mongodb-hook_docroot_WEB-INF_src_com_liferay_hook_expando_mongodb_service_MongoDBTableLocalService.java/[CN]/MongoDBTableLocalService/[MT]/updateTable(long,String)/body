{
  ExpandoTable table=super.getTable(tableId);
  DB db=MongoDBUtil.getDB(table.getCompanyId());
  String tableName=MongoDBUtil.collectionName(table.getClassName(),table.getName());
  String newTableName=MongoDBUtil.collectionName(table.getClassName(),name);
  if (db.collectionExists(newTableName)) {
    throw new DuplicateTableNameException(name);
  }
  table=super.updateTable(tableId,name);
  if (db.collectionExists(tableName)) {
    DBCollection collection=db.getCollection(tableName);
    collection.rename(newTableName);
  }
 else {
    db.createCollection(newTableName,null);
  }
  return table;
}
