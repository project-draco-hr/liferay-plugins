{
  if (!isDefaultRepository(parentFolderId)) {
    return null;
  }
  SyncDLObject syncDLObject=syncDLObjectPersistence.fetchByT_T(type,typePK);
  if (syncDLObject == null) {
    long syncDLObjectId=counterLocalService.increment();
    syncDLObject=syncDLObjectPersistence.create(syncDLObjectId);
    syncDLObject.setCompanyId(companyId);
    syncDLObject.setCreateTime(modifiedTime);
    syncDLObject.setRepositoryId(repositoryId);
    syncDLObject.setType(type);
    syncDLObject.setTypePK(typePK);
    syncDLObject.setTypeUuid(typeUuid);
    if (type.equals(SyncConstants.TYPE_PRIVATE_WORKING_COPY)) {
      SyncDLObject approvedSyncDLObject=syncDLObjectPersistence.fetchByT_T(SyncConstants.TYPE_FILE,typePK);
      approvedSyncDLObject.setModifiedTime(modifiedTime);
      approvedSyncDLObject.setLockExpirationDate(lockExpirationDate);
      approvedSyncDLObject.setLockUserId(lockUserId);
      approvedSyncDLObject.setLockUserName(lockUserName);
      syncDLObjectPersistence.update(approvedSyncDLObject);
    }
  }
 else   if (syncDLObject.getModifiedTime() >= modifiedTime) {
    return null;
  }
 else   if (type.equals(SyncConstants.TYPE_FILE)) {
    SyncDLObject pwcSyncDLObject=syncDLObjectPersistence.fetchByT_T(SyncConstants.TYPE_PRIVATE_WORKING_COPY,typePK);
    if (pwcSyncDLObject != null) {
      DLFileEntry dlFileEntry=dlFileEntryLocalService.fetchDLFileEntry(typePK);
      if ((dlFileEntry == null) || !dlFileEntry.isCheckedOut()) {
        syncDLObjectPersistence.remove(pwcSyncDLObject);
      }
    }
  }
  syncDLObject.setModifiedTime(modifiedTime);
  syncDLObject.setParentFolderId(parentFolderId);
  syncDLObject.setName(name);
  syncDLObject.setExtension(extension);
  syncDLObject.setMimeType(mimeType);
  syncDLObject.setDescription(description);
  syncDLObject.setChangeLog(changeLog);
  syncDLObject.setExtraSettings(extraSettings);
  syncDLObject.setVersion(version);
  syncDLObject.setSize(size);
  syncDLObject.setChecksum(checksum);
  syncDLObject.setEvent(event);
  syncDLObject.setLockExpirationDate(lockExpirationDate);
  syncDLObject.setLockUserId(lockUserId);
  syncDLObject.setLockUserName(lockUserName);
  return syncDLObjectPersistence.update(syncDLObject);
}
