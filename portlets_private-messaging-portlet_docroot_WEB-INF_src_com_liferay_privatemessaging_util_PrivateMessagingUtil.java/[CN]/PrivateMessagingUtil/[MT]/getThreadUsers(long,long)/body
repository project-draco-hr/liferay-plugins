{
  List<User> users=new ArrayList<User>();
  List<MBMessage> mbMessages=getThreadMessages(userId,mbThreadId,QueryUtil.ALL_POS,QueryUtil.ALL_POS,false);
  for (  MBMessage mbMessage : mbMessages) {
    if (userId == mbMessage.getUserId()) {
      continue;
    }
    User user=UserLocalServiceUtil.getUser(mbMessage.getUserId());
    if (!users.contains(user)) {
      users.add(user);
    }
  }
  List<UserThread> userThreads=UserThreadLocalServiceUtil.getMBThreadUserThreads(mbThreadId);
  for (  UserThread userThread : userThreads) {
    if (userId == userThread.getUserId()) {
      continue;
    }
    User user=UserLocalServiceUtil.getUser(userThread.getUserId());
    if (!users.contains(user)) {
      users.add(user);
    }
  }
  return users;
}
