{
  try {
    Drive drive=getDrive();
    Drive.Files driveFiles=drive.files();
    Drive.Files.List driveFilesList=driveFiles.list();
    String searchQuery=getSearchQuery(searchContext.getKeywords(),searchContext.getFolderIds(),extRepositoryQueryMapper);
    driveFilesList.setQ(searchQuery);
    FileList fileList=driveFilesList.execute();
    List<File> files=fileList.getItems();
    List<ExtRepositorySearchResult<?>> extRepositorySearchResults=new ArrayList<>(files.size());
    for (    File file : files) {
      if (_FOLDER_MIME_TYPE.equals(file.getMimeType())) {
        GoogleDriveFolder googleDriveFolder=new GoogleDriveFolder(file,getRootFolderKey());
        ExtRepositorySearchResult<GoogleDriveFolder> extRepositorySearchResult=new ExtRepositorySearchResult<>(googleDriveFolder,1.0f,StringPool.BLANK);
        extRepositorySearchResults.add(extRepositorySearchResult);
      }
 else {
        GoogleDriveFileEntry googleDriveFileEntry=new GoogleDriveFileEntry(file);
        ExtRepositorySearchResult<GoogleDriveFileEntry> extRepositorySearchResult=new ExtRepositorySearchResult<>(googleDriveFileEntry,1.0f,StringPool.BLANK);
        extRepositorySearchResults.add(extRepositorySearchResult);
      }
    }
    return extRepositorySearchResults;
  }
 catch (  IOException ioe) {
    _log.error(ioe,ioe);
    throw new SystemException(ioe);
  }
}
