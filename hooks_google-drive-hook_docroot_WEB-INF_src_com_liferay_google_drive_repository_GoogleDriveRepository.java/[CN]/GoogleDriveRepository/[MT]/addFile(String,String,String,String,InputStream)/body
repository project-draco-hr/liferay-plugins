{
  try {
    File file=new File();
    file.setDescription(description);
    file.setMimeType(mimeType);
    Drive drive=getDrive();
    Drive.Files driveFiles=drive.files();
    File extRepositoryParentFolderFile=getFile(drive,extRepositoryParentFolderKey);
    ParentReference parentReference=new ParentReference();
    parentReference.setId(extRepositoryParentFolderFile.getId());
    file.setParents(Arrays.asList(parentReference));
    file.setTitle(title);
    if (inputStream != null) {
      InputStreamContent inputStreamContent=new InputStreamContent(mimeType,inputStream);
      Drive.Files.Insert driveFilesInsert=driveFiles.insert(file,inputStreamContent);
      return driveFilesInsert.execute();
    }
 else {
      Drive.Files.Insert driveFilesInsert=driveFiles.insert(file);
      return driveFilesInsert.execute();
    }
  }
 catch (  IOException ioe) {
    _log.error(ioe,ioe);
    throw new SystemException(ioe);
  }
}
