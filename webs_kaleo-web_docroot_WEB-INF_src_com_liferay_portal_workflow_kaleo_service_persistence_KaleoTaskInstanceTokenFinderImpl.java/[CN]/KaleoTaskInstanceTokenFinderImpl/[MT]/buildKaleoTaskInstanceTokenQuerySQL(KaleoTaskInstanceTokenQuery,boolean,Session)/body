{
  String sql=null;
  if (count) {
    sql=CustomSQLUtil.get(COUNT_BY_C_KTAI);
  }
 else {
    sql=CustomSQLUtil.get(FIND_BY_C_KTAI);
  }
  sql=CustomSQLUtil.appendCriteria(sql,getAssigneeClassName(kaleoTaskInstanceTokenQuery));
  sql=CustomSQLUtil.appendCriteria(sql,getAssigneeClassPK(kaleoTaskInstanceTokenQuery));
  sql=CustomSQLUtil.appendCriteria(sql,getCompleted(kaleoTaskInstanceTokenQuery));
  sql=CustomSQLUtil.appendCriteria(sql,getKaleoInstanceId(kaleoTaskInstanceTokenQuery));
  sql=CustomSQLUtil.appendCriteria(sql,getRoleIds(kaleoTaskInstanceTokenQuery));
  sql=CustomSQLUtil.appendCriteria(sql,getSearchByUserRoles(kaleoTaskInstanceTokenQuery));
  if (appendSearchCriteria(kaleoTaskInstanceTokenQuery)) {
    sql=CustomSQLUtil.appendCriteria(sql," AND (");
    sql=CustomSQLUtil.appendCriteria(sql,getAssetType(kaleoTaskInstanceTokenQuery));
    sql=CustomSQLUtil.appendCriteria(sql,getDueDateGT(kaleoTaskInstanceTokenQuery,(kaleoTaskInstanceTokenQuery.getAssetType() == null)));
    sql=CustomSQLUtil.appendCriteria(sql,getDueDateLT(kaleoTaskInstanceTokenQuery,((kaleoTaskInstanceTokenQuery.getAssetType() == null) && (kaleoTaskInstanceTokenQuery.getDueDateGT() == null))));
    sql=CustomSQLUtil.appendCriteria(sql,getTaskName(kaleoTaskInstanceTokenQuery,((kaleoTaskInstanceTokenQuery.getAssetType() == null) && (kaleoTaskInstanceTokenQuery.getDueDateGT() == null) && (kaleoTaskInstanceTokenQuery.getDueDateLT() == null))));
    sql=CustomSQLUtil.appendCriteria(sql,")");
    sql=CustomSQLUtil.replaceAndOperator(sql,kaleoTaskInstanceTokenQuery.isAndOperator());
  }
  if (kaleoTaskInstanceTokenQuery.getOrderByComparator() != null) {
    StringBundler sb=new StringBundler(sql);
    appendOrderByComparator(sb,_ORDER_BY_ENTITY_ALIAS,kaleoTaskInstanceTokenQuery.getOrderByComparator());
    sql=sb.toString();
  }
  SQLQuery q=session.createSQLQuery(sql);
  if (count) {
    q.addScalar(COUNT_COLUMN_NAME,Type.LONG);
  }
 else {
    q.addEntity("Kaleo_KaleoTaskInstanceToken",KaleoTaskInstanceTokenImpl.class);
  }
  QueryPos qPos=QueryPos.getInstance(q);
  qPos.add(kaleoTaskInstanceTokenQuery.getCompanyId());
  setAssigneeClassName(qPos,kaleoTaskInstanceTokenQuery);
  setAssigneeClassPK(qPos,kaleoTaskInstanceTokenQuery);
  setCompleted(qPos,kaleoTaskInstanceTokenQuery);
  setKaleoInstanceId(qPos,kaleoTaskInstanceTokenQuery);
  setRoleIds(qPos,kaleoTaskInstanceTokenQuery);
  setSearchByUserRoles(qPos,kaleoTaskInstanceTokenQuery);
  setAssetType(qPos,kaleoTaskInstanceTokenQuery);
  setDueDateGT(qPos,kaleoTaskInstanceTokenQuery);
  setDueDateLT(qPos,kaleoTaskInstanceTokenQuery);
  setTaskName(qPos,kaleoTaskInstanceTokenQuery);
  return q;
}
