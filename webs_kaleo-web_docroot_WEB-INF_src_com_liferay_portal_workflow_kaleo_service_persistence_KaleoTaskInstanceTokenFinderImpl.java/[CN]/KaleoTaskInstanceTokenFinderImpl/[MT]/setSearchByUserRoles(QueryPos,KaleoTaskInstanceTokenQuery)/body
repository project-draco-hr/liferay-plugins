{
  Boolean searchByUserRoles=kaleoTaskInstanceTokenQuery.isSearchByUserRoles();
  if (searchByUserRoles == null) {
    return;
  }
  if (searchByUserRoles) {
    qPos.add(Role.class.getName());
    List<Long> roleIds=getSearchByUserRoleIds(kaleoTaskInstanceTokenQuery);
    long userId=kaleoTaskInstanceTokenQuery.getUserId();
    List<UserGroupRole> userGroupRoles=UserGroupRoleLocalServiceUtil.getUserGroupRoles(userId);
    User user=UserLocalServiceUtil.getUser(userId);
    long[] userGroupIds=user.getUserGroupIds();
    List<UserGroupGroupRole> userGroupGroupRoles=new ArrayList<UserGroupGroupRole>();
    for (    long userGroupId : userGroupIds) {
      List<UserGroupGroupRole> roles=UserGroupGroupRoleLocalServiceUtil.getUserGroupGroupRoles(userGroupId);
      userGroupGroupRoles.addAll(roles);
    }
    if (roleIds.isEmpty() && userGroupRoles.isEmpty() && userGroupGroupRoles.isEmpty()) {
      return;
    }
    for (    Long roleId : roleIds) {
      qPos.add(roleId);
    }
    for (    UserGroupRole userGroupRole : userGroupRoles) {
      qPos.add(userGroupRole.getGroupId());
      qPos.add(userGroupRole.getRoleId());
    }
    for (    UserGroupGroupRole userGroupGroupRole : userGroupGroupRoles) {
      qPos.add(userGroupGroupRole.getGroupId());
      qPos.add(userGroupGroupRole.getRoleId());
    }
  }
 else {
    qPos.add(User.class.getName());
    qPos.add(kaleoTaskInstanceTokenQuery.getUserId());
  }
}
