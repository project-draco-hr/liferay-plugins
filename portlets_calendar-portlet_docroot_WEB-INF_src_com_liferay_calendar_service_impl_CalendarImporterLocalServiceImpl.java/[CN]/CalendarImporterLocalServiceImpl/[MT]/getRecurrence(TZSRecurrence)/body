{
  if (tzsRecurrence == null) {
    return null;
  }
  Recurrence recurrence=new Recurrence();
  Frequency frequency=_frequencyMap.get(tzsRecurrence.getFrequency());
  int interval=tzsRecurrence.getInterval();
  List<PositionalWeekday> weekdays=new ArrayList<PositionalWeekday>();
  if ((frequency == Frequency.DAILY) && (interval == 0)) {
    frequency=Frequency.WEEKLY;
    interval=1;
    weekdays.add(new PositionalWeekday(Weekday.MONDAY,0));
    weekdays.add(new PositionalWeekday(Weekday.TUESDAY,0));
    weekdays.add(new PositionalWeekday(Weekday.WEDNESDAY,0));
    weekdays.add(new PositionalWeekday(Weekday.THURSDAY,0));
    weekdays.add(new PositionalWeekday(Weekday.FRIDAY,0));
  }
 else {
    DayAndPosition[] dayAndPositions=tzsRecurrence.getByDay();
    if (dayAndPositions != null) {
      for (      DayAndPosition dayAndPosition : dayAndPositions) {
        Weekday weekday=_weekdayMap.get(dayAndPosition.getDayOfWeek());
        PositionalWeekday positionalWeekday=new PositionalWeekday(weekday,dayAndPosition.getDayPosition());
        weekdays.add(positionalWeekday);
      }
    }
    int[] months=tzsRecurrence.getByMonth();
    if (ArrayUtil.isNotEmpty(months)) {
      List<Integer> monthsList=new ArrayList<Integer>();
      for (      int month : months) {
        monthsList.add(month + 1);
      }
      recurrence.setMonths(monthsList);
    }
  }
  recurrence.setInterval(interval);
  recurrence.setFrequency(frequency);
  recurrence.setWeekdays(weekdays);
  Calendar untilJCalendar=tzsRecurrence.getUntil();
  int ocurrence=tzsRecurrence.getOccurrence();
  if (untilJCalendar != null) {
    recurrence.setUntilJCalendar(untilJCalendar);
  }
 else   if (ocurrence > 0) {
    recurrence.setCount(ocurrence);
  }
  return RecurrenceSerializer.serialize(recurrence);
}
