{
  long[] companyIds=PortalUtil.getCompanyIds();
  int[] scopes=new int[]{ResourceConstants.SCOPE_COMPANY,ResourceConstants.SCOPE_GROUP,ResourceConstants.SCOPE_GROUP_TEMPLATE};
  Set<Long> roleIds=new HashSet<Long>();
  for (  long companyId : companyIds) {
    for (    int scope : scopes) {
      importResourcePermissions(companyId,_OLD_CALENDAR_MODEL_NAME,"ADD_EVENT",_NEW_CALENDAR_MODEL_NAME,"MANAGE_BOOKINGS",scope,roleIds);
      importResourcePermissions(companyId,_OLD_CALENDAR_MODEL_NAME,"ADD_EVENT",_NEW_CALENDAR_MODEL_NAME,"VIEW_BOOKING_DETAILS",scope,roleIds);
      importResourcePermissions(companyId,_OLD_CALENDAR_MODEL_NAME,"PERMISSIONS",_NEW_CALENDAR_MODEL_NAME,"PERMISSIONS",scope,roleIds);
      importResourcePermissions(companyId,_CAL_EVENT_MODEL_NAME,"ADD_DISCUSSION",_CALENDAR_BOOKING_MODEL_NAME,"ADD_DISCUSSION",scope,roleIds);
      importResourcePermissions(companyId,_CAL_EVENT_MODEL_NAME,"DELETE_DISCUSSION",_CALENDAR_BOOKING_MODEL_NAME,"DELETE_DISCUSSION",scope,roleIds);
      importResourcePermissions(companyId,_CAL_EVENT_MODEL_NAME,"PERMISSIONS",_CALENDAR_BOOKING_MODEL_NAME,"PERMISSIONS",scope,roleIds);
      importResourcePermissions(companyId,_CAL_EVENT_MODEL_NAME,"UPDATE_DISCUSSION",_CALENDAR_BOOKING_MODEL_NAME,"UPDATE_DISCUSSION",scope,roleIds);
    }
  }
  List<Role> roles=roleLocalService.getRoles(ArrayUtil.toLongArray(roleIds));
  updateRoleModifiedDate(roles);
}
