{
  String format=_getNameIDFormat();
  NameID nameID=null;
  if (format.equals("emailAddress")) {
    nameID=OpenSAMLUtil.buildNameID(user.getEmailAddress(),NameID.EMAIL);
  }
 else   if (format.equals("screenName")) {
    nameID=OpenSAMLUtil.buildNameID(user.getScreenName(),NameID.UNSPECIFIED);
  }
 else {
    nameID=OpenSAMLUtil.buildNameID(String.valueOf(user.getUserId()),NameID.PERSISTENT);
  }
  return nameID;
}
