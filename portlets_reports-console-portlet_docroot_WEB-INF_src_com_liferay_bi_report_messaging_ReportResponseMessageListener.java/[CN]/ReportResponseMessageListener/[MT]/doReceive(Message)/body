{
  long requestReportId=Long.parseLong(message.getResponseId());
  ReportResultContainer reportResultContainer=(ReportResultContainer)message.getPayload();
  RequestedReport requestedReport=RequestedReportLocalServiceUtil.getRequestedReport(requestReportId);
  Date now=new Date();
  if (reportResultContainer.hasError()) {
    requestedReport.setRequestStatus(RequestStatus.ERROR.toString());
  }
 else {
    long companyId=0;
    long groupId=0;
    String portletId=CompanyConstants.SYSTEM_STRING;
    long repositoryId=CompanyConstants.SYSTEM;
    long fileEntryId=0;
    String properties=StringPool.BLANK;
    String[] tagsCategories=new String[0];
    String[] tagsEntries=new String[0];
    try {
      DLServiceUtil.addDirectory(companyId,repositoryId,BI_REPORTS_DIRS + String.valueOf(requestReportId));
    }
 catch (    DuplicateDirectoryException dde) {
    }
    try {
      DLServiceUtil.addFile(companyId,portletId,groupId,repositoryId,reportResultContainer.getReportName(),fileEntryId,properties,now,tagsCategories,tagsEntries,reportResultContainer.getResults());
      requestedReport.setRequestStatus(RequestStatus.COMPLETE.toString());
    }
 catch (    Exception e) {
      requestedReport.setRequestStatus(RequestStatus.ERROR.toString());
      _log.error(e);
    }
  }
  requestedReport.setModifiedDate(now);
  RequestedReportLocalServiceUtil.updateRequestedReport(requestedReport);
}
