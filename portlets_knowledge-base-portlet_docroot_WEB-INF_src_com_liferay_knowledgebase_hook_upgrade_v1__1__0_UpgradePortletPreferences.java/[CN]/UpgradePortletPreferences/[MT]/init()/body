{
  StringBundler sb=new StringBundler(3);
  sb.append(WebDirDetector.getRootDir(getClass().getClassLoader()));
  sb.append("WEB-INF/");
  sb.append(Portal.PORTLET_XML_FILE_NAME_STANDARD);
  Document document=SAXReaderUtil.read(new File(sb.toString()));
  Element rootElement=document.getRootElement();
  Map<String,PortletPreferences> portletNameToPortletPreferencesMap=new HashMap<String,PortletPreferences>();
  for (  Element portletElement : rootElement.elements("portlet")) {
    String portletName=portletElement.elementText("portlet-name");
    Element portletPreferencesElement=portletElement.element("portlet-preferences");
    PortletPreferences portletPreferences=PortletPreferencesFactoryUtil.fromDefaultXML(portletPreferencesElement.asXML());
    portletNameToPortletPreferencesMap.put(portletName,portletPreferences);
  }
  _portletNameToPortletPreferencesMap=portletNameToPortletPreferencesMap;
}
