{
  StringBundler sb=new StringBundler();
  sb.append("<div class=\"activity-body\">");
  int viewableActivities=0;
  List<SocialActivity> activities=SocialActivityLocalServiceUtil.getActivitySetActivities(activitySet.getActivitySetId(),QueryUtil.ALL_POS,QueryUtil.ALL_POS);
  for (  SocialActivity activity : activities) {
    ThemeDisplay themeDisplay=serviceContext.getThemeDisplay();
    PermissionChecker permissionChecker=themeDisplay.getPermissionChecker();
    if (!hasPermissions(permissionChecker,activity,ActionKeys.VIEW,serviceContext)) {
      continue;
    }
    SocialActivityFeedEntry subfeedEntry=getSubfeedEntry(activity,serviceContext);
    if (subfeedEntry == null) {
      continue;
    }
    sb.append("<div class=\"activity-subentry\">");
    sb.append("<span class=\"activity-subentry-title\">");
    sb.append(subfeedEntry.getTitle());
    sb.append("</span><span class=\"activity-subentry-body\">");
    sb.append(subfeedEntry.getBody());
    sb.append("</span></div>");
    viewableActivities++;
  }
  if (viewableActivities == 0) {
    return null;
  }
  sb.append("</div>");
  return sb.toString();
}
