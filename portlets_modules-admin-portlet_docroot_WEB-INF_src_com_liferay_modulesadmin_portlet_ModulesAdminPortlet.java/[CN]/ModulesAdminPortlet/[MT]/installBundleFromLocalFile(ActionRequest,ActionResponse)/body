{
  checkPermissions(actionRequest);
  UploadPortletRequest uploadPortletRequest=PortalUtil.getUploadPortletRequest(actionRequest);
  String fileName=uploadPortletRequest.getFullFileName("bundleFile");
  File file=uploadPortletRequest.getFile("bundleFile");
  if ((file == null) || !file.exists()) {
    throw new IllegalArgumentException("file-does-not-exist");
  }
  InputStream inputStream=new BufferedInputStream(new FileInputStream(file));
  try {
    Bundle bundle=getBundle(_bundleContext,inputStream);
    if (bundle == null) {
      _bundleContext.installBundle(fileName,inputStream);
    }
  }
  finally {
    StreamUtil.cleanUp(inputStream);
  }
}
