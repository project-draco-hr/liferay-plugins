{
  String starredGroupIds=portletPreferences.getValue("starredGroupIds",StringPool.BLANK);
  long[] groupIds=StringUtil.split(starredGroupIds,0L);
  List<Group> groups=new ArrayList<Group>(groupIds.length);
  for (  long groupId : groupIds) {
    try {
      Group group=GroupServiceUtil.getGroup(groupId);
      groups.add(group);
    }
 catch (    Exception e) {
      StringUtil.remove(starredGroupIds,String.valueOf(groupId));
      portletPreferences.setValue("starredGroupIds",starredGroupIds);
      portletPreferences.store();
    }
  }
  Collections.sort(groups,new GroupNameComparator(true));
  return groups;
}
