{
  String content=StringUtil.read(inputStream);
  if (Validator.isNull(content)) {
    return;
  }
  JSONObject jsonObject=JSONFactoryUtil.createJSONObject(content);
  JSONObject layoutTemplateJSONObject=jsonObject.getJSONObject("layoutTemplate");
  String name=layoutTemplateJSONObject.getString("name");
  Map<Locale,String> nameMap=getMap(name);
  LayoutPrototype layoutPrototype=getLayoutPrototype(companyId,name);
  if (layoutPrototype != null) {
    if (_log.isInfoEnabled()) {
      _log.info("Layout prototype already exists for " + name);
    }
    if (!developerModeEnabled) {
      return;
    }
    LayoutPrototypeLocalServiceUtil.deleteLayoutPrototype(layoutPrototype);
  }
  layoutPrototype=LayoutPrototypeLocalServiceUtil.addLayoutPrototype(userId,companyId,nameMap,name,true,serviceContext);
  JSONArray columnsJSONArray=layoutTemplateJSONObject.getJSONArray("columns");
  Layout layout=layoutPrototype.getLayout();
  addLayoutColumns(layout,LayoutTypePortletConstants.COLUMN_PREFIX,columnsJSONArray);
  LayoutLocalServiceUtil.updateLayout(layout.getGroupId(),layout.isPrivateLayout(),layout.getLayoutId(),layout.getTypeSettings());
}
