{
  Map<Locale,String> nameMap=new HashMap<Locale,String>();
  JSONObject nameMapJSONObject=layoutJSONObject.getJSONObject("nameMap");
  if (nameMapJSONObject != null) {
    nameMap=(Map<Locale,String>)LocalizationUtil.deserialize(nameMapJSONObject);
  }
 else {
    String name=layoutJSONObject.getString("name");
    nameMap.put(LocaleUtil.getDefault(),name);
  }
  Map<Locale,String> titleMap=new HashMap<Locale,String>();
  JSONObject titleMapJSONObject=layoutJSONObject.getJSONObject("nameMap");
  if (titleMapJSONObject != null) {
    titleMap=(Map<Locale,String>)LocalizationUtil.deserialize(titleMapJSONObject);
  }
 else {
    String title=layoutJSONObject.getString("title");
    titleMap.put(LocaleUtil.getDefault(),title);
  }
  boolean hidden=layoutJSONObject.getBoolean("hidden");
  Map<Locale,String> friendlyURLMap=new HashMap<Locale,String>();
  String friendlyURL=layoutJSONObject.getString("friendlyURL");
  if (Validator.isNotNull(friendlyURL) && !friendlyURL.startsWith(StringPool.SLASH)) {
    friendlyURL=StringPool.SLASH + friendlyURL;
  }
  friendlyURLMap.put(LocaleUtil.getDefault(),friendlyURL);
  String typeSettings=layoutJSONObject.getString("typeSettings");
  Layout layout=LayoutLocalServiceUtil.addLayout(userId,groupId,privateLayout,parentLayoutId,nameMap,titleMap,null,null,null,LayoutConstants.TYPE_PORTLET,typeSettings,hidden,friendlyURLMap,serviceContext);
  LayoutTypePortlet layoutTypePortlet=(LayoutTypePortlet)layout.getLayoutType();
  String layoutTemplateId=layoutJSONObject.getString("layoutTemplateId",_defaultLayoutTemplateId);
  if (Validator.isNotNull(layoutTemplateId)) {
    layoutTypePortlet.setLayoutTemplateId(userId,layoutTemplateId,false);
  }
  JSONArray columnsJSONArray=layoutJSONObject.getJSONArray("columns");
  addLayoutColumns(layout,LayoutTypePortletConstants.COLUMN_PREFIX,columnsJSONArray);
  LayoutLocalServiceUtil.updateLayout(groupId,layout.isPrivateLayout(),layout.getLayoutId(),layout.getTypeSettings());
  JSONArray layoutsJSONArray=layoutJSONObject.getJSONArray("layouts");
  addLayouts(layout.getLayoutId(),layoutsJSONArray);
}
