{
  long userId=portletDataContext.getUserId(article.getUserUuid());
  long parentResourcePrimKey=MapUtil.getLong(resourcePrimKeys,article.getParentResourcePrimKey());
  String dirName=MapUtil.getString(dirNames,String.valueOf(article.getResourcePrimKey()));
  long[] assetCategoryIds=null;
  if (portletDataContext.getBooleanParameter(_NAMESPACE_ARTICLE,"categories")) {
    assetCategoryIds=portletDataContext.getAssetCategoryIds(Article.class,article.getResourcePrimKey());
  }
  String[] assetTagNames=null;
  if (portletDataContext.getBooleanParameter(_NAMESPACE_ARTICLE,"tags")) {
    assetTagNames=portletDataContext.getAssetTagNames(Article.class,article.getResourcePrimKey());
  }
  Map<String,Serializable> expandoAttributes=getExpandoAttributes(portletDataContext,articleElement);
  ServiceContext serviceContext=new ServiceContext();
  serviceContext.setAddCommunityPermissions(true);
  serviceContext.setAddGuestPermissions(true);
  serviceContext.setAssetCategoryIds(assetCategoryIds);
  serviceContext.setAssetTagNames(assetTagNames);
  serviceContext.setCreateDate(article.getCreateDate());
  serviceContext.setModifiedDate(article.getModifiedDate());
  serviceContext.setScopeGroupId(portletDataContext.getScopeGroupId());
  if ((expandoAttributes != null) && !expandoAttributes.isEmpty()) {
    serviceContext.setExpandoBridgeAttributes(expandoAttributes);
  }
  Article importedArticle=null;
  long priority=0;
  if (portletDataContext.isDataStrategyMirror()) {
    Article existingArticle=ArticleUtil.fetchByUUID_G(article.getUuid(),portletDataContext.getScopeGroupId());
    if (existingArticle == null) {
      importedArticle=importArticleVersions(portletDataContext,article.getUuid(),parentResourcePrimKey,dirName,assetCategoryIds,assetTagNames,articleElement);
      priority=PriorityHelper.getPriority(portletDataContext.getScopeGroupId(),0,parentResourcePrimKey,0);
    }
 else {
      importedArticle=ArticleLocalServiceUtil.updateArticle(userId,existingArticle.getResourcePrimKey(),article.getTitle(),article.getContent(),article.getDescription(),dirName,serviceContext);
      priority=PriorityHelper.getPriority(existingArticle.getGroupId(),existingArticle.getResourcePrimKey(),parentResourcePrimKey,humanPriority);
    }
  }
 else {
    importedArticle=importArticleVersions(portletDataContext,null,parentResourcePrimKey,dirName,assetCategoryIds,assetTagNames,articleElement);
    priority=PriorityHelper.getPriority(portletDataContext.getScopeGroupId(),0,parentResourcePrimKey,0);
  }
  importedArticle=ArticleLocalServiceUtil.moveArticle(userId,portletDataContext.getScopeGroupId(),importedArticle.getResourcePrimKey(),parentResourcePrimKey,priority);
  resourcePrimKeys.put(article.getResourcePrimKey(),importedArticle.getResourcePrimKey());
  portletDataContext.importPermissions(Article.class,article.getResourcePrimKey(),importedArticle.getResourcePrimKey());
  if (portletDataContext.getBooleanParameter(_NAMESPACE_ARTICLE,"ratings")) {
    portletDataContext.importRatingsEntries(Article.class,article.getResourcePrimKey(),importedArticle.getResourcePrimKey());
  }
}
