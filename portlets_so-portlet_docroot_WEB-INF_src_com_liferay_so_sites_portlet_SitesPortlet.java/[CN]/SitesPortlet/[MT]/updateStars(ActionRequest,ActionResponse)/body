{
  ThemeDisplay themeDisplay=(ThemeDisplay)actionRequest.getAttribute(WebKeys.THEME_DISPLAY);
  String cmd=ParamUtil.getString(actionRequest,Constants.CMD);
  long starredGroupId=ParamUtil.getLong(actionRequest,"starredGroupId");
  JSONObject jsonObject=JSONFactoryUtil.createJSONObject();
  try {
    GroupServiceUtil.getGroup(starredGroupId);
  }
 catch (  Exception e) {
    jsonObject.put("result","failure");
    writeJSON(actionRequest,actionResponse,jsonObject);
    return;
  }
  User user=themeDisplay.getUser();
  Group group=user.getGroup();
  PortletPreferences portletPreferences=PortletPreferencesLocalServiceUtil.getPreferences(user.getCompanyId(),group.getGroupId(),PortletKeys.PREFS_OWNER_TYPE_GROUP,0,"5_WAR_soportlet");
  String starredGroupIds=portletPreferences.getValue("starredGroupIds",StringPool.BLANK);
  if (cmd.equals(Constants.ADD)) {
    starredGroupIds=StringUtil.add(starredGroupIds,String.valueOf(starredGroupId));
  }
 else   if (cmd.equals(Constants.DELETE)) {
    starredGroupIds=StringUtil.remove(starredGroupIds,String.valueOf(starredGroupId));
  }
  portletPreferences.setValue("starredGroupIds",starredGroupIds);
  portletPreferences.store();
  jsonObject.put("result","success");
  writeJSON(actionRequest,actionResponse,jsonObject);
}
