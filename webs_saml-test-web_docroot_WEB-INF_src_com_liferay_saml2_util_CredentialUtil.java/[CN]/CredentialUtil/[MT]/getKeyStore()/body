{
  if (_keystore != null) {
    return _keystore;
  }
  String keystoreType=PropsValues.SAML_CREDENTIAL_KEYSTORE_TYPE;
  String keystoreFile=PropsValues.SAML_CREDENTIAL_KEYSTORE_FILE;
  String keystorePassword=PropsValues.SAML_CREDENTIAL_KEYSTORE_PASSWORD;
  KeyStore keystore=KeyStore.getInstance(keystoreType);
  InputStream keystoreStream=null;
  if (keystoreFile.startsWith("classpath:")) {
    String path=keystoreFile.substring(10);
    keystoreStream=CredentialUtil.class.getResourceAsStream(path);
  }
 else {
    keystoreStream=new FileInputStream(keystoreFile);
  }
  keystore.load(keystoreStream,keystorePassword.toCharArray());
  _keystore=keystore;
  return _keystore;
}
