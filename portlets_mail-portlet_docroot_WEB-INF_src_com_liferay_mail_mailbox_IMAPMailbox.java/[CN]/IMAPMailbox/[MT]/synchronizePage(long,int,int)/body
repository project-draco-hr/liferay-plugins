{
  long[] remoteMessageIds=_imapAccessor.getMessageUIDs(folderId,pageNumber,messagesPerPage);
  boolean upToDate=true;
  for (int i=0; i < remoteMessageIds.length; i++) {
    long remoteMessageId=remoteMessageIds[i];
    try {
      MessageLocalServiceUtil.getMessage(folderId,remoteMessageId);
      remoteMessageIds[i]=0;
    }
 catch (    NoSuchMessageException nsme) {
      upToDate=false;
    }
  }
  if (!upToDate) {
    _imapAccessor.storeEnvelopes(folderId,remoteMessageIds);
  }
}
