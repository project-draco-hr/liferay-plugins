{
  CalendarResource calendarResource=CalendarResourceUtil.getCalendarResource(portletRequest,classNameId,classPK);
  if (calendarResource == null) {
    return;
  }
  ThemeDisplay themeDisplay=(ThemeDisplay)portletRequest.getAttribute(WebKeys.THEME_DISPLAY);
  PermissionChecker permissionChecker=themeDisplay.getPermissionChecker();
  List<Calendar> calendars=CalendarLocalServiceUtil.getCalendars(calendarResource.getGroupId(),calendarResource.getCalendarResourceId());
  for (  Calendar calendar : calendars) {
    if (!CalendarPermission.contains(permissionChecker,calendar,ActionKeys.VIEW)) {
      continue;
    }
    JSONObject jsonObject=CalendarUtil.toCalendarJSONObject(themeDisplay,calendar);
    jsonArray.put(jsonObject);
  }
}
