{
  if (!PortalUtil.isRSSFeedsEnabled()) {
    PortalUtil.sendRSSFeedsDisabledError(resourceRequest,resourceResponse);
    return;
  }
  ThemeDisplay themeDisplay=(ThemeDisplay)resourceRequest.getAttribute(WebKeys.THEME_DISPLAY);
  long calendarId=ParamUtil.getLong(resourceRequest,"calendarId");
  int max=ParamUtil.getInteger(resourceRequest,"max",SearchContainer.DEFAULT_DELTA);
  String type=ParamUtil.getString(resourceRequest,"type",RSSUtil.FORMAT_DEFAULT);
  double version=ParamUtil.getDouble(resourceRequest,"version",RSSUtil.VERSION_DEFAULT);
  String displayStyle=ParamUtil.getString(resourceRequest,"displayStyle",RSSUtil.DISPLAY_STYLE_DEFAULT);
  long timeInterval=ParamUtil.getLong(resourceRequest,"timeInterval",RSSUtil.TIME_INTERVAL_DEFAULT);
  long startTime=(new Date()).getTime();
  long endTime=startTime + timeInterval;
  String rss=CalendarBookingServiceUtil.getCalendarBookingsRSS(calendarId,startTime,endTime,max,displayStyle,type,version,themeDisplay);
  PortletResponseUtil.sendFile(resourceRequest,resourceResponse,null,rss.getBytes(),ContentTypes.TEXT_XML_UTF8);
}
