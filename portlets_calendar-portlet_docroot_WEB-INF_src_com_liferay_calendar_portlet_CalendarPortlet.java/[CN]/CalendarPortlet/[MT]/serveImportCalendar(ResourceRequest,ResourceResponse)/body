{
  UploadPortletRequest uploadPortletRequest=PortalUtil.getUploadPortletRequest(resourceRequest);
  ThemeDisplay themeDisplay=(ThemeDisplay)resourceRequest.getAttribute(WebKeys.THEME_DISPLAY);
  long calendarId=ParamUtil.getLong(resourceRequest,"calendarId");
  File file=uploadPortletRequest.getFile("file");
  String data=FileUtil.read(file);
  JSONObject jsonObject=JSONFactoryUtil.createJSONObject();
  if (Validator.isNotNull(data)) {
    CalendarDataHandler calendarDataHandler=CalendarDataHandlerFactory.getCalendarDataHandler(CalendarDataFormat.ICAL);
    calendarDataHandler.importCalendar(calendarId,data);
  }
 else {
    jsonObject.put("error",themeDisplay.translate("failed-to-import-empty-file"));
  }
  writeJSON(resourceRequest,resourceResponse,jsonObject);
}
