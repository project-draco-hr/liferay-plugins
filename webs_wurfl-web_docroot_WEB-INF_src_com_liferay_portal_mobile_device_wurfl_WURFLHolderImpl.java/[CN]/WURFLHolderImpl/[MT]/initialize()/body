{
  List<InputStream> inputStreams=new ArrayList<InputStream>();
  try {
    XMLResource primaryDatabaseXMLResource=getWURFLDatabase(inputStreams);
    WURFLResources wurflPatches=getWURFLDatabasePatches(inputStreams);
    WURFLModel model=new DefaultWURFLModel(primaryDatabaseXMLResource,wurflPatches);
    MatcherManager matcherManager=new MatcherManager(model);
    DeviceProvider deviceProvider=new DefaultDeviceProvider(model);
    WURFLService service=new DefaultWURFLService(matcherManager,deviceProvider);
    WURFLManager manager=new DefaultWURFLManager(service);
    WURFLUtils utils=new WURFLUtils(model,deviceProvider);
    _wurflHolder=new DefaultWURFLHolder(manager,utils);
  }
  finally {
    for (    InputStream in : inputStreams) {
      try {
        in.close();
      }
 catch (      IOException e) {
      }
    }
  }
  if (_log.isDebugEnabled()) {
    _log.debug("WURFL initialised!");
  }
}
