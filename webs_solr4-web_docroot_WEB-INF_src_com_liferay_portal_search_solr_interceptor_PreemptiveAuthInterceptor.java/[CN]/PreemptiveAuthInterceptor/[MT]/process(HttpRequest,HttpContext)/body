{
  AuthState authState=(AuthState)context.getAttribute(ClientContext.TARGET_AUTH_STATE);
  if (authState.getAuthScheme() != null) {
    return;
  }
  CredentialsProvider credentialsProvider=(CredentialsProvider)context.getAttribute(ClientContext.CREDS_PROVIDER);
  HttpHost targetHost=(HttpHost)context.getAttribute(ExecutionContext.HTTP_TARGET_HOST);
  AuthScope authScope=new AuthScope(targetHost.getHostName(),targetHost.getPort());
  Credentials credentials=credentialsProvider.getCredentials(authScope);
  if (credentials != null) {
    authState.update(new BasicScheme(),credentials);
  }
}
