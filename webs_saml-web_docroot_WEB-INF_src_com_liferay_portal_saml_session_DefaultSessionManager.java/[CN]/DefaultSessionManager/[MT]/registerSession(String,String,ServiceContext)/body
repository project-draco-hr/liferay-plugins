{
  long companyId=serviceContext.getCompanyId();
  long userId=serviceContext.getUserId();
  SSOSession ssoSession=null;
  try {
    ssoSession=SSOSessionLocalServiceUtil.getSSOSession(sessionId);
    ssoSession.setLastActiveDate(new Date());
    SSOSessionLocalServiceUtil.updateSSOSession(ssoSession,false);
  }
 catch (  NoSuchSSOSessionException nssse) {
    ssoSession=SSOSessionLocalServiceUtil.addSSOSession(companyId,userId,sessionId);
  }
  SPSession spSession=null;
  try {
    spSession=SPSessionLocalServiceUtil.findByS_I(ssoSession.getSsoSessionId(),issuer);
  }
 catch (  NoSuchSPSessionException nssse) {
    spSession=SPSessionLocalServiceUtil.addSPSession(ssoSession.getSsoSessionId(),issuer,serviceContext);
  }
}
