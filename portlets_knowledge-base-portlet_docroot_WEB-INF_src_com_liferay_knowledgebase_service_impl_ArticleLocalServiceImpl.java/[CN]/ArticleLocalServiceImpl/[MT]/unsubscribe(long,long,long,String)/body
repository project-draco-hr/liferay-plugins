{
  Subscription subscription=subscriptionLocalService.getSubscription(companyId,userId,Article.class.getName(),groupId);
  String[] portletIds=expandoValueLocalService.getData(companyId,Subscription.class.getName(),"KB","portletIds",subscription.getSubscriptionId(),new String[0]);
  portletIds=ArrayUtil.remove(portletIds,portletId);
  if (portletIds.length == 0) {
    subscriptionLocalService.deleteSubscription(subscription);
  }
  expandoValueLocalService.deleteValue(subscription.getCompanyId(),Subscription.class.getName(),"KB","portletIds",subscription.getSubscriptionId());
  if (portletIds.length != 0) {
    expandoValueLocalService.addValue(subscription.getCompanyId(),Subscription.class.getName(),"KB","portletIds",subscription.getSubscriptionId(),portletIds);
  }
}
