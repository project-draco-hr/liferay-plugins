{
  Article article=getLatestArticle(resourcePrimKey,WorkflowConstants.STATUS_ANY);
  if (article.getParentResourcePrimKey() == parentResourcePrimKey) {
    return;
  }
  long rootResourcePrimKey=getRootResourcePrimKey(resourcePrimKey,parentResourcePrimKey);
  if (article.getRootResourcePrimKey() == rootResourcePrimKey) {
    return;
  }
  List<Article> articles1=getArticleAndAllDescendants(resourcePrimKey,WorkflowConstants.STATUS_ANY,null);
  for (  Article article1 : articles1) {
    List<Article> articles2=getArticleVersions(article1.getResourcePrimKey(),WorkflowConstants.STATUS_ANY,QueryUtil.ALL_POS,QueryUtil.ALL_POS,null);
    for (    Article article2 : articles2) {
      article2.setRootResourcePrimKey(rootResourcePrimKey);
      articlePersistence.update(article2,false);
    }
  }
  SearchEngineUtil.updatePermissionFields(Article.class.getName(),String.valueOf(resourcePrimKey));
}
