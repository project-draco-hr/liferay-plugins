{
  for (  long companyId : PortalUtil.getCompanyIds()) {
    long folderId=counterLocalService.increment();
    String dirName="knowledgebase/cache/attachments/" + folderId;
    DLServiceUtil.addDirectory(companyId,CompanyConstants.SYSTEM,dirName);
    String[] fileNames=DLServiceUtil.getFileNames(companyId,CompanyConstants.SYSTEM,"knowledgebase/cache/attachments");
    Arrays.sort(fileNames);
    for (int i=0; i < fileNames.length - 50; i++) {
      DLServiceUtil.deleteDirectory(companyId,CompanyConstants.SYSTEM_STRING,CompanyConstants.SYSTEM,fileNames[i]);
    }
    DLServiceUtil.deleteDirectory(companyId,CompanyConstants.SYSTEM_STRING,CompanyConstants.SYSTEM,dirName);
  }
}
