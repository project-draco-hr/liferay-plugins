{
  Subscription subscription=null;
  try {
    subscription=subscriptionLocalService.getSubscription(companyId,userId,Article.class.getName(),classPK);
  }
 catch (  NoSuchSubscriptionException nsse) {
    subscription=subscriptionLocalService.addSubscription(userId,groupId,Article.class.getName(),classPK);
  }
  ExpandoValue expandoValue=expandoValueLocalService.getValue(companyId,Subscription.class.getName(),"KB","portletPrimKeys",subscription.getSubscriptionId());
  String[] portletPrimKeys={ArticleConstants.getPortletPrimKey(plid,portletId)};
  if (expandoValue != null) {
    portletPrimKeys=ArrayUtil.append(portletPrimKeys,expandoValue.getStringArray());
    expandoValueLocalService.deleteValue(companyId,Subscription.class.getName(),"KB","portletPrimKeys",subscription.getSubscriptionId());
  }
  expandoValueLocalService.addValue(companyId,Subscription.class.getName(),"KB","portletPrimKeys",subscription.getSubscriptionId(),portletPrimKeys);
}
