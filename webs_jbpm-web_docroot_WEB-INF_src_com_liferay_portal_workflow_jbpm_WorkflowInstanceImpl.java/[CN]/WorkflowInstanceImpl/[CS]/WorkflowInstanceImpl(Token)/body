{
  ProcessInstance processInstance=token.getProcessInstance();
  ProcessDefinition processDefinition=processInstance.getProcessDefinition();
  setEndDate(token.getEnd());
  setStartDate(token.getStart());
  setState(token.getNode().getName());
  ContextInstance contextInstance=processInstance.getContextInstance();
  Map<String,Object> variables=contextInstance.getVariables(token);
  if (variables == null) {
    variables=new HashMap<String,Object>();
  }
  Map<String,Serializable> workflowContext=new HashMap<String,Serializable>();
  for (  Map.Entry<String,Object> entry : variables.entrySet()) {
    workflowContext.put(entry.getKey(),(Serializable)entry.getValue());
  }
  setWorkflowContext(Collections.unmodifiableMap(workflowContext));
  setWorkflowDefinitionName(processDefinition.getName());
  setWorkflowDefinitionVersion(processDefinition.getVersion());
  setWorkflowInstanceId(token.getId());
}
