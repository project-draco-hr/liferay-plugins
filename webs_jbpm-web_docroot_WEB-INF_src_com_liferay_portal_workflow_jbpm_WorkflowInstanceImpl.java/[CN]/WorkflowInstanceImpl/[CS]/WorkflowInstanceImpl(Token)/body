{
  ProcessInstance processInstance=token.getProcessInstance();
  ProcessDefinition processDefinition=processInstance.getProcessDefinition();
  Map<String,Object> context=processInstance.getContextInstance().getVariables(token);
  if (context == null) {
    context=new HashMap<String,Object>();
  }
  setContext(Collections.unmodifiableMap(context));
  setEndDate(token.getEnd());
  setStartDate(token.getStart());
  setState(token.getNode().getName());
  setWorkflowDefinitionName(processDefinition.getName());
  setWorkflowDefinitionVersion(processDefinition.getVersion());
  setWorkflowInstanceId(token.getId());
}
