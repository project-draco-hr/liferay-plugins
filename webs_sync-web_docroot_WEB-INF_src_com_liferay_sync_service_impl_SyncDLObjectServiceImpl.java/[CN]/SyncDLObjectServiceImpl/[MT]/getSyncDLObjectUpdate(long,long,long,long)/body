{
  try {
    SyncUtil.checkSyncEnabled(repositoryId);
    repositoryService.checkRepository(repositoryId);
    List<SyncDLObject> syncDLObjects=new ArrayList<>();
    if (parentFolderId > 0) {
      PermissionChecker permissionChecker=getPermissionChecker();
      if (permissionChecker.hasPermission(repositoryId,DLFolderConstants.getClassName(),parentFolderId,ActionKeys.VIEW)) {
        SyncDLObject syncDLObject=syncDLObjectPersistence.fetchByT_T(SyncConstants.TYPE_FOLDER,parentFolderId);
        if (syncDLObject != null) {
          syncDLObjects.add(syncDLObject);
        }
      }
    }
    syncDLObjects=getSyncDLObjects(syncDLObjects,companyId,repositoryId,parentFolderId,lastAccessTime);
    return new SyncDLObjectUpdate(syncDLObjects,syncDLObjects.size(),lastAccessTime);
  }
 catch (  PortalException pe) {
    throw new PortalException(SyncUtil.buildExceptionMessage(pe),pe);
  }
}
