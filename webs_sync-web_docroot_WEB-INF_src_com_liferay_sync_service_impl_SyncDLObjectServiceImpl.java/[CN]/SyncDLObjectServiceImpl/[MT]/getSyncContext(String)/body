{
  try {
    SyncContext syncContext=new SyncContext();
    PluginPackage syncWebPluginPackage=DeployManagerUtil.getInstalledPluginPackage("sync-web");
    syncContext.setPluginVersion(syncWebPluginPackage.getVersion());
    syncContext.setPortalBuildNumber(ReleaseInfo.getBuildNumber());
    PluginPackage soPortletPluginPackage=DeployManagerUtil.getInstalledPluginPackage("so-portlet");
    syncContext.setPortletPreferencesMap(getPortletPreferencesMap());
    if (soPortletPluginPackage != null) {
      syncContext.setSocialOfficeInstalled(true);
    }
 else {
      syncContext.setSocialOfficeInstalled(false);
    }
    syncContext.setUser(getUser());
    syncContext.setUserSitesGroups(getUserSitesGroups());
    return syncContext;
  }
 catch (  PortalException pe) {
    throw new PortalException(pe.getClass().getName(),pe);
  }
}
