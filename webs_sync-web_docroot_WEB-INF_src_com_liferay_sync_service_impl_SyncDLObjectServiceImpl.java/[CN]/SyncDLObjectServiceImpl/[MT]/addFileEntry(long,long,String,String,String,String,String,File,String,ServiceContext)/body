{
  try {
    Group group=groupLocalService.getGroup(repositoryId);
    SyncUtil.isSyncEnabled(group);
    SyncUtil.checkDefaultPermissions(group,serviceContext);
    FileEntry fileEntry=dlAppService.addFileEntry(repositoryId,folderId,sourceFileName,mimeType,title,description,changeLog,file,serviceContext);
    return toSyncDLObject(fileEntry,SyncConstants.EVENT_ADD);
  }
 catch (  PortalException pe) {
    if (pe instanceof DuplicateFileException) {
      if (GetterUtil.getBoolean(serviceContext.getAttribute("overwrite"))) {
        FileEntry fileEntry=dlAppService.getFileEntry(repositoryId,folderId,title);
        fileEntry=dlAppService.updateFileEntry(fileEntry.getFileEntryId(),sourceFileName,mimeType,title,description,changeLog,false,file,serviceContext);
        return toSyncDLObject(fileEntry,SyncConstants.EVENT_UPDATE);
      }
    }
    throw new PortalException(SyncUtil.buildExceptionMessage(pe),pe);
  }
}
