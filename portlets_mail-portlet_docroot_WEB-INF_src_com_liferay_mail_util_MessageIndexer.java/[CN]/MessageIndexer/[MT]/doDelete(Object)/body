{
  SearchContext searchContext=new SearchContext();
  searchContext.setSearchEngineId(getSearchEngineId());
  if (obj instanceof Account) {
    Account account=(Account)obj;
    searchContext.setCompanyId(account.getCompanyId());
    searchContext.setEnd(QueryUtil.ALL_POS);
    searchContext.setSorts(SortFactoryUtil.getDefaultSorts());
    searchContext.setStart(QueryUtil.ALL_POS);
    BooleanQuery booleanQuery=new BooleanQueryImpl();
    booleanQuery.addRequiredTerm(Field.ENTRY_CLASS_NAME,CLASS_NAME);
    booleanQuery.addRequiredTerm("accountId",account.getAccountId());
    Hits hits=SearchEngineUtil.search(searchContext,booleanQuery);
    List<String> uids=new ArrayList<>(hits.getLength());
    for (int i=0; i < hits.getLength(); i++) {
      Document document=hits.doc(i);
      uids.add(document.get(Field.UID));
    }
    SearchEngineUtil.deleteDocuments(getSearchEngineId(),account.getCompanyId(),uids,isCommitImmediately());
  }
 else   if (obj instanceof Folder) {
    Folder folder=(Folder)obj;
    searchContext.setCompanyId(folder.getCompanyId());
    searchContext.setEnd(QueryUtil.ALL_POS);
    searchContext.setSorts(SortFactoryUtil.getDefaultSorts());
    searchContext.setStart(QueryUtil.ALL_POS);
    BooleanQuery booleanQuery=new BooleanQueryImpl();
    booleanQuery.addRequiredTerm(Field.ENTRY_CLASS_NAME,CLASS_NAME);
    booleanQuery.addRequiredTerm("folderId",folder.getFolderId());
    Hits hits=SearchEngineUtil.search(searchContext,booleanQuery);
    List<String> uids=new ArrayList<>(hits.getLength());
    for (int i=0; i < hits.getLength(); i++) {
      Document document=hits.doc(i);
      uids.add(document.get(Field.UID));
    }
    SearchEngineUtil.deleteDocuments(getSearchEngineId(),folder.getCompanyId(),uids,isCommitImmediately());
  }
 else   if (obj instanceof Message) {
    Message message=(Message)obj;
    Document document=new DocumentImpl();
    document.addUID(CLASS_NAME,message.getMessageId());
    SearchEngineUtil.deleteDocument(getSearchEngineId(),message.getCompanyId(),document.get(Field.UID),isCommitImmediately());
  }
}
