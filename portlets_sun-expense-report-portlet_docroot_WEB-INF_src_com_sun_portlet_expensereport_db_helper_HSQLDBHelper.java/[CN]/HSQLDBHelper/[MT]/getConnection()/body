{
  if (connection == null) {
    if (_isMySQL == null) {
      String db=getProperty("DB");
      if (db != null && db.equals("MySQL")) {
        setIsMySQL(true);
        System.out.println("IsMYSQ:" + _isMySQL);
      }
    }
    DataSource datasource=null;
    try {
      Context initCtx=new InitialContext();
      datasource=(DataSource)initCtx.lookup("jdbc/LiferayPool");
      if (datasource != null) {
        connection=datasource.getConnection();
      }
 else {
        System.out.println("Failed to lookup datasource.");
      }
    }
 catch (    NamingException ex) {
      System.out.println("Cannot get connection: " + ex);
    }
catch (    SQLException ex) {
      System.out.println("Cannot get connection: " + ex);
    }
    System.out.println("Connection obtained from Datasource........" + connection);
    if (connection == null) {
      Class.forName("org.hsqldb.jdbcDriver");
      connection=DriverManager.getConnection("jdbc:hsqldb:lportal","sa","");
    }
    System.out.println("Connection obtained from JDBC URL........" + connection);
    createTables();
  }
  return connection;
}
