{
  Statement stmt=null;
  String reportDetailsQuery="select * from report_details";
  String employeeQuery="select * from employee";
  String itemQuery="select * from item";
  System.out.println("Inside createTables");
  String reportDetailsCreateQuery="CREATE TABLE report_details (" + "report_id integer GENERATED BY DEFAULT AS IDENTITY(" + "start with 100000) PRIMARY KEY,"+ "emp_id varchar(150) not null,"+ "amount varchar not null,"+ "rep_status varchar not null,"+ "submission_date varchar not null,"+ "rep_desc varchar not null"+ ")";
  String itemCreateQuery="CREATE TABLE item (" + "item_id integer GENERATED BY DEFAULT AS IDENTITY(" + "start with 10000) PRIMARY KEY,"+ "item_purpose varchar(150) not null,"+ "start_date varchar NOT NULL,"+ "end_date varchar NOT NULL,"+ "report_id integer,"+ "item_amount varchar(45) NOT NULL,"+ "FOREIGN KEY (report_id) REFERENCES report_details"+ ")";
  String employeeCreateQuery="CREATE TABLE employee (" + "emp_id varchar(50) not null primary key, " + "emp_sun_id varchar not null,"+ "emp_name varchar(100) not null,"+ "manager_id varchar not null"+ ")";
  String employeePopulateQuery="insert into employee (" + "emp_id,emp_sun_id,emp_name,manager_id) values(?,?,?,?)";
  PreparedStatement pstmt=null;
  try {
    stmt=connection.createStatement();
    try {
      ResultSet set=stmt.executeQuery(reportDetailsQuery);
      System.out.println("Report Details table already exists...");
    }
 catch (    SQLException se) {
      System.out.println("Creating Table Report Details...");
      System.out.println("ReportDetails table result::::" + stmt.executeUpdate(reportDetailsCreateQuery));
    }
    try {
      ResultSet set=stmt.executeQuery(itemQuery);
      System.out.println("Item table already exists...");
    }
 catch (    SQLException se) {
      System.out.println("Creating Table Item...");
      System.out.println("Item table result::::" + stmt.executeUpdate(itemCreateQuery));
    }
    try {
      ResultSet set=stmt.executeQuery(employeeQuery);
      System.out.println("Employee table already exists...");
      return;
    }
 catch (    SQLException se) {
      System.out.println("Creating Table Employee...");
      System.out.println("Employee table result::::" + stmt.executeUpdate(employeeCreateQuery));
    }
    connection.commit();
    try {
      pstmt=connection.prepareStatement(employeePopulateQuery);
      pstmt.setString(1,"paul");
      pstmt.setString(2,"208321");
      pstmt.setString(3,"Paul Tester");
      pstmt.setString(4,"mary");
      pstmt.execute();
      pstmt.setString(1,"ed");
      pstmt.setString(2,"193451");
      pstmt.setString(3,"Ed Developer");
      pstmt.setString(4,"mary");
      pstmt.execute();
      pstmt.setString(1,"chris");
      pstmt.setString(2,"168321");
      pstmt.setString(3,"Chris Editor");
      pstmt.setString(4,"mary");
      pstmt.execute();
      pstmt.setString(1,"mary");
      pstmt.setString(2,"108321");
      pstmt.setString(3,"Mary Manager");
      pstmt.setString(4,"bill");
      pstmt.execute();
      pstmt.setString(1,"bill");
      pstmt.setString(2,"100321");
      pstmt.setString(3,"Bill Boss");
      pstmt.setString(4,"bill");
      pstmt.execute();
      connection.commit();
    }
 catch (    SQLException se) {
      se.printStackTrace();
    }
  }
 catch (  SQLException se) {
    se.printStackTrace();
    throw new SQLException(se.getMessage());
  }
}
