{
  try {
    Map<String,Serializable> workflowContext=executionContext.getWorkflowContext();
    String fromAddress=(String)workflowContext.get(WorkflowConstants.CONTEXT_NOTIFICATION_SENDER_ADDRESS);
    if (Validator.isNull(fromAddress)) {
      fromAddress=_fromAddress;
    }
    String fromName=(String)workflowContext.get(WorkflowConstants.CONTEXT_NOTIFICATION_SENDER_NAME);
    if (Validator.isNull(fromName)) {
      fromName=_fromName;
    }
    InternetAddress from=new InternetAddress(fromAddress,fromName);
    InternetAddress[] recipients=getRecipients(kaleoNotificationRecipients,executionContext);
    if (recipients.length == 0) {
      return;
    }
    String subject=(String)workflowContext.get(WorkflowConstants.CONTEXT_NOTIFICATION_SUBJECT);
    if (Validator.isNull(subject)) {
      subject=defaultSubject;
    }
    MailMessage mailMessage=new MailMessage(from,subject,notificationMessage,true);
    mailMessage.setTo(recipients);
    MailServiceUtil.sendEmail(mailMessage);
  }
 catch (  Exception e) {
    throw new NotificationMessageSenderException("Unable to send mail message",e);
  }
}
