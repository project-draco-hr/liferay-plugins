{
  DynamicQuery dynamicQuery=DynamicQueryFactoryUtil.forClass(KaleoTaskInstanceToken.class);
  dynamicQuery.add(PropertyFactoryUtil.forName("companyId").eq(serviceContext.getCompanyId()));
  if (Validator.isNotNull(taskName) || Validator.isNotNull(assetType) || (dueDateGT != null)|| (dueDateLT != null)) {
    Junction junction=null;
    if (andOperator) {
      junction=RestrictionsFactoryUtil.conjunction();
    }
 else {
      junction=RestrictionsFactoryUtil.disjunction();
    }
    if (Validator.isNotNull(taskName)) {
      String[] taskNameKeywords=StringUtil.split(taskName,StringPool.SPACE);
      for (      String taskNameKeyword : taskNameKeywords) {
        junction.add(PropertyFactoryUtil.forName("kaleoTaskName").like(taskNameKeyword));
      }
    }
    if (Validator.isNotNull(assetType)) {
      String[] assetTypeKeywords=StringUtil.split(assetType,StringPool.SPACE);
      for (      String assetTypeKeyword : assetTypeKeywords) {
        junction.add(PropertyFactoryUtil.forName("workflowContext").like(assetTypeKeyword));
      }
    }
    if (dueDateGT != null) {
      junction.add(PropertyFactoryUtil.forName("dueDate").ge(dueDateGT));
    }
    if (dueDateLT != null) {
      junction.add(PropertyFactoryUtil.forName("dueDate").lt(dueDateLT));
    }
    dynamicQuery.add(junction);
  }
  addSearchByUserRolesCriterion(dynamicQuery,searchByUserRoles,serviceContext);
  addCompletedCriterion(dynamicQuery,completed);
  return dynamicQuery;
}
