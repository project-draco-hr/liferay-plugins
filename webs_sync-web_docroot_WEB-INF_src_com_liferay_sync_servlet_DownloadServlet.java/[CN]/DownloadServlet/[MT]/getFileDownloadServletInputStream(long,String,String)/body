{
  FileEntry fileEntry=DLAppServiceUtil.getFileEntryByUuidAndGroupId(uuid,groupId);
  if (fileEntry.isInTrash()) {
    throw new NoSuchFileEntryException();
  }
  if (Validator.isNull(version)) {
    InputStream inputStream=DLFileEntryLocalServiceUtil.getFileAsStream(fileEntry.getFileEntryId(),fileEntry.getVersion(),false);
    return new DownloadServletInputStream(inputStream,fileEntry.getMimeType(),fileEntry.getSize());
  }
 else {
    FileVersion fileVersion=fileEntry.getFileVersion(version);
    return new DownloadServletInputStream(fileVersion.getContentStream(false),fileVersion.getMimeType(),fileVersion.getSize());
  }
}
