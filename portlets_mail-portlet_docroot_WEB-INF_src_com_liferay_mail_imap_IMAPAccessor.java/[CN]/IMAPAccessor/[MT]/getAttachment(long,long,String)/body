{
  Folder imapFolder=null;
  try {
    imapFolder=openFolder(folderId);
    Message jxMessage=getMessage((UIDFolder)imapFolder,messageId);
    if (jxMessage == null) {
      throw new MailException(MailException.MESSAGE_NOT_FOUND_ON_SERVER);
    }
    Part part=getPart(jxMessage,contentPath);
    AttachmentHandler attachmentHandler=new IMAPAttachmentHandler(part.getInputStream(),imapFolder);
    return attachmentHandler;
  }
 catch (  MessagingException me) {
    throw new MailException(me);
  }
}
