{
  ThemeDisplay themeDisplay=(ThemeDisplay)actionRequest.getAttribute(WebKeys.THEME_DISPLAY);
  long remoteAppId=ParamUtil.getLong(actionRequest,"appId");
  String version=ParamUtil.getString(actionRequest,"version");
  String url=ParamUtil.getString(actionRequest,"url");
  URL urlObj=new URL(url);
  InputStream inputStream=urlObj.openStream();
  App app=AppLocalServiceUtil.fetchRemoteApp(remoteAppId);
  if (app == null) {
    app=AppLocalServiceUtil.addApp(themeDisplay.getUserId(),remoteAppId,version,inputStream);
  }
 else {
    app=AppLocalServiceUtil.updateApp(app.getAppId(),version,inputStream);
  }
  JSONObject jsonObject=JSONFactoryUtil.createJSONObject();
  jsonObject.put("message","success");
  writeJSON(actionRequest,actionResponse,jsonObject);
}
