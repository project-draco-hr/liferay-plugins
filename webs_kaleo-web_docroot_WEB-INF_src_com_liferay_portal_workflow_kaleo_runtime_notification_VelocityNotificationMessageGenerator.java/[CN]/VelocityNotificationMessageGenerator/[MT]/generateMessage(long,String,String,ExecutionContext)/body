{
  VelocityEngine velocityEngine=VelocityEngineUtil.getVelocityEngine();
  VelocityContext velocityContext=VelocityEngineUtil.getRestrictedToolsContext();
  try {
    populateContextVariables(velocityContext,executionContext);
    StringWriter stringWriter=new StringWriter();
    velocityEngine.mergeTemplate(notificationName + kaleoNodeId,notificationTemplate,velocityContext,stringWriter);
    return stringWriter.toString();
  }
 catch (  Exception e) {
    throw new NotificationMessageGenerationException("Unable to generate notification message",e);
  }
}
