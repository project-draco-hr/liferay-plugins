{
  SyncEngineUtil.fireSyncEngineStateChanged(SyncEngineUtil.SYNC_ENGINE_STATE_STARTING);
  LoggerUtil.initLogger();
  _logger.info("Starting " + PropsValues.SYNC_PRODUCT_NAME);
  UpgradeUtil.upgrade();
  SyncAccountService.registerModelListener(new SyncAccountModelListener());
  SyncFileService.registerModelListener(new SyncFileModelListener());
  SyncSiteService.registerModelListener(new SyncSiteModelListener());
  SyncWatchEventProcessor syncWatchEventProcessor=new SyncWatchEventProcessor();
  _syncWatchEventProcessorExecutorService=Executors.newSingleThreadScheduledExecutor();
  _syncWatchEventProcessorExecutorService.scheduleAtFixedRate(syncWatchEventProcessor,0,3,TimeUnit.SECONDS);
  List<SyncAccount> syncAccounts=SyncAccountService.findAll();
  if (syncAccounts.isEmpty()) {
    SyncEngineUtil.fireSyncEngineStateChanged(SyncEngineUtil.SYNC_ENGINE_NOT_CONFIGURED);
  }
  for (  long activeSyncAccountId : SyncAccountService.getActiveSyncAccountIds()) {
    scheduleSyncAccountTasks(activeSyncAccountId);
  }
  SyncEngineUtil.fireSyncEngineStateChanged(SyncEngineUtil.SYNC_ENGINE_STATE_STARTED);
}
