{
  com.liferay.mail.model.Message message=null;
  try {
    message=MessageLocalServiceUtil.getRemoteMessage(folderId,oldest);
  }
 catch (  NoSuchMessageException nsme) {
    return null;
  }
  long remoteMessageId=message.getRemoteMessageId();
  Message jxMessage=getMessage(imapFolder,remoteMessageId);
  if (jxMessage == null) {
    MessageLocalServiceUtil.deleteMessage(message);
    return getMessage(folderId,imapFolder,oldest);
  }
 else {
    return jxMessage;
  }
}
