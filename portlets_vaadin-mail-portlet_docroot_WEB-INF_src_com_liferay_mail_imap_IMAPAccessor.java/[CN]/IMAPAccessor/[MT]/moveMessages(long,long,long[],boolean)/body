{
  IMAPFolder sourceIMAPFolder=null;
  IMAPFolder destinationIMAPFolder=null;
  try {
    sourceIMAPFolder=openFolder(sourceFolderId);
    sourceIMAPFolder.addMessageCountListener(new IMAPMessageCountListener(_user,_account,_password));
    destinationIMAPFolder=openFolder(destinationFolderId);
    destinationIMAPFolder.addMessageCountListener(new IMAPMessageCountListener(_user,_account,_password));
    List<Message> jxMessages=getMessages(sourceIMAPFolder,messageIds,deleteMissingMessages);
    for (    Message jxMessage : jxMessages) {
      destinationIMAPFolder.appendMessages(new Message[]{jxMessage});
      jxMessage.setFlag(Flags.Flag.DELETED,true);
    }
  }
 catch (  MessagingException me) {
    throw new MailException(me);
  }
 finally {
    closeFolder(sourceIMAPFolder,true);
    closeFolder(destinationIMAPFolder,false);
  }
}
