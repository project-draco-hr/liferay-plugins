{
  ServiceContext serviceContext=new ServiceContext();
  serviceContext.setCompanyId(companyId);
  serviceContext.setUserId(userId);
  WorkflowTaskAdapter workflowTask=(WorkflowTaskAdapter)_taskManager.completeWorkflowTask(workflowTaskInstanceId,transitionName,comment,workflowContext,serviceContext);
  try {
    KaleoTaskInstanceToken kaleoTaskInstanceToken=workflowTask.getKaleoTaskInstanceToken();
    KaleoInstanceToken kaleoInstanceToken=kaleoTaskInstanceToken.getKaleoInstanceToken();
    if (workflowContext == null) {
      workflowContext=WorkflowContextUtil.convert(kaleoInstanceToken.getKaleoInstance().getWorkflowContext());
    }
    ExecutionContext executionContext=new ExecutionContext(kaleoInstanceToken,workflowContext,serviceContext);
    _kaleoSignaler.signalExit(transitionName,executionContext);
  }
 catch (  Exception e) {
    throw new WorkflowException("Unable to complete task",e);
  }
  return workflowTask;
}
