{
  ThemeDisplay themeDisplay=(ThemeDisplay)resourceRequest.getAttribute(WebKeys.THEME_DISPLAY);
  boolean actionable=ParamUtil.getBoolean(resourceRequest,"actionable");
  int end=ParamUtil.getInteger(resourceRequest,"end");
  int start=ParamUtil.getInteger(resourceRequest,"start");
  JSONObject jsonObject=JSONFactoryUtil.createJSONObject();
  List<UserNotificationEvent> userNotificationEvents=NotificationsUtil.getArchivedUserNotificationEvents(themeDisplay.getUserId(),actionable,false,start,end);
  JSONArray jsonArray=JSONFactoryUtil.createJSONArray();
  List<Long> userNotificationEventIds=new ArrayList<Long>();
  for (  UserNotificationEvent userNotificationEvent : userNotificationEvents) {
    String entry=renderEntry(resourceRequest,resourceResponse,userNotificationEvent);
    if (Validator.isNotNull(entry)) {
      jsonArray.put(entry);
      userNotificationEventIds.add(userNotificationEvent.getUserNotificationEventId());
    }
  }
  jsonObject.put("entries",jsonArray);
  jsonObject.put("userNotificationEventIds",StringUtil.merge(userNotificationEventIds));
  int total=NotificationsUtil.getArchivedUserNotificationEventsCount(themeDisplay.getUserId(),actionable,false);
  jsonObject.put("total",total);
  writeJSON(resourceRequest,resourceResponse,jsonObject);
}
