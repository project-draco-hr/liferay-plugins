{
  ThemeDisplay themeDisplay=(ThemeDisplay)resourceRequest.getAttribute(WebKeys.THEME_DISPLAY);
  JSONObject jsonObject=JSONFactoryUtil.createJSONObject();
  try {
    int newUserNotificationsCount=UserNotificationEventLocalServiceUtil.getDeliveredUserNotificationEventsCount(themeDisplay.getUserId(),UserNotificationDeliveryConstants.TYPE_WEBSITE,false);
    jsonObject.put("newUserNotificationsCount",newUserNotificationsCount);
    jsonObject.put("timestamp",String.valueOf(System.currentTimeMillis()));
    int totalUserNotificationsCount=UserNotificationEventLocalServiceUtil.getUserNotificationEventsCount(themeDisplay.getUserId());
    jsonObject.put("totalUserNotificationsCount",totalUserNotificationsCount);
    int unreadActionableUserNotificationsCount=UserNotificationEventLocalServiceUtil.getArchivedUserNotificationEventsCount(themeDisplay.getUserId(),UserNotificationDeliveryConstants.TYPE_WEBSITE,true,false);
    jsonObject.put("unreadActionableUserNotificationsCount",unreadActionableUserNotificationsCount);
    int unreadNonactionableUserNotificationsCount=UserNotificationEventLocalServiceUtil.getArchivedUserNotificationEventsCount(themeDisplay.getUserId(),UserNotificationDeliveryConstants.TYPE_WEBSITE,false,false);
    jsonObject.put("unreadNonactionableUserNotificationsCount",unreadNonactionableUserNotificationsCount);
    int unreadUserNotificationsCount=UserNotificationEventLocalServiceUtil.getArchivedUserNotificationEventsCount(themeDisplay.getUserId(),UserNotificationDeliveryConstants.TYPE_WEBSITE,false);
    jsonObject.put("unreadUserNotificationsCount",unreadUserNotificationsCount);
    jsonObject.put("success",Boolean.TRUE);
  }
 catch (  Exception e) {
    jsonObject.put("success",Boolean.FALSE);
  }
  writeJSON(resourceRequest,resourceResponse,jsonObject);
}
