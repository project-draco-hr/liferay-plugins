{
  UserNotificationFeedEntry userNotificationFeedEntry=UserNotificationManagerUtil.interpret(StringPool.BLANK,userNotificationEvent,ServiceContextFactory.getInstance(resourceRequest));
  if (userNotificationFeedEntry == null) {
    return null;
  }
  LiferayPortletResponse liferayPortletResponse=(LiferayPortletResponse)resourceResponse;
  PortletURL actionURL=liferayPortletResponse.createActionURL(PortletKeys.NOTIFICATIONS);
  actionURL.setParameter("userNotificationEventId",String.valueOf(userNotificationEvent.getUserNotificationEventId()));
  actionURL.setWindowState(WindowState.NORMAL);
  String actionDiv=StringPool.BLANK;
  if (userNotificationFeedEntry.isActionable()) {
    actionURL.setParameter("javax.portlet.action","deleteUserNotificationEvent");
    actionDiv=StringUtil.replace(_DELETE_DIV,"[$DELETE_URL$]",actionURL.toString());
  }
 else {
    actionURL.setParameter("javax.portlet.action","markAsRead");
    actionDiv=StringUtil.replace(_MARK_AS_READ_DIV,new String[]{"[$LINK$]","[$MARK_AS_READ_URL$]","[$OPEN_DIALOG$]"},new String[]{userNotificationFeedEntry.getLink(),actionURL.toString(),String.valueOf(userNotificationFeedEntry.isOpenDialog())});
  }
  Portlet portlet=PortletLocalServiceUtil.getPortletById(themeDisplay.getCompanyId(),userNotificationEvent.getType());
  String portletName=portlet.getDisplayName();
  String portletIcon=portlet.getContextPath() + portlet.getIcon();
  Format simpleDateFormat=FastDateFormatFactoryUtil.getSimpleDateFormat("EEEE, MMMMM dd, yyyy 'at' h:mm a",themeDisplay.getLocale(),themeDisplay.getTimeZone());
  String timestamp=simpleDateFormat.format(userNotificationEvent.getTimestamp());
  JSONObject userNotificationEventJSONObject=JSONFactoryUtil.createJSONObject(userNotificationEvent.getPayload());
  long userId=userNotificationEventJSONObject.getLong("userId");
  String userFullName=HtmlUtil.escape(PortalUtil.getUserName(userId,StringPool.BLANK));
  String userPortraitURL=StringPool.BLANK;
  User user=UserLocalServiceUtil.fetchUserById(userId);
  if (user != null) {
    userPortraitURL=user.getPortraitURL((ThemeDisplay)resourceRequest.getAttribute(WebKeys.THEME_DISPLAY));
  }
  return StringUtil.replace(ContentUtil.get(PortletPropsValues.USER_NOTIFICATION_ENTRY),new String[]{"[$BODY$]","[$ACTION_DIV$]","[$PORTLET_ICON$]","[$PORTLET_NAME$]","[$SEPARATOR$]","[$TIMESTAMP$]","[$USER_FULL_NAME$]","[$USER_PORTRAIT_URL$]"},new String[]{userNotificationFeedEntry.getBody(),actionDiv,portletIcon,portletName,separator,timestamp,userFullName,userPortraitURL});
}
