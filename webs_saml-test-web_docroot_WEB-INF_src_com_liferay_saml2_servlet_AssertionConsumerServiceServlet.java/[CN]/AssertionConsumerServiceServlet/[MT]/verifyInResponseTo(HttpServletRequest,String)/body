{
  HttpSession session=request.getSession(true);
  String authnRequestId=(String)session.getAttribute(WebKeys.SAML_AUTHN_REQUEST_ID);
  if (authnRequestId == null || !inResponseTo.equals(authnRequestId)) {
    throw new Exception("Unsolicited response");
  }
  session.removeAttribute(WebKeys.SAML_AUTHN_REQUEST_ID);
}
