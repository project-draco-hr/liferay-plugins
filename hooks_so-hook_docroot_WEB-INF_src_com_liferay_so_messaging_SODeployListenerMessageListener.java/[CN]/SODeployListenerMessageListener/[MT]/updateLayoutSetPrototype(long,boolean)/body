{
  LayoutSet layoutSet=LayoutSetLocalServiceUtil.getLayoutSet(groupId,privateLayout);
  LayoutSetPrototype layoutSetPrototype=LayoutSetPrototypeLocalServiceUtil.getLayoutSetPrototype(layoutSet.getLayoutSetPrototypeId());
  Group group=layoutSetPrototype.getGroup();
  List<Layout> layouts=LayoutLocalServiceUtil.getLayouts(group.getGroupId(),true);
  String[] layoutUuids=new String[layouts.size()];
  for (int i=0; i < layouts.size(); i++) {
    Layout layout=layouts.get(i);
    layoutUuids[i]=layout.getUuid();
  }
  layouts=LayoutLocalServiceUtil.getLayouts(groupId,privateLayout);
  for (  Layout layout : layouts) {
    if (ArrayUtil.contains(layoutUuids,layout.getSourcePrototypeLayoutUuid())) {
      layout.setLayoutPrototypeUuid(StringPool.BLANK);
      layout.setSourcePrototypeLayoutUuid(StringPool.BLANK);
      layout.setLayoutPrototypeLinkEnabled(Boolean.FALSE);
      LayoutLocalServiceUtil.updateLayout(layout);
    }
  }
  UnicodeProperties settingsProperties=layoutSet.getSettingsProperties();
  settingsProperties.remove("last-merge-time");
  layoutSet.setSettingsProperties(settingsProperties);
  layoutSet.setLayoutSetPrototypeUuid(StringPool.BLANK);
  layoutSet.setLayoutSetPrototypeLinkEnabled(false);
  LayoutSetLocalServiceUtil.updateLayoutSet(layoutSet);
  LayoutSetLocalServiceUtil.updateLookAndFeel(layoutSet.getGroupId(),null,null,StringPool.BLANK,false);
}
