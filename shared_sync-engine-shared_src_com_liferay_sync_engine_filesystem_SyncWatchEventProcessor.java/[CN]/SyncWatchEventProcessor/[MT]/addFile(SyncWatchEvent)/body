{
  Path targetFilePath=Paths.get(syncWatchEvent.getFilePathName());
  if (Files.notExists(targetFilePath)) {
    return;
  }
  Path parentTargetFilePath=targetFilePath.getParent();
  SyncFile parentSyncFile=SyncFileService.fetchSyncFile(FilePathNameUtil.getFilePathName(parentTargetFilePath),syncWatchEvent.getSyncAccountId());
  SyncFile syncFile=SyncFileService.fetchSyncFile(FilePathNameUtil.getFilePathName(targetFilePath),syncWatchEvent.getSyncAccountId());
  if (syncFile == null) {
    syncFile=SyncFileService.fetchSyncFileByFileKey(FileUtil.getFileKey(targetFilePath),syncWatchEvent.getSyncAccountId());
  }
  if (syncFile == null) {
    SyncFileService.addFileSyncFile(targetFilePath,parentSyncFile.getTypePK(),parentSyncFile.getRepositoryId(),syncWatchEvent.getSyncAccountId());
    return;
  }
  SyncWatchEvent relatedSyncWatchEvent=SyncWatchEventService.fetchSyncWatchEvent(SyncWatchEvent.EVENT_TYPE_DELETE,syncFile.getFilePathName(),syncWatchEvent.getTimestamp());
  if (relatedSyncWatchEvent == null) {
    return;
  }
  Path sourceFilePath=Paths.get(relatedSyncWatchEvent.getFilePathName());
  if (parentTargetFilePath.equals(sourceFilePath.getParent())) {
    SyncFileService.updateFileSyncFile(targetFilePath,syncWatchEvent.getSyncAccountId(),syncFile,false);
  }
 else {
    SyncFileService.moveFileSyncFile(targetFilePath,parentSyncFile.getTypePK(),syncWatchEvent.getSyncAccountId(),syncFile);
    Path sourceFileNameFilePath=sourceFilePath.getFileName();
    if (!sourceFileNameFilePath.equals(targetFilePath.getFileName())) {
      SyncFileService.updateFileSyncFile(targetFilePath,syncWatchEvent.getSyncAccountId(),syncFile,false);
    }
  }
  SyncAccount syncAccount=SyncAccountService.fetchSyncAccount(syncWatchEvent.getSyncAccountId());
  if (syncAccount.getState() != SyncAccount.STATE_DISCONNECTED) {
    _processedSyncWatchEventIds.add(relatedSyncWatchEvent.getSyncWatchEventId());
  }
}
