{
  if (!isValidPortletId(portletId)) {
    return false;
  }
  PermissionChecker permissionChecker=PermissionThreadLocal.getPermissionChecker();
  if (!ArticlePermission.contains(permissionChecker,resourcePrimKey,ActionKeys.VIEW)) {
    return false;
  }
  Article article=ArticleServiceUtil.getLatestArticle(resourcePrimKey,WorkflowConstants.STATUS_APPROVED);
  Layout layout=LayoutLocalServiceUtil.getLayout(plid);
  PortletPreferences preferences=PortletPreferencesFactoryUtil.getPortletSetup(layout,portletId,StringPool.BLANK);
  Map<String,String> preferencesMap=initPortletPreferencesMap(portletId,preferences);
  String selectionMethod=preferencesMap.get("selectionMethod");
  long[] resourcePrimKeys=StringUtil.split(preferencesMap.get("resourcePrimKeys"),0L);
  boolean allArticles=GetterUtil.getBoolean(preferencesMap.get("allArticles"));
  String orderByColumn=preferencesMap.get("orderByColumn");
  boolean orderByAscending=GetterUtil.getBoolean(preferencesMap.get("orderByAscending"));
  long[] classPKs=getAssetEntriesClassPKs(article.getGroupId(),0,null,preferencesMap);
  List<Article> articles=null;
  if (selectionMethod.equals("group")) {
    OrderByComparator orderByComparator=getOrderByComparator(orderByColumn,orderByAscending);
    if (classPKs != null) {
      long[] viewableParentResourcePrimKeys=new long[]{ArticleConstants.DEFAULT_PARENT_RESOURCE_PRIM_KEY};
      if (allArticles) {
        viewableParentResourcePrimKeys=null;
      }
      articles=ArticleServiceUtil.getArticles(article.getGroupId(),classPKs,WorkflowConstants.STATUS_APPROVED,viewableParentResourcePrimKeys,QueryUtil.ALL_POS,QueryUtil.ALL_POS,orderByComparator);
    }
 else     if (allArticles) {
      articles=ArticleServiceUtil.getGroupArticles(article.getGroupId(),WorkflowConstants.STATUS_APPROVED,null,QueryUtil.ALL_POS,QueryUtil.ALL_POS,orderByComparator);
    }
 else {
      articles=ArticleServiceUtil.getSiblingArticles(article.getGroupId(),ArticleConstants.DEFAULT_PARENT_RESOURCE_PRIM_KEY,WorkflowConstants.STATUS_APPROVED,QueryUtil.ALL_POS,QueryUtil.ALL_POS,orderByComparator);
    }
  }
  if (selectionMethod.equals("articles")) {
    if (classPKs != null) {
      List<Long> list=new UniqueList<Long>();
      list.addAll(SetUtil.fromArray(resourcePrimKeys));
      list.retainAll(SetUtil.fromArray(classPKs));
      resourcePrimKeys=StringUtil.split(StringUtil.merge(list),0L);
    }
    articles=ArticleServiceUtil.getArticles(article.getGroupId(),resourcePrimKeys,WorkflowConstants.STATUS_APPROVED,null,QueryUtil.ALL_POS,QueryUtil.ALL_POS,null);
    articles=sortPortletPreferencesArticles(resourcePrimKeys,articles);
  }
  String rootPortletId=PortletConstants.getRootPortletId(portletId);
  if (rootPortletId.equals(PortletKeys.KNOWLEDGE_BASE_DISPLAY)) {
    articles=ListUtil.subList(articles,0,1);
  }
  if (selectionMethod.equals("articles") || (classPKs != null) || rootPortletId.equals(PortletKeys.KNOWLEDGE_BASE_DISPLAY)) {
    List<Article> rootArticles=new UniqueList<Article>();
    for (    Article curArticle : articles) {
      while (curArticle.getParentResourcePrimKey() != ArticleConstants.DEFAULT_PARENT_RESOURCE_PRIM_KEY) {
        curArticle=ArticleServiceUtil.getLatestArticle(curArticle.getParentResourcePrimKey(),WorkflowConstants.STATUS_APPROVED);
      }
      rootArticles.add(curArticle);
    }
    articles=rootArticles;
  }
  long[] selResourcePrimKeys=StringUtil.split(ListUtil.toString(articles,"resourcePrimKey"),0L);
  while (resourcePrimKey != ArticleConstants.DEFAULT_PARENT_RESOURCE_PRIM_KEY) {
    if (ArrayUtil.contains(selResourcePrimKeys,resourcePrimKey)) {
      return true;
    }
    Article curArticle=ArticleServiceUtil.getLatestArticle(resourcePrimKey,WorkflowConstants.STATUS_APPROVED);
    resourcePrimKey=curArticle.getParentResourcePrimKey();
  }
  return false;
}
