{
  JSONObject jsonObj=JSONFactoryUtil.createJSONObject();
  Message message=null;
  if (messageType.equalsIgnoreCase("new")) {
    message=new MimeMessage(getSession());
    send(message,fromEmailAddress,to,cc,bcc,subject,multipart);
    jsonObj.put("success",true);
  }
 else {
    Message oldMessage=getMessageByUid(folderName,messageUid);
    if (messageType.equalsIgnoreCase("forward")) {
      message=new MimeMessage(getSession());
      if (multipart == null) {
        multipart=new MimeMultipart();
      }
      BodyPart messageBodyPart=new MimeBodyPart();
      messageBodyPart.setDataHandler(message.getDataHandler());
      multipart.addBodyPart(messageBodyPart);
      send(oldMessage,fromEmailAddress,to,cc,bcc,subject,multipart);
      jsonObj.put("success",true);
    }
 else     if (messageType.equalsIgnoreCase("reply")) {
      message=(MimeMessage)oldMessage.reply(false);
      send(message,fromEmailAddress,to,cc,bcc,subject,multipart);
      jsonObj.put("success",true);
    }
 else {
      jsonObj.put("success",false);
    }
  }
  return jsonObj;
}
