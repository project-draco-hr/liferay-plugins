{
  SimpleDateFormat sdf=new SimpleDateFormat("MMM dd yyyy HH:mm");
  String date=StringPool.BLANK;
  if (Validator.isNotNull(message.getSentDate())) {
    date=sdf.format(message.getSentDate());
  }
  StringBuilder sb=new StringBuilder();
  List<Object[]> attachments=new ArrayList<Object[]>();
  getBody(sb,StringPool.BLANK,message,attachments);
  JSONObject jsonObj=JSONFactoryUtil.createJSONObject();
  jsonObj.put("attachments",getJSONAttachments(attachments));
  jsonObj.put("body",sb.toString());
  jsonObj.put("bodyPreview",getBodyPreview(sb.toString()));
  jsonObj.put("date",date);
  jsonObj.put("from",getAddresses(message.getFrom()));
  jsonObj.put("html",false);
  jsonObj.put("messageNumber",message.getMessageNumber());
  jsonObj.put("read",message.isSet(Flags.Flag.SEEN));
  jsonObj.put("subject",message.getSubject());
  jsonObj.put("uid",((IMAPFolder)folder).getUID(message));
  jsonObj.put("to",getAddresses(message.getRecipients(RecipientType.TO)));
  jsonObj.put("cc",getAddresses(message.getRecipients(RecipientType.CC)));
  jsonObj.put("bcc",getAddresses(message.getRecipients(RecipientType.BCC)));
  return jsonObj;
}
