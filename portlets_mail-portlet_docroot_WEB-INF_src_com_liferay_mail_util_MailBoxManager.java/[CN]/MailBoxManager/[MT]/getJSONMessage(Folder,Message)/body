{
  SimpleDateFormat sdf=new SimpleDateFormat("MMM dd yyyy HH:mm");
  String date="";
  if (Validator.isNotNull(message.getSentDate())) {
    date=sdf.format(message.getSentDate());
  }
  StringBuilder sb=new StringBuilder();
  List<Object[]> attachments=new ArrayList<Object[]>();
  getBody(sb,StringPool.BLANK,message,attachments);
  JSONObject jsonObj=new JSONObject();
  JSONUtil.put(jsonObj,"attachments",getJSONAttachments(attachments));
  JSONUtil.put(jsonObj,"body",sb.toString());
  JSONUtil.put(jsonObj,"bodyPreview",getBodyPreview(sb.toString()));
  JSONUtil.put(jsonObj,"date",date);
  JSONUtil.put(jsonObj,"from",getAddresses(message.getFrom()));
  JSONUtil.put(jsonObj,"html",false);
  JSONUtil.put(jsonObj,"messageNumber",message.getMessageNumber());
  JSONUtil.put(jsonObj,"read",message.isSet(Flags.Flag.SEEN));
  JSONUtil.put(jsonObj,"subject",message.getSubject());
  JSONUtil.put(jsonObj,"uid",((IMAPFolder)folder).getUID(message));
  JSONUtil.put(jsonObj,"to",getAddresses(message.getRecipients(RecipientType.TO)));
  JSONUtil.put(jsonObj,"cc",getAddresses(message.getRecipients(RecipientType.CC)));
  JSONUtil.put(jsonObj,"bcc",getAddresses(message.getRecipients(RecipientType.BCC)));
  return jsonObj;
}
