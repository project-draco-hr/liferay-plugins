{
  SearchTerm st=getSearchTerm(searchString);
  Message[] messages=folder.search(st);
  int messageCount=messages.length;
  int begin=(pageNumber - 1) * messagesPerPage;
  int end=begin + messagesPerPage - 1;
  if (end >= messageCount) {
    end=messageCount - 1;
  }
  double pageCount=Math.ceil((double)messageCount / messagesPerPage);
  JSONObject jsonObj=new JSONObject();
  JSONArray jsonArray=new JSONArray();
  JSONUtil.put(jsonObj,"pageCount",pageCount);
  JSONUtil.put(jsonObj,"messageCount",messageCount);
  JSONUtil.put(jsonObj,"begin",begin);
  JSONUtil.put(jsonObj,"end",end);
  JSONUtil.put(jsonObj,"pageNumber",pageNumber);
  JSONUtil.put(jsonObj,"messagesPerPage",messagesPerPage);
  for (int i=begin; i <= end; i++) {
    Message message=messages[i];
    jsonArray.put(getJSONMessage(folder,message,true));
  }
  JSONUtil.put(jsonObj,"messages",jsonArray);
  return jsonObj.toString();
}
