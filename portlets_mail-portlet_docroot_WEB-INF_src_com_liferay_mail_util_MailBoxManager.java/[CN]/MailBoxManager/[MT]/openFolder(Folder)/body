{
  if (folder.isOpen()) {
    return folder;
  }
  try {
    folder.open(Folder.READ_WRITE);
  }
 catch (  MessagingException me1) {
    Store store=folder.getStore();
    if (!store.isConnected()) {
      store=getStore(true);
    }
    folder=store.getFolder(folder.getFullName());
    folder.open(Folder.READ_WRITE);
  }
  return folder;
}
