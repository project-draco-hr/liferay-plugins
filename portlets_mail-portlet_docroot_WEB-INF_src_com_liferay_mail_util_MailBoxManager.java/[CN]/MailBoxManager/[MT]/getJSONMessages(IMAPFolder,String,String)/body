{
  int[] messageNumsArray=GetterUtil.getIntegerValues(messageNumsToGet.split("\\s*,\\s*"));
  int[] messageUidsArray=GetterUtil.getIntegerValues(messageUidsToExclude.split("\\s*,\\s*"));
  JSONObject jsonObj=new JSONObject();
  JSONArray jsonArray=new JSONArray();
  if (messageNumsArray.length != 0) {
    for (int i=0; i < messageNumsArray.length; i++) {
      Message message=folder.getMessage(messageNumsArray[i]);
      long messageUid=folder.getUID(message);
      if (messageUidsArray.length != 0) {
        for (int j=0; j < messageUidsArray.length; j++) {
          if (messageUid == messageUidsArray[j]) {
            try {
              jsonArray.put((int)messageUid,"");
            }
 catch (            JSONException jsone) {
              if (_log.isWarnEnabled()) {
                _log.warn(jsone,jsone);
              }
            }
            continue;
          }
        }
      }
      try {
        jsonArray.put((int)messageUid,getJSONMessage(folder,message,true));
      }
 catch (      JSONException jsone) {
        if (_log.isWarnEnabled()) {
          _log.warn(jsone,jsone);
        }
      }
    }
  }
  JSONUtil.put(jsonObj,"messages",jsonArray);
  return jsonObj.toString();
}
