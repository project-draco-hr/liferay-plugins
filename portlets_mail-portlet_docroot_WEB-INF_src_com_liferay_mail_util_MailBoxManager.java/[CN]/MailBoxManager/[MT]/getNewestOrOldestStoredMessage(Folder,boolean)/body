{
  MessageCache mdManager=new MessageCache(_user);
  long[] messageUids=mdManager.getMessageUidsByFolder(_mailAccount.getEmailAddress(),folder.getFullName());
  if (Validator.isNull(folder)) {
    return null;
  }
  if (messageUids.length == 0) {
    return null;
  }
  Arrays.sort(messageUids);
  if (newest) {
    for (int i=messageUids.length - 1; i >= 0; i--) {
      try {
        return getMessageByUid(folder,messageUids[i]);
      }
 catch (      MessagingException me) {
        deleteMessage(folder,messageUids[i],false);
      }
    }
  }
 else {
    for (int i=0; i < messageUids.length; i++) {
      try {
        return getMessageByUid(folder,messageUids[i]);
      }
 catch (      MessagingException me) {
        deleteMessage(folder,messageUids[i],false);
      }
    }
  }
  return null;
}
