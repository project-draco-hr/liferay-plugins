{
  String transportKey=_mailAccount.getUser().getUserId() + "_TRANSPORT_" + _mailAccount.getEmailAddress();
  Transport transport=null;
  Session session=getSession(mailAccount);
  if (mailAccount.isMailOutSecure()) {
    transport=session.getTransport("smtps");
  }
 else {
    transport=session.getTransport("smtp");
  }
  transport.addConnectionListener(new ConnectionListener(transportKey));
  transport.connect(mailAccount.getMailOutHostName(),mailAccount.getMailOutPort(),mailAccount.getUsername(),mailAccount.getPassword());
  return transport;
}
