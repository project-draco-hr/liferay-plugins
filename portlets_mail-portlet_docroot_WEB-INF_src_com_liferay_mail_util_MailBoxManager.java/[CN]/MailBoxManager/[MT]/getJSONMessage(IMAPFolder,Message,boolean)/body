{
  String read="read";
  if (!message.isSet(Flags.Flag.SEEN)) {
    read="unread";
  }
  SimpleDateFormat sdf=new SimpleDateFormat("MMM dd yyyy HH:mm");
  JSONObject jsonObj=new JSONObject();
  JSONUtil.put(jsonObj,"date",sdf.format(message.getSentDate()));
  JSONUtil.put(jsonObj,"from",getAddresses(message.getFrom()));
  JSONUtil.put(jsonObj,"attachment",false);
  JSONUtil.put(jsonObj,"html",false);
  JSONUtil.put(jsonObj,"msgNum",String.valueOf(message.getMessageNumber()));
  JSONUtil.put(jsonObj,"read",read);
  JSONUtil.put(jsonObj,"subject",message.getSubject());
  JSONUtil.put(jsonObj,"uid",folder.getUID(message));
  if (preview) {
    JSONUtil.put(jsonObj,"bodyPreview",StringPool.BLANK);
  }
 else {
    JSONUtil.put(jsonObj,"to",getAddresses(message.getRecipients(RecipientType.TO)));
    JSONUtil.put(jsonObj,"cc",getAddresses(message.getRecipients(RecipientType.CC)));
    JSONUtil.put(jsonObj,"bcc",getAddresses(message.getRecipients(RecipientType.BCC)));
    JSONUtil.put(jsonObj,"body",getContent("","",message,false));
  }
  return jsonObj;
}
