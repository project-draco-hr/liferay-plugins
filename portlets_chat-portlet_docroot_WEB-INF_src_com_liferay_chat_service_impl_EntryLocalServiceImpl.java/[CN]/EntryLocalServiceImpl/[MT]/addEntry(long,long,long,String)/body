{
  if (Validator.isNull(content)) {
    content=StringPool.BLANK;
    List<Entry> entries=entryFinder.findByEmptyContent(fromUserId,toUserId,0,5);
    for (    Entry entry : entries) {
      entryPersistence.remove(entry);
    }
  }
 else {
    if (content.length() > 500) {
      content=content.substring(0,500);
    }
  }
  long entryId=CounterLocalServiceUtil.increment();
  Entry entry=entryPersistence.create(entryId);
  entry.setCreateDate(createDate);
  entry.setFromUserId(fromUserId);
  entry.setToUserId(toUserId);
  entry.setContent(content);
  entryPersistence.update(entry,false);
  return entry;
}
