{
  JbpmContext jbpmContext=_jbpmConfiguration.createJbpmContext();
  try {
    LoggingSession loggingSession=jbpmContext.getLoggingSession();
    Token token=jbpmContext.loadToken(workflowInstanceId);
    List<ProcessLog> processLogs=loggingSession.findLogsByToken(token);
    int count=processLogs.size();
    if (includeChildren) {
      Stack<Token> tokenStack=new Stack<Token>();
      tokenStack.addAll(token.getChildren().values());
      while (tokenStack.isEmpty() == false) {
        Token childToken=tokenStack.pop();
        processLogs=loggingSession.findLogsByToken(childToken);
        count+=processLogs.size();
        tokenStack.addAll(childToken.getChildren().values());
      }
    }
    return count;
  }
 catch (  Exception e) {
    throw new WorkflowException(e);
  }
 finally {
    jbpmContext.close();
  }
}
