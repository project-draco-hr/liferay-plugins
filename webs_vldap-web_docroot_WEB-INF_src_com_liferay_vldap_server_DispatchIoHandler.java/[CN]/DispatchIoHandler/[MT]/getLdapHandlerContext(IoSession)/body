{
  LdapHandlerContext ldapHandlerContext=(LdapHandlerContext)ioSession.getAttribute(LdapHandlerContext.class.getName());
  if (ldapHandlerContext == null) {
synchronized (ioSession) {
      if (ldapHandlerContext == null) {
        ldapHandlerContext=new LdapHandlerContext();
        ldapHandlerContext.setDirectory(_vldapServer.getDirectory());
        ldapHandlerContext.setSchemaManager(_vldapServer.getSchemaManager());
        ioSession.setAttribute(LdapHandlerContext.class.getName(),ldapHandlerContext);
      }
    }
  }
  return ldapHandlerContext;
}
