{
  String[] lineParts=StringUtil.split(line);
  int endPeriodOffset=GetterUtil.getInteger(lineParts[3]);
  int endPeriod=SocialCounterPeriodUtil.getEndPeriod(endPeriodOffset);
  if (endPeriod < 0) {
    return;
  }
  String className=lineParts[0];
  long classNameId=PortalUtil.getClassNameId(className);
  String classPKString=lineParts[1];
  long classPK=12345;
  if (className.equals(User.class.getName())) {
    if (classPKString.equals("0")) {
      int index=getRandomNumber(0,3);
      User user=users.get(index);
      classPK=user.getUserId();
    }
 else {
      for (      User user : users) {
        if (classPKString.equalsIgnoreCase(user.getScreenName())) {
          classPK=user.getUserId();
        }
      }
    }
  }
 else {
    AssetEntryQuery assetEntryQuery=new AssetEntryQuery();
    assetEntryQuery.setClassName(className);
    assetEntryQuery.setGroupIds(new long[]{group.getGroupId()});
    List<AssetEntry> assetEntries=AssetEntryLocalServiceUtil.getEntries(assetEntryQuery);
    if (!assetEntries.isEmpty()) {
      int index=getRandomNumber(0,assetEntries.size() - 1);
      AssetEntry assetEntry=assetEntries.get(index);
      classPK=assetEntry.getClassPK();
    }
  }
  int ownerType=SocialActivityCounterConstants.TYPE_ACTOR;
  if (socialActivityCounterName.startsWith("asset.")) {
    ownerType=SocialActivityCounterConstants.TYPE_ASSET;
  }
 else   if (socialActivityCounterName.equals("contribution")) {
    ownerType=SocialActivityCounterConstants.TYPE_CREATOR;
  }
  int startPeriodOffset=GetterUtil.getInteger(lineParts[2]);
  int startPeriod=SocialCounterPeriodUtil.getStartPeriod(startPeriodOffset);
  SocialActivityCounter socialActivityCounter=SocialActivityCounterLocalServiceUtil.fetchActivityCounterByStartPeriod(group.getGroupId(),classNameId,classPK,socialActivityCounterName,ownerType,startPeriod);
  int currentValue=getRandomNumber(0,100);
  int totalValue=currentValue;
  if (socialActivityCounter != null) {
    totalValue=totalValue + socialActivityCounter.getTotalValue();
  }
  StringBundler sb=new StringBundler(7);
  sb.append(StringUtil.toHexString(group.getGroupId()));
  sb.append(StringPool.POUND);
  sb.append(StringUtil.toHexString(classNameId));
  sb.append(StringPool.POUND);
  sb.append(StringUtil.toHexString(classPK));
  sb.append(StringPool.POUND);
  sb.append(StringUtil.toHexString(socialActivityCounterName));
  String key=sb.toString();
  SocialActivityCounter latestSocialActivityCounter=socialActivityCounters.get(key);
  if (latestSocialActivityCounter != null) {
    totalValue=totalValue + latestSocialActivityCounter.getTotalValue();
  }
  if ((socialActivityCounter == null) || (socialActivityCounter.getStartPeriod() != startPeriod)) {
    if (endPeriodOffset == 0) {
      endPeriod=-1;
    }
    socialActivityCounter=SocialActivityCounterLocalServiceUtil.addActivityCounter(group.getGroupId(),classNameId,classPK,socialActivityCounterName,ownerType,0,0,startPeriod,endPeriod);
  }
  socialActivityCounter.setCurrentValue(socialActivityCounter.getCurrentValue() + currentValue);
  socialActivityCounter.setTotalValue(totalValue);
  SocialActivityCounterLocalServiceUtil.updateSocialActivityCounter(socialActivityCounter);
  socialActivityCounters.put(key,socialActivityCounter);
}
