{
  String name=PrincipalThreadLocal.getName();
  try {
    long companyId=PortalUtil.getDefaultCompanyId();
    long defaultUserId=UserLocalServiceUtil.getDefaultUserId(companyId);
    PrincipalThreadLocal.setName(defaultUserId);
    clearData(companyId);
    setupSites(companyId,defaultUserId);
    Organization organization=setupOrganizations(companyId,defaultUserId);
    setupRoles(companyId,defaultUserId);
    List<User> users=setupUsers(companyId);
    setupSocialActivityCounters(organization.getGroup(),users);
    setupWorkflow(companyId,defaultUserId);
  }
  finally {
    PrincipalThreadLocal.setName(name);
  }
}
