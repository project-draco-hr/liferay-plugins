{
  List<User> users=UserLocalServiceUtil.search(companyId,null,WorkflowConstants.STATUS_ANY,null,QueryUtil.ALL_POS,QueryUtil.ALL_POS,(OrderByComparator)null);
  for (  User user : users) {
    String screenName=user.getScreenName();
    if (screenName.equals("joebloggs") || screenName.equals("test")) {
      continue;
    }
    UserLocalServiceUtil.deleteUser(user.getUserId());
  }
  List<Group> groups=GroupLocalServiceUtil.search(companyId,null,null,null,QueryUtil.ALL_POS,QueryUtil.ALL_POS);
  for (  Group group : groups) {
    IGFolderLocalServiceUtil.deleteFolders(group.getGroupId());
    JournalArticleLocalServiceUtil.deleteArticles(group.getGroupId());
    JournalTemplateLocalServiceUtil.deleteTemplates(group.getGroupId());
    JournalStructureLocalServiceUtil.deleteStructures(group.getGroupId());
    if (!PortalUtil.isSystemGroup(group.getName())) {
      GroupLocalServiceUtil.deleteGroup(group.getGroupId());
    }
 else {
      LayoutLocalServiceUtil.deleteLayouts(group.getGroupId(),false);
      LayoutLocalServiceUtil.deleteLayouts(group.getGroupId(),true);
    }
  }
  deleteOrganizations(companyId,OrganizationConstants.DEFAULT_PARENT_ORGANIZATION_ID);
}
