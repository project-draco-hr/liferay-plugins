{
  List<User> users=UserLocalServiceUtil.search(companyId,null,WorkflowConstants.STATUS_ANY,null,QueryUtil.ALL_POS,QueryUtil.ALL_POS,(OrderByComparator)null);
  for (  User user : users) {
    String screenName=user.getScreenName();
    if (screenName.equals("joebloggs") || screenName.equals("test")) {
      continue;
    }
    UserLocalServiceUtil.deleteUser(user.getUserId());
  }
  deleteOrganizations(companyId,OrganizationConstants.DEFAULT_PARENT_ORGANIZATION_ID);
  List<Group> groups=GroupLocalServiceUtil.search(companyId,null,null,null,QueryUtil.ALL_POS,QueryUtil.ALL_POS);
  for (  Group group : groups) {
    if (!PortalUtil.isSystemGroup(group.getName())) {
      GroupLocalServiceUtil.deleteGroup(group.getGroupId());
    }
 else {
      ServiceContext serviceContext=new ServiceContext();
      DLAppLocalServiceUtil.deleteAll(group.getGroupId());
      JournalArticleLocalServiceUtil.deleteArticles(group.getGroupId());
      JournalTemplateLocalServiceUtil.deleteTemplates(group.getGroupId());
      JournalStructureLocalServiceUtil.deleteStructures(group.getGroupId());
      LayoutLocalServiceUtil.deleteLayouts(group.getGroupId(),false,serviceContext);
      LayoutLocalServiceUtil.deleteLayouts(group.getGroupId(),true,serviceContext);
    }
  }
}
