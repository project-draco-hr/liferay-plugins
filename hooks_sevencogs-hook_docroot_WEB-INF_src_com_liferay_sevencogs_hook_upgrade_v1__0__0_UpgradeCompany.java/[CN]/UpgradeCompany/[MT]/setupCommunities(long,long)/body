{
  Group group=GroupLocalServiceUtil.getGroup(companyId,GroupConstants.GUEST);
  addJournalStructure(defaultUserId,group.getGroupId(),"/guest/journal/structures/single_image.xml");
  addJournalTemplate(defaultUserId,group.getGroupId(),"/guest/journal/templates/single_image.xml");
  ServiceContext serviceContext=new ServiceContext();
  serviceContext.setAddGroupPermissions(true);
  serviceContext.setAddGuestPermissions(true);
  serviceContext.setScopeGroupId(group.getGroupId());
  Folder folder=DLAppLocalServiceUtil.addFolder(defaultUserId,group.getGroupId(),0,"Web Content","Images used for content",serviceContext);
  FileEntry cellBgFileEntry=addDLFileEntry(defaultUserId,folder.getFolderId(),"/guest/images/cell_bg.png",serviceContext);
  FileEntry customer1FileEntry=addDLFileEntry(defaultUserId,folder.getFolderId(),"/guest/images/customer_1.png",serviceContext);
  FileEntry customer2FileEntry=addDLFileEntry(defaultUserId,folder.getFolderId(),"/guest/images/customer_2.png",serviceContext);
  FileEntry customer3FileEntry=addDLFileEntry(defaultUserId,folder.getFolderId(),"/guest/images/customer_3.png",serviceContext);
  FileEntry customer4FileEntry=addDLFileEntry(defaultUserId,folder.getFolderId(),"/guest/images/customer_4.png",serviceContext);
  FileEntry customer5FileEntry=addDLFileEntry(defaultUserId,folder.getFolderId(),"/guest/images/customer_5.png",serviceContext);
  FileEntry customer6FileEntry=addDLFileEntry(defaultUserId,folder.getFolderId(),"/guest/images/customer_6.png",serviceContext);
  FileEntry customer7FileEntry=addDLFileEntry(defaultUserId,folder.getFolderId(),"/guest/images/customer_7.png",serviceContext);
  FileEntry portalMashupFileEntry=addDLFileEntry(defaultUserId,folder.getFolderId(),"/guest/images/portal_mashup.png",serviceContext);
  FileEntry sevenCogsAdFileEntry=addDLFileEntry(defaultUserId,folder.getFolderId(),"/guest/images/sevencogs_ad.png",serviceContext);
  FileEntry sharedWorkspacesFileEntry=addDLFileEntry(defaultUserId,folder.getFolderId(),"/guest/images/shared_workspaces.png",serviceContext);
  FileEntry socialNetworkingFileEntry=addDLFileEntry(defaultUserId,folder.getFolderId(),"/guest/images/social_network.png",serviceContext);
  FileEntry webPublishingFileEntry=addDLFileEntry(defaultUserId,folder.getFolderId(),"/guest/images/web_publishing.png",serviceContext);
  String noPortletBorders="lfr-theme:regular:portlet-setup-show-borders-default=false";
  LayoutSetLocalServiceUtil.updateSettings(group.getGroupId(),false,noPortletBorders);
  Layout layout=addLayout(group,"Welcome",false,"/home","2_columns_iii");
  String portletId=addPortletId(layout,PortletKeys.JOURNAL_CONTENT,"column-1");
  removePortletBorder(layout,portletId);
  serviceContext.setAssetTagNames(new String[]{"liferay","welcome"});
  JournalArticle journalArticle=addJournalArticle(defaultUserId,group.getGroupId(),"Welcome","/guest/journal/articles/welcome.xml",serviceContext);
  String content=StringUtil.replace(journalArticle.getContent(),new String[]{"[$CELL_BG_IG_IMAGE_UUID$]","[$CUSTOMER_1_IG_IMAGE_UUID$]","[$CUSTOMER_2_IG_IMAGE_UUID$]","[$CUSTOMER_3_IG_IMAGE_UUID$]","[$CUSTOMER_4_IG_IMAGE_UUID$]","[$CUSTOMER_5_IG_IMAGE_UUID$]","[$CUSTOMER_6_IG_IMAGE_UUID$]","[$CUSTOMER_7_IG_IMAGE_UUID$]","[$GROUP_ID$]","[$PORTAL_MASHUPS_IG_IMAGE_UUID$]","[$SHARED_WORKSPACES_IG_IMAGE_UUID$]","[$SOCIAL_NETWORKING_IG_IMAGE_UUID$]","[$WEB_PUBLISHING_IG_IMAGE_UUID$]"},new String[]{String.valueOf(cellBgFileEntry.getUuid()),String.valueOf(customer1FileEntry.getUuid()),String.valueOf(customer2FileEntry.getUuid()),String.valueOf(customer3FileEntry.getUuid()),String.valueOf(customer4FileEntry.getUuid()),String.valueOf(customer5FileEntry.getUuid()),String.valueOf(customer6FileEntry.getUuid()),String.valueOf(customer7FileEntry.getUuid()),String.valueOf(group.getGroupId()),String.valueOf(portalMashupFileEntry.getUuid()),String.valueOf(sharedWorkspacesFileEntry.getUuid()),String.valueOf(socialNetworkingFileEntry.getUuid()),String.valueOf(webPublishingFileEntry.getUuid())});
  JournalArticleLocalServiceUtil.updateContent(group.getGroupId(),journalArticle.getArticleId(),journalArticle.getVersion(),content);
  configureJournalContent(layout,portletId,journalArticle.getArticleId());
  portletId=addPortletId(layout,PortletKeys.JOURNAL_CONTENT,"column-2");
  removePortletBorder(layout,portletId);
  serviceContext.setAssetTagNames(new String[]{"liferay","7cogs"});
  journalArticle=addJournalArticle(defaultUserId,group.getGroupId(),"7Cogs Ad","/guest/journal/articles/sample_site_ad.xml",serviceContext);
  content=StringUtil.replace(journalArticle.getContent(),new String[]{"[$GROUP_ID$]","[$GROUP_URL$]","[$IG_IMAGE_UUID$]"},new String[]{String.valueOf(group.getGroupId()),"/web/7cogs/home",String.valueOf(sevenCogsAdFileEntry.getUuid())});
  JournalArticleLocalServiceUtil.updateContent(group.getGroupId(),journalArticle.getArticleId(),journalArticle.getVersion(),content);
  configureJournalContent(layout,portletId,journalArticle.getArticleId());
  portletId=addPortletId(layout,PortletKeys.JOURNAL_CONTENT,"column-2");
  removePortletBorder(layout,portletId);
  serviceContext.setAssetTagNames(new String[]{"welcome"});
  journalArticle=addJournalArticle(defaultUserId,group.getGroupId(),"Welcome Note","/guest/journal/articles/welcome_note.xml",serviceContext);
  configureJournalContent(layout,portletId,journalArticle.getArticleId());
  portletId=addPortletId(layout,PortletKeys.JOURNAL_CONTENT,"column-2");
  serviceContext.setAssetTagNames(new String[]{"login","users","welcome"});
  journalArticle=addJournalArticle(defaultUserId,group.getGroupId(),"Welcome Login","/guest/journal/articles/welcome_login.xml",serviceContext);
  content=StringUtil.replace(journalArticle.getContent(),"[$COMPANY_ID$]",String.valueOf(companyId));
  JournalArticleLocalServiceUtil.updateContent(group.getGroupId(),journalArticle.getArticleId(),journalArticle.getVersion(),content);
  configureJournalContent(layout,portletId,journalArticle.getArticleId());
  configurePortletTitle(layout,portletId,"Current Users");
  addPortletId(layout,PortletKeys.LOGIN,"column-2");
}
