{
  List<User> users=UserLocalServiceUtil.getUsers(QueryUtil.ALL_POS,QueryUtil.ALL_POS);
  for (  User user : users) {
    try {
      if (user.isDefaultUser()) {
        continue;
      }
      Group group=user.getGroup();
      LayoutSet layoutSet=LayoutSetLocalServiceUtil.getLayoutSet(group.getGroupId(),false);
      String themeId=layoutSet.getThemeId();
      if (!themeId.equals("so_WAR_sotheme")) {
        return;
      }
      Role role=RoleLocalServiceUtil.getRole(user.getCompanyId(),"Social Office User");
      UserLocalServiceUtil.addRoleUsers(role.getRoleId(),new long[]{user.getUserId()});
      updateUserGroup(group);
      updateSocialRelations(user);
    }
 catch (    Exception e) {
    }
  }
}
