{
  super.processMailMessage(mailMessage,locale);
  InternetAddress from=mailMessage.getFrom();
  String categoryTitle=LanguageUtil.get(locale,"category.kb");
  String portletName=PortalUtil.getPortletTitle(PortletKeys.KNOWLEDGE_BASE_ADMIN,locale);
  String processedFromAddress=StringUtil.replace(from.getAddress(),new String[]{"[$CATEGORY_TITLE$]","[$PORTLET_NAME$]"},new String[]{categoryTitle,portletName});
  String processedFromName=StringUtil.replace(from.getPersonal(),new String[]{"[$CATEGORY_TITLE$]","[$PORTLET_NAME$]"},new String[]{categoryTitle,portletName});
  InternetAddress processedFrom=new InternetAddress(processedFromAddress,processedFromName);
  mailMessage.setFrom(processedFrom);
  String articleAttachments=getEmailArticleAttachments(_article,locale);
  String articleURL=(String)context.get("articleURL");
  String articleVersion=LanguageUtil.format(locale,"version-x",String.valueOf(_article.getVersion()),false);
  String processedSubject=StringUtil.replace(subject,new String[]{"[$ARTICLE_ATTACHMENTS$]","[$ARTICLE_URL$]","[$ARTICLE_VERSION$]","[$CATEGORY_TITLE$]","[$PORTLET_NAME$]"},new String[]{articleAttachments,articleURL,articleVersion,categoryTitle,portletName});
  mailMessage.setSubject(processedSubject);
  String processedBody=StringUtil.replace(body,new String[]{"[$ARTICLE_ATTACHMENTS$]","[$ARTICLE_URL$]","[$ARTICLE_VERSION$]","[$CATEGORY_TITLE$]","[$PORTLET_NAME$]"},new String[]{articleAttachments,articleURL,articleVersion,categoryTitle,portletName});
  mailMessage.setBody(processedBody);
}
