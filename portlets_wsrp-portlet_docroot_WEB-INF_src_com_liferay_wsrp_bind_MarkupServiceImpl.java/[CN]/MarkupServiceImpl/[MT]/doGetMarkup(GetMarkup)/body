{
  WSRPProducer wsrpProducer=getWSRPProducer();
  String url=getURL(getMarkup,wsrpProducer);
  Http.Options httpOptions=new Http.Options();
  httpOptions.setLocation(url);
  MarkupParams markupParams=getMarkup.getMarkupParams();
  ClientData clientData=markupParams.getClientData();
  NamedString[] clientAttributes=clientData.getClientAttributes();
  for (  NamedString clientAttribute : clientAttributes) {
    String name=clientAttribute.getName();
    String value=clientAttribute.getValue();
    if (name.equalsIgnoreCase(HttpHeaders.ACCEPT_ENCODING) || name.equalsIgnoreCase(HttpHeaders.COOKIE)) {
      continue;
    }
    httpOptions.addHeader(name,value);
  }
  String content=HttpUtil.URLtoString(httpOptions);
  MarkupContext markupContext=new MarkupContext();
  markupContext.setItemString(content);
  markupContext.setRequiresRewriting(true);
  MarkupResponse markupResponse=new MarkupResponse();
  markupResponse.setMarkupContext(markupContext);
  return markupResponse;
}
