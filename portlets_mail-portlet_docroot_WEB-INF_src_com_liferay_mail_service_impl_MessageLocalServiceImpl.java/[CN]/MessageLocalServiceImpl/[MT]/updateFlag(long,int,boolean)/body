{
  Message message=messagePersistence.findByPrimaryKey(messageId);
  String flags=message.getFlags();
  String flagString=flag + StringPool.COMMA;
  if (value && (flags.indexOf(flagString) == -1)) {
    message.setFlags(flags + flagString);
  }
 else   if (!value && (flags.indexOf(flagString) != -1)) {
    message.setFlags(flags.replace(flagString,StringPool.BLANK));
  }
  return messagePersistence.update(message,false);
}
