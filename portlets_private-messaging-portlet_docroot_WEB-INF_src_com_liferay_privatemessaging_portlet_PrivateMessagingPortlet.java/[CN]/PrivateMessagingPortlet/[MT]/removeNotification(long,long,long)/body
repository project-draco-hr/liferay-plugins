{
  List<NotificationEvent> notificationEvents=null;
  try {
    notificationEvents=ChannelHubManagerUtil.getNotificationEvents(companyId,userId,true);
  }
 catch (  UnknownChannelException e) {
    Channel channel=ChannelHubManagerUtil.getChannel(companyId,userId,true);
    notificationEvents=channel.getNotificationEvents();
  }
  for (  NotificationEvent notificationEvent : notificationEvents) {
    JSONObject notificationEventJSONObject=notificationEvent.getPayload();
    String portletId=notificationEventJSONObject.getString("portletId");
    long entryId=notificationEventJSONObject.getLong("entryId");
    if (portletId.equals(PortletKeys.PRIVATE_MESSAGING) && (entryId == mbThreadId)) {
      ChannelHubManagerUtil.deleteUserNotificiationEvent(companyId,userId,notificationEvent.getUuid());
    }
  }
}
