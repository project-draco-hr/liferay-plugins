{
  List<Company> companies=CompanyLocalServiceUtil.getCompanies();
  IndicesAdminClient indicesAdminClient=adminClient.indices();
  for (  Company company : companies) {
    IndicesExistsRequestBuilder indicesExistsRequestBuilder=indicesAdminClient.prepareExists(String.valueOf(company.getCompanyId()));
    ListenableActionFuture<IndicesExistsResponse> indicesExistsRequestFuture=indicesExistsRequestBuilder.execute();
    IndicesExistsResponse indicesExistsResponse=indicesExistsRequestFuture.get();
    if (indicesExistsResponse.isExists()) {
      continue;
    }
    CreateIndexRequestBuilder createIndexRequestBuilder=indicesAdminClient.prepareCreate(String.valueOf(company.getCompanyId()));
    for (    Map.Entry<String,String> typeMappingEntry : _typeMappings.entrySet()) {
      String typeMapping=retrieveTypeMapping(typeMappingEntry.getValue());
      createIndexRequestBuilder.addMapping(typeMappingEntry.getKey(),typeMapping);
    }
    ListenableActionFuture<CreateIndexResponse> createIndexFuture=createIndexRequestBuilder.execute();
    CreateIndexResponse createIndexResponse=createIndexFuture.get();
    if (_log.isInfoEnabled()) {
      StringOutputStream stringOutputStream=new StringOutputStream();
      createIndexResponse.writeTo(new OutputStreamStreamOutput(stringOutputStream));
      _log.info(stringOutputStream);
    }
  }
}
