{
  InputStream inputStream=null;
  Set<String> resourcePaths=servletContext.getResourcePaths(_SCRIPTS_DIR);
  Set<String> servletContextNames=SetUtil.fromArray(StringUtil.split(requiredDeploymentContexts));
  servletContextNames.add(servletContext.getServletContextName());
  servletContextNames.add(ClassLoaderPool.getContextName(PortalClassLoaderUtil.getClassLoader()));
  for (  String resourcePath : resourcePaths) {
    if (resourcePath.endsWith(StringPool.SLASH)) {
      if (_log.isInfoEnabled()) {
        _log.info("Skipping directory " + resourcePath);
      }
      continue;
    }
    try {
      inputStream=servletContext.getResourceAsStream(resourcePath);
      ScriptingUtil.exec(null,new HashMap<String,Object>(),language,StringUtil.read(inputStream),servletContextNames.toArray(new String[servletContextNames.size()]));
    }
 catch (    Exception e) {
      _log.error("Unable to execute script " + resourcePath,e);
    }
 finally {
      StreamUtil.cleanUp(inputStream);
    }
  }
}
