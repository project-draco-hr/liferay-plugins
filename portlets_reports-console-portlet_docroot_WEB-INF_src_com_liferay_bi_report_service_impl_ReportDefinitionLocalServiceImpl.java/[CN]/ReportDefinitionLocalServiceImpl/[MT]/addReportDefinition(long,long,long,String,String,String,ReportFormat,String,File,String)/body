{
  long definitionId=CounterLocalServiceUtil.increment();
  ReportDefinition definition=reportDefinitionPersistence.create(definitionId);
  definition.setCompanyId(companyId);
  definition.setGroupId(groupId);
  definition.setUserId(userId);
  definition.setDefinitionName(definitionName);
  definition.setDescription(description);
  definition.setDataSourceName(datasourceName);
  definition.setReportFormat(format.toString());
  definition.setReportParameters(reportParameters);
  String portletId=CompanyConstants.SYSTEM_STRING;
  long repositoryId=0;
  long fileEntryId=0;
  String properties=StringPool.BLANK;
  Date modifiedDate=new Date();
  String[] tagsCategories=new String[0];
  String[] tagsEntries=new String[0];
  DLServiceUtil.addDirectory(companyId,repositoryId,definition.getAttachmentsDir());
  DLServiceUtil.addFile(companyId,portletId,groupId,repositoryId,definition.getAttachmentsDir() + StringPool.SLASH + fileName,fileEntryId,properties,modifiedDate,tagsCategories,tagsEntries,file);
  return addReportDefinition(definition);
}
