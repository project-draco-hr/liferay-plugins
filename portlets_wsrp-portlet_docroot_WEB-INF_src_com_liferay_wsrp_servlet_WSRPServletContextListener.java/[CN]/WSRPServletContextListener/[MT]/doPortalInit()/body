{
  WSRPFactoryUtil wsrpFactoryUtil=(WSRPFactoryUtil)PortalBeanLocatorUtil.locate(com.liferay.portal.wsrp.WSRPFactoryUtil.class.getName());
  wsrpFactoryUtil.setWSRPFactory(new WSRPFactoryImpl());
  Properties properties=PortletProps.getProperties();
  ServiceManager serviceManager=ServiceManager.getServiceManager();
  serviceManager.addService(Service.DEPLOYMENT_SERVICE_REMOTE,new DeploymentServiceRemoteImpl());
  WSRPConfig.init(properties,"portal1");
  WSRPPersistenceHelper wsrpPersistence=WSRPPersistenceHelper.getInstance();
  try {
    UserManagerImpl.getWSRPCompany();
  }
 catch (  Exception e) {
    _log.error(e);
  }
  if (isInitialDepoy()) {
    return;
  }
  List<Portlet> portlets=wsrpPersistence.getWSRPPortlets();
  for (  Portlet portlet : portlets) {
    PortletLocalServiceUtil.deployRemotePortlet(portlet);
  }
}
