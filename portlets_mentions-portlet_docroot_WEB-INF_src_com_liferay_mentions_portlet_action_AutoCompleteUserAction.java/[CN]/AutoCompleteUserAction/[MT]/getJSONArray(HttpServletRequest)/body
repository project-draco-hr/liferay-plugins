{
  String query=ParamUtil.getString(request,"query") + StringPool.STAR;
  JSONArray jsonArray=JSONFactoryUtil.createJSONArray();
  long userId=PrincipalThreadLocal.getUserId();
  long companyId=CompanyThreadLocal.getCompanyId();
  Hits hits=UserLocalServiceUtil.search(companyId,query,query,query,query,StringPool.BLANK,WorkflowConstants.STATUS_APPROVED,null,false,QueryUtil.ALL_POS,QueryUtil.ALL_POS,(Sort)null);
  List<User> users=UsersAdminUtil.getUsers(hits);
  ThemeDisplay themeDisplay=(ThemeDisplay)request.getAttribute(WebKeys.THEME_DISPLAY);
  for (  User user : users) {
    if (user.isDefaultUser() || (userId == user.getUserId())) {
      continue;
    }
    JSONObject userJSONObject=JSONFactoryUtil.createJSONObject();
    String portraitURL=user.getPortraitURL(themeDisplay);
    userJSONObject.put("portrait",portraitURL);
    userJSONObject.put("fullName",user.getFullName());
    userJSONObject.put("screenName",StringPool.AT + user.getScreenName());
    userJSONObject.put("text",user.getScreenName());
    jsonArray.put(userJSONObject);
  }
  return jsonArray;
}
