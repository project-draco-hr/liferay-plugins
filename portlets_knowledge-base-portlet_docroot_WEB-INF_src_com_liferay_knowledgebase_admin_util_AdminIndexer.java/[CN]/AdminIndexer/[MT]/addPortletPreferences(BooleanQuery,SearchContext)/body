{
  String selectionMethod=(String)searchContext.getAttribute("selectionMethod");
  if (Validator.isNull(selectionMethod)) {
    return;
  }
  if (selectionMethod.equals("articles")) {
    BooleanQuery booleanQuery=BooleanQueryFactoryUtil.create();
    long[] resourcePrimKeys=(long[])searchContext.getAttribute("resourcePrimKeys");
    for (    long resourcePrimKey : resourcePrimKeys) {
      booleanQuery.addExactTerm(Field.ENTRY_CLASS_PK,resourcePrimKey);
    }
    if (resourcePrimKeys.length == 0) {
      booleanQuery.addExactTerm(Field.ENTRY_CLASS_PK,new Long(0));
    }
    contextQuery.add(booleanQuery,BooleanClauseOccur.MUST);
    return;
  }
  Boolean assetEntryQueryAndOperator=(Boolean)searchContext.getAttribute("assetEntryQueryAndOperator");
  Boolean assetEntryQueryContains=(Boolean)searchContext.getAttribute("assetEntryQueryContains");
  String assetEntryQueryName=(String)searchContext.getAttribute("assetEntryQueryName");
  long[] assetCategoryIds=(long[])searchContext.getAttribute("assetCategoryIds");
  String[] assetTagNames=(String[])searchContext.getAttribute("assetTagNames");
  BooleanQuery booleanQuery=null;
  if ((assetEntryQueryName.equals("asset-categories")) && (assetCategoryIds.length > 0)) {
    booleanQuery=BooleanQueryFactoryUtil.create();
    for (    long assetCategoryId : assetCategoryIds) {
      if (searchContext.getUserId() > 0) {
        try {
          AssetCategoryServiceUtil.getCategory(assetCategoryId);
        }
 catch (        Exception e) {
          continue;
        }
      }
      if (assetEntryQueryAndOperator) {
        TermQuery termQuery=TermQueryFactoryUtil.create(Field.ASSET_CATEGORY_IDS,assetCategoryId);
        booleanQuery.add(termQuery,BooleanClauseOccur.MUST);
      }
 else {
        booleanQuery.addExactTerm(Field.ASSET_CATEGORY_IDS,assetCategoryId);
      }
    }
  }
  if ((assetEntryQueryName.equals("asset-tags")) && (assetTagNames.length > 0)) {
    booleanQuery=BooleanQueryFactoryUtil.create();
    for (    String assetTagName : assetTagNames) {
      if (assetEntryQueryAndOperator) {
        TermQuery termQuery=TermQueryFactoryUtil.create(Field.ASSET_TAG_NAMES,assetTagName);
        booleanQuery.add(termQuery,BooleanClauseOccur.MUST);
      }
 else {
        booleanQuery.addExactTerm(Field.ASSET_TAG_NAMES,assetTagName);
      }
    }
  }
  if (booleanQuery == null) {
    return;
  }
  if (assetEntryQueryContains) {
    contextQuery.add(booleanQuery,BooleanClauseOccur.MUST);
  }
 else {
    contextQuery.add(booleanQuery,BooleanClauseOccur.MUST_NOT);
  }
}
