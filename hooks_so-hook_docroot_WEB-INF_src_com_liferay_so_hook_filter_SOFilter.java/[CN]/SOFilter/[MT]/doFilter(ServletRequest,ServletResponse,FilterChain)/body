{
  try {
    HttpServletRequest request=(HttpServletRequest)servletRequest;
    long companyId=PortalUtil.getCompanyId(request);
    String path=PrefsPropsUtil.getString(companyId,PropsKeys.DEFAULT_LANDING_PAGE_PATH);
    String homeURL=PortalUtil.getRelativeHomeURL(request);
    if (!homeURL.equals("/user") && (!path.equals("/user"))) {
      filterChain.doFilter(servletRequest,servletResponse);
      return;
    }
    User user=PortalUtil.initUser(request);
    if (!user.hasPrivateLayouts()) {
      filterChain.doFilter(servletRequest,servletResponse);
      return;
    }
    Boolean secure=PortalUtil.isSecure(request);
    String portalURL=PortalUtil.getPortalURL(request,secure);
    String redirect=user.getDisplayURL(portalURL,PortalUtil.getPathMain(),Boolean.TRUE);
    HttpServletResponse response=(HttpServletResponse)servletResponse;
    response.sendRedirect(redirect.toString());
  }
 catch (  Exception e) {
    filterChain.doFilter(servletRequest,servletResponse);
    if (_log.isDebugEnabled())     _log.debug(e,e);
  }
}
