{
  Map<String,Cookie> cookiesMap=new HashMap<String,Cookie>();
  HttpSession session=ServletUtil.getSession();
  Cookie[] sessionCookies=(Cookie[])session.getAttribute(WebKeys.COOKIES);
  if (sessionCookies != null) {
    for (    Cookie cookie : sessionCookies) {
      cookiesMap.put(cookie.getName(),cookie);
    }
  }
  HttpServletRequest request=ServletUtil.getRequest();
  String domain=request.getServerName();
  String path="/";
  Cookie[] forwardCookies=request.getCookies();
  if (forwardCookies != null) {
    for (    Cookie cookie : forwardCookies) {
      String cookieName=cookie.getName();
      if (!cookieName.equalsIgnoreCase("cookie_support") || !cookieName.equalsIgnoreCase("guest_language_id") || !cookieName.equalsIgnoreCase("jsessionid")) {
        if (cookie.getDomain() == null) {
          cookie.setDomain(domain);
        }
        if (cookie.getPath() == null) {
          cookie.setPath(path);
        }
        cookiesMap.put(cookieName,cookie);
      }
    }
  }
  if (!cookiesMap.isEmpty()) {
    Collection<Cookie> cookiesCollection=cookiesMap.values();
    httpOptions.setCookies(cookiesCollection.toArray(new Cookie[0]));
  }
  String rawContent=HttpUtil.URLtoString(httpOptions);
  Cookie[] cookies=HttpUtil.getCookies();
  if (cookies != null) {
    session.setAttribute(WebKeys.COOKIES,cookies);
  }
  return rawContent;
}
