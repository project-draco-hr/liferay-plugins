{
  Set<Long> bbbParticipantIds=new HashSet<>();
  for (  BBBParticipant bbbParticipant : bbbParticipants) {
    long bbbParticipantId=bbbParticipant.getBbbParticipantId();
    if (bbbParticipantId <= 0) {
      bbbParticipant=bbbParticipantLocalService.addBBBParticipant(userId,groupId,bbbMeetingId,bbbParticipant.getName(),bbbParticipant.getEmailAddress(),bbbParticipant.getType(),BBBParticipantConstants.STATUS_DEFAULT,new ServiceContext());
      bbbParticipantId=bbbParticipant.getBbbParticipantId();
    }
 else {
      bbbParticipantLocalService.updateBBBParticipant(bbbParticipantId,bbbMeetingId,bbbParticipant.getName(),bbbParticipant.getEmailAddress(),bbbParticipant.getType(),new ServiceContext());
    }
    bbbParticipantIds.add(bbbParticipantId);
  }
  bbbParticipants=bbbParticipantLocalService.getBBBParticipants(bbbMeetingId);
  for (  BBBParticipant bbbParticipant : bbbParticipants) {
    if (!bbbParticipantIds.contains(bbbParticipant.getBbbParticipantId())) {
      bbbParticipantLocalService.deleteBBBParticipant(bbbParticipant);
    }
  }
  try {
    BBBUtil.sendEmail(bbbMeetingId,serviceContext);
  }
 catch (  Exception e) {
    throw new SystemException();
  }
}
