{
  Portlet portlet=(Portlet)_portletsPool.get(wsrpConsumerPortlet.getWsrpConsumerPortletId());
  if (portlet != null) {
    return portlet;
  }
  WSRPConsumer wsrpConsumer=wsrpConsumerPersistence.findByPrimaryKey(wsrpConsumerPortlet.getWsrpConsumerId());
  WSRPConsumerManager wsrpConsumerManager=WSRPConsumerManagerFactory.getWSRPConsumerManager(wsrpConsumer);
  PortletDescription portletDescription=wsrpConsumerManager.getPortletDescription(wsrpConsumerPortlet.getPortletHandle());
  String portletId=PortalUtil.getJsSafePortletId(ConsumerPortlet.PORTLET_NAME_PREFIX + wsrpConsumerPortlet.getWsrpConsumerPortletId());
  portlet=PortletLocalServiceUtil.newPortlet(CompanyConstants.SYSTEM,portletId);
  portlet.setTimestamp(System.currentTimeMillis());
  PortletApp portletApp=PortletLocalServiceUtil.getPortletApp(ClpSerializer.SERVLET_CONTEXT_NAME);
  portlet.setPortletApp(portletApp);
  portlet.setPortletName(portletId);
  portlet.setDisplayName(portletId);
  portlet.setPortletClass(ConsumerPortlet.class.getName());
  Map<String,String> initParams=portlet.getInitParams();
  initParams.put(InvokerPortlet.INIT_INVOKER_PORTLET_NAME,_CONSUMER_PORTLET_NAME);
  Set<String> mimeTypeModes=new HashSet<String>();
  mimeTypeModes.add(PortletMode.VIEW.toString().toLowerCase());
  portlet.getPortletModes().put(ContentTypes.TEXT_HTML,mimeTypeModes);
  String title=WSRPConsumerManager.getLocalizedStringValue(portletDescription.getTitle(),portletDescription.getDisplayName().getValue());
  String shortTitle=WSRPConsumerManager.getLocalizedStringValue(portletDescription.getShortTitle(),title);
  String keywords=StringUtil.merge(WSRPConsumerManager.getLocalizedStringValues(portletDescription.getKeywords()),StringPool.SPACE);
  PortletInfo portletInfo=new PortletInfo(title,shortTitle,keywords);
  portlet.setPortletInfo(portletInfo);
  _portletsPool.put(wsrpConsumerPortlet.getWsrpConsumerPortletId(),portlet);
  PortletBag portletBag=PortletBagPool.get(_CONSUMER_PORTLET_ID);
  portletBag=(PortletBag)portletBag.clone();
  portletBag.setPortletName(portletId);
  portletBag.setPortletInstance(new ConsumerPortlet());
  PortletBagPool.put(portletId,portletBag);
  return portlet;
}
