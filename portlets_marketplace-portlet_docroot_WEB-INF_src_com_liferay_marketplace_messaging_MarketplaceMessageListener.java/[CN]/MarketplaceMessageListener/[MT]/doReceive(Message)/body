{
  String command=message.getString("command");
  if (!command.equals("deploy")) {
    return;
  }
  Properties properties=PropertiesUtil.load(message.getString("properties"));
  long remoteAppId=GetterUtil.getLong(properties.getProperty("remote-app-id"));
  String version=properties.getProperty("version");
  if ((remoteAppId <= 0) || Validator.isNull(version)) {
    return;
  }
  App app=AppLocalServiceUtil.fetchRemoteApp(remoteAppId);
  if (app != null) {
    return;
  }
  app=AppLocalServiceUtil.addApp(0,remoteAppId,version,null);
  String[] contextNames=StringUtil.split(properties.getProperty("context-names"));
  for (  String contextName : contextNames) {
    ModuleLocalServiceUtil.addModule(0,app.getAppId(),contextName);
  }
  long[] uninstallRemoteAppIds=StringUtil.split(properties.getProperty("supersedes-remote-app-ids"),0L);
  for (  long uninstallRemoteAppId : uninstallRemoteAppIds) {
    App uninstallApp=AppLocalServiceUtil.fetchRemoteApp(uninstallRemoteAppId);
    if ((uninstallApp != null) && uninstallApp.isInstalled()) {
      AppLocalServiceUtil.uninstallApp(uninstallRemoteAppId);
    }
  }
}
