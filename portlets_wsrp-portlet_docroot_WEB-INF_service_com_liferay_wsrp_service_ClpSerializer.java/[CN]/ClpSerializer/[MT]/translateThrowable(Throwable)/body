{
  if (_useReflectionToTranslateThrowable) {
    try {
      if (_classLoader == null) {
        _classLoader=(ClassLoader)PortletBeanLocatorUtil.locate(_servletContextName,"portletClassLoader");
      }
      UnsyncByteArrayOutputStream unsyncByteArrayOutputStream=new UnsyncByteArrayOutputStream();
      ObjectOutputStream objectOutputStream=new ObjectOutputStream(unsyncByteArrayOutputStream);
      objectOutputStream.writeObject(throwable);
      objectOutputStream.flush();
      objectOutputStream.close();
      UnsyncByteArrayInputStream unsyncByteArrayInputStream=new UnsyncByteArrayInputStream(unsyncByteArrayOutputStream.unsafeGetByteArray(),0,unsyncByteArrayOutputStream.size());
      ObjectInputStream objectInputStream=new ClassLoaderObjectInputStream(unsyncByteArrayInputStream,_classLoader);
      throwable=(Throwable)objectInputStream.readObject();
      objectInputStream.close();
      return throwable;
    }
 catch (    SecurityException se) {
      if (_log.isInfoEnabled()) {
        _log.info("Do not use reflection to translate throwable");
      }
      _useReflectionToTranslateThrowable=false;
    }
catch (    Throwable throwable2) {
      _log.error(throwable2,throwable2);
      return throwable2;
    }
  }
  Class<?> clazz=throwable.getClass();
  String className=clazz.getName();
  if (className.equals(PortalException.class.getName())) {
    return new PortalException();
  }
  if (className.equals(SystemException.class.getName())) {
    return new SystemException();
  }
  if (className.equals("com.liferay.wsrp.WSRPConsumerNameException")) {
    return new com.liferay.wsrp.WSRPConsumerNameException();
  }
  if (className.equals("com.liferay.wsrp.WSRPConsumerPortletHandleException")) {
    return new com.liferay.wsrp.WSRPConsumerPortletHandleException();
  }
  if (className.equals("com.liferay.wsrp.WSRPConsumerPortletNameException")) {
    return new com.liferay.wsrp.WSRPConsumerPortletNameException();
  }
  if (className.equals("com.liferay.wsrp.WSRPConsumerWSDLException")) {
    return new com.liferay.wsrp.WSRPConsumerWSDLException();
  }
  if (className.equals("com.liferay.wsrp.WSRPProducerNameException")) {
    return new com.liferay.wsrp.WSRPProducerNameException();
  }
  if (className.equals("com.liferay.wsrp.NoSuchConsumerException")) {
    return new com.liferay.wsrp.NoSuchConsumerException();
  }
  if (className.equals("com.liferay.wsrp.NoSuchConsumerPortletException")) {
    return new com.liferay.wsrp.NoSuchConsumerPortletException();
  }
  if (className.equals("com.liferay.wsrp.NoSuchProducerException")) {
    return new com.liferay.wsrp.NoSuchProducerException();
  }
  return throwable;
}
