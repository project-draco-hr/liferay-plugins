{
  List<KBStructureField> kbStructureFields=new ArrayList<KBStructureField>();
  long[] kbStructureFieldsIndexes=StringUtil.split(ParamUtil.getString(portletRequest,"kbStructureFieldsIndexes"),0L);
  for (  long kbStructureFieldIndex : kbStructureFieldsIndexes) {
    String kbStructureFieldIdParam="kbStructureFieldId" + kbStructureFieldIndex;
    String kbStructureFieldNameParam="kbStructureFieldName" + kbStructureFieldIndex;
    String kbStructureFieldLabelParam="kbStructureFieldLabel" + kbStructureFieldIndex;
    String kbStructureFieldTypeParam="kbStructureFieldType" + kbStructureFieldIndex;
    String kbStructureFieldId=ParamUtil.getString(portletRequest,kbStructureFieldIdParam);
    String kbStructureFieldName=ParamUtil.getString(portletRequest,kbStructureFieldNameParam);
    String kbStructureFieldLabel=ParamUtil.getString(portletRequest,kbStructureFieldLabelParam);
    String kbStructureFieldType=ParamUtil.getString(portletRequest,kbStructureFieldTypeParam);
    KBStructureField kbStructureField=new KBStructureFieldImpl();
    kbStructureField.setKbStructureFieldId(kbStructureFieldId);
    kbStructureField.setName(kbStructureFieldName);
    kbStructureField.setLabel(kbStructureFieldLabel);
    kbStructureField.setType(kbStructureFieldType);
    List<KBStructureOption> kbStructureOptions=new ArrayList<KBStructureOption>();
    String kbStructureOptionsIndexesParam="kbStructureOptionsIndexes" + kbStructureFieldIndex;
    long[] kbStructureOptionsIndexes=StringUtil.split(ParamUtil.getString(portletRequest,kbStructureOptionsIndexesParam),0L);
    for (    long kbStructureOptionIndex : kbStructureOptionsIndexes) {
      String kbStructureOptionIdParam="kbStructureField" + kbStructureFieldIndex + "kbStructureOptionId"+ kbStructureOptionIndex;
      String kbStructureOptionLabelParam="kbStructureField" + kbStructureFieldIndex + "kbStructureOptionLabel"+ kbStructureOptionIndex;
      String kbStructureOptionValueParam="kbStructureField" + kbStructureFieldIndex + "kbStructureOptionValue"+ kbStructureOptionIndex;
      String kbStructureOptionId=ParamUtil.getString(portletRequest,kbStructureOptionIdParam);
      String kbStructureOptionLabel=ParamUtil.getString(portletRequest,kbStructureOptionLabelParam);
      String kbStructureOptionValue=ParamUtil.getString(portletRequest,kbStructureOptionValueParam);
      KBStructureOption kbStructureOption=new KBStructureOptionImpl();
      kbStructureOption.setKbStructureOptionId(kbStructureOptionId);
      kbStructureOption.setLabel(kbStructureOptionLabel);
      kbStructureOption.setValue(kbStructureOptionValue);
      kbStructureOptions.add(kbStructureOption);
    }
    kbStructureField.setKbStructureOptions(kbStructureOptions);
    kbStructureFields.add(kbStructureField);
  }
  return kbStructureFields;
}
