{
  validate(title,kbStructureFields);
  KBStructure kbStructure=kbStructurePersistence.findByPrimaryKey(kbStructureId);
  Map<Locale,String> titleMap=kbStructure.getTitleMap();
  String content=KBStructureContentUtil.updateKBStructureFields(localizedLanguageId,kbStructureFields,kbStructure.getContent());
  titleMap.put(LocaleUtil.fromLanguageId(localizedLanguageId),title);
  kbStructure.setModifiedDate(serviceContext.getModifiedDate(null));
  kbStructure.setTitleMap(titleMap);
  kbStructure.setContent(content);
  kbStructurePersistence.update(kbStructure,false);
  if ((serviceContext.getGroupPermissions() != null) || (serviceContext.getGuestPermissions() != null)) {
    updateKBStructureResources(kbStructure,serviceContext.getGroupPermissions(),serviceContext.getGuestPermissions());
  }
  socialActivityLocalService.addActivity(kbStructure.getUserId(),kbStructure.getGroupId(),KBStructure.class.getName(),kbStructureId,AdminActivityKeys.UPDATE_KB_STRUCTURE,localizedLanguageId,0);
  return kbStructure;
}
