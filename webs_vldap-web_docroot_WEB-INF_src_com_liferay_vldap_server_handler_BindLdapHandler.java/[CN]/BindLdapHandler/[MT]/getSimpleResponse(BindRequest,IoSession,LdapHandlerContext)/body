{
  Dn name=bindRequest.getName();
  if (Validator.isNull(name.getName())) {
    return getResponse(bindRequest,ResultCodeEnum.SUCCESS);
  }
  Company company=setCompany(ldapHandlerContext,name);
  String screenName=getValue(name,"cn");
  if (Validator.isNull(screenName)) {
    return getResponse(bindRequest,ResultCodeEnum.INVALID_CREDENTIALS);
  }
  String password=new String(bindRequest.getCredentials());
  Map<String,String[]> headerMap=new HashMap<String,String[]>();
  Map<String,String[]> parameterMap=new HashMap<String,String[]>();
  Map<String,Object> resultsMap=new HashMap<String,Object>();
  int authResult=UserLocalServiceUtil.authenticateByScreenName(company.getCompanyId(),screenName,password,headerMap,parameterMap,resultsMap);
  if (authResult != Authenticator.SUCCESS) {
    return getResponse(bindRequest,ResultCodeEnum.INVALID_CREDENTIALS);
  }
  setUser(ldapHandlerContext,name);
  return getResponse(bindRequest,ResultCodeEnum.SUCCESS);
}
