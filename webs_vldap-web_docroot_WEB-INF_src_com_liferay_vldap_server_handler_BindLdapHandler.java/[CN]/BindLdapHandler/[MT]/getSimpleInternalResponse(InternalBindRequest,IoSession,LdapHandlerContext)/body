{
  DN name=internalBindRequest.getName();
  if (Validator.isNull(name.getName())) {
    return getInternalResponse(internalBindRequest,ResultCodeEnum.SUCCESS);
  }
  Company company=setCompany(ldapHandlerContext,name);
  String screenName=getValue(name,"cn");
  if (Validator.isNull(screenName)) {
    return getInternalResponse(internalBindRequest,ResultCodeEnum.INVALID_CREDENTIALS);
  }
  String password=new String(internalBindRequest.getCredentials());
  Map<String,String[]> headerMap=new HashMap<String,String[]>();
  Map<String,String[]> parameterMap=new HashMap<String,String[]>();
  int authResult=UserLocalServiceUtil.authenticateByScreenName(company.getCompanyId(),screenName,password,headerMap,parameterMap);
  if (authResult != Authenticator.SUCCESS) {
    return getInternalResponse(internalBindRequest,ResultCodeEnum.INVALID_CREDENTIALS);
  }
  setUser(ldapHandlerContext,name);
  return getInternalResponse(internalBindRequest,ResultCodeEnum.SUCCESS);
}
