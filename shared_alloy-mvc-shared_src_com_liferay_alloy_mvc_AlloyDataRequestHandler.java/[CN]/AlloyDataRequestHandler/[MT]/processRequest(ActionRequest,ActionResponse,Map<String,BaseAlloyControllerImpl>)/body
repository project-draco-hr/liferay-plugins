{
  String jsonString=null;
  String controller=ParamUtil.getString(actionRequest,"controller");
  BaseAlloyControllerImpl baseAlloyControllerImpl=alloyControllers.get(controller);
  if (baseAlloyControllerImpl == null) {
    throw new Exception("Unable to find controller " + controller);
  }
  String action=ParamUtil.getString(actionRequest,"action");
  try {
    if (action.equals("custom")) {
      jsonString=baseAlloyControllerImpl.processDataRequest(actionRequest);
    }
 else     if (action.equals("dynamicQuery")) {
      jsonString=executeDynamicQuery(baseAlloyControllerImpl,actionRequest);
    }
 else     if (action.equals("search")) {
      jsonString=executeSearch(baseAlloyControllerImpl,actionRequest);
    }
  }
 catch (  Exception e) {
    JSONObject jsonObject=JSONFactoryUtil.createJSONObject();
    jsonObject.put("error","An unexpected exception occurred.");
    jsonString=jsonObject.toString();
  }
  if (jsonString != null) {
    writeJSON(actionRequest,actionResponse,jsonString);
  }
}
