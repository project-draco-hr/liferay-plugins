{
  try {
    String contentType=req.getHeader(HttpHeaders.CONTENT_TYPE);
    if (_log.isDebugEnabled()) {
      _log.debug("Content type " + contentType);
    }
    if ((contentType != null) && (contentType.startsWith(ContentTypes.MULTIPART_FORM_DATA))) {
      req=PortalUtil.getUploadServletRequest(req);
    }
    WorkflowComponentImpl workflowComponentImpl=new WorkflowComponentImpl();
    String result=workflowComponentImpl.process(req);
    res.setContentType("text/xml");
    ServletResponseUtil.write(res,result);
  }
 catch (  Exception e) {
    _log.error(e,e);
    res.sendError(HttpServletResponse.SC_INTERNAL_SERVER_ERROR,e.getMessage());
  }
}
