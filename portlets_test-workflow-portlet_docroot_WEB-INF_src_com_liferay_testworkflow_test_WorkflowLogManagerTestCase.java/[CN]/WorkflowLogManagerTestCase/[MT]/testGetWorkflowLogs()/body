{
  WorkflowInstance workflowInstance=WorkflowInstanceManagerUtil.startWorkflowInstance(defaultUserId,_workflowDefinition.getName(),_workflowDefinition.getVersion(),null,null);
  List<WorkflowLog> rootWorkflowLogs=WorkflowLogManagerUtil.getWorkflowLogs(workflowInstance.getWorkflowInstanceId(),false,QueryUtil.ALL_POS,QueryUtil.ALL_POS,new WorkflowLogCreateDateComparator(true));
  assertTrue(!rootWorkflowLogs.isEmpty());
  for (  WorkflowLog workflowLog : rootWorkflowLogs) {
    assertEquals(workflowInstance.getWorkflowInstanceId(),workflowLog.getWorkflowInstanceId());
  }
  List<WorkflowLog> allWorkflowLogs=WorkflowLogManagerUtil.getWorkflowLogs(workflowInstance.getWorkflowInstanceId(),true,QueryUtil.ALL_POS,QueryUtil.ALL_POS,new WorkflowLogCreateDateComparator(true));
  assertTrue(!allWorkflowLogs.isEmpty());
  assertTrue(allWorkflowLogs.size() > rootWorkflowLogs.size());
  List<WorkflowInstance> childrenWorkflowInstances=workflowInstance.getChildrenWorkflowInstances();
  assertEquals(3,childrenWorkflowInstances.size());
  WorkflowInstance childWorkflowInstance1=childrenWorkflowInstances.get(0);
  List<WorkflowLog> childWorkflowLogs1=WorkflowLogManagerUtil.getWorkflowLogs(childWorkflowInstance1.getWorkflowInstanceId(),true,QueryUtil.ALL_POS,QueryUtil.ALL_POS,new WorkflowLogCreateDateComparator(true));
  assertTrue(!childWorkflowLogs1.isEmpty());
  for (  WorkflowLog workflowLog : childWorkflowLogs1) {
    assertEquals(childWorkflowInstance1.getWorkflowInstanceId(),workflowLog.getWorkflowInstanceId());
  }
  WorkflowInstance childWorkflowInstance2=childrenWorkflowInstances.get(1);
  List<WorkflowLog> childWorkflowLogs2=WorkflowLogManagerUtil.getWorkflowLogs(childWorkflowInstance2.getWorkflowInstanceId(),true,QueryUtil.ALL_POS,QueryUtil.ALL_POS,new WorkflowLogCreateDateComparator(true));
  assertTrue(!childWorkflowLogs2.isEmpty());
  for (  WorkflowLog workflowLog : childWorkflowLogs2) {
    assertEquals(childWorkflowInstance2.getWorkflowInstanceId(),workflowLog.getWorkflowInstanceId());
  }
  WorkflowInstance childWorkflowInstance3=childrenWorkflowInstances.get(2);
  List<WorkflowLog> childWorkflowLogs3=WorkflowLogManagerUtil.getWorkflowLogs(childWorkflowInstance3.getWorkflowInstanceId(),true,QueryUtil.ALL_POS,QueryUtil.ALL_POS,new WorkflowLogCreateDateComparator(true));
  assertTrue(!childWorkflowLogs2.isEmpty());
  for (  WorkflowLog workflowLog : childWorkflowLogs3) {
    assertEquals(childWorkflowInstance3.getWorkflowInstanceId(),workflowLog.getWorkflowInstanceId());
  }
  assertEquals(allWorkflowLogs.size(),rootWorkflowLogs.size() + childWorkflowLogs1.size() + childWorkflowLogs2.size()+ childWorkflowLogs3.size());
  WorkflowInstanceManagerUtil.deleteWorkflowInstance(workflowInstance.getWorkflowInstanceId());
}
