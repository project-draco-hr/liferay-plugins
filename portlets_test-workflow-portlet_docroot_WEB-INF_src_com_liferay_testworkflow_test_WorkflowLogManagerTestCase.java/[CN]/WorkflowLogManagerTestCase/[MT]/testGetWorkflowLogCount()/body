{
  WorkflowInstance workflowInstance=WorkflowInstanceManagerUtil.startWorkflowInstance(defaultUserId,_workflowDefinition.getName(),_workflowDefinition.getVersion(),null,null);
  int rootCount=WorkflowLogManagerUtil.getWorkflowLogCount(workflowInstance.getWorkflowInstanceId(),false);
  assertTrue(rootCount > 0);
  int allCount=WorkflowLogManagerUtil.getWorkflowLogCount(workflowInstance.getWorkflowInstanceId(),true);
  assertTrue(allCount > 0);
  assertTrue(allCount > rootCount);
  List<WorkflowInstance> childrenWorkflowInstances=workflowInstance.getChildrenWorkflowInstances();
  assertEquals(3,childrenWorkflowInstances.size());
  WorkflowInstance childWorkflowInstance1=childrenWorkflowInstances.get(0);
  int childCount1=WorkflowLogManagerUtil.getWorkflowLogCount(childWorkflowInstance1.getWorkflowInstanceId(),true);
  assertTrue(childCount1 > 0);
  WorkflowInstance childWorkflowInstance2=childrenWorkflowInstances.get(1);
  int childCount2=WorkflowLogManagerUtil.getWorkflowLogCount(childWorkflowInstance2.getWorkflowInstanceId(),true);
  assertTrue(childCount2 > 0);
  WorkflowInstance childWorkflowInstance3=childrenWorkflowInstances.get(2);
  int childCount3=WorkflowLogManagerUtil.getWorkflowLogCount(childWorkflowInstance3.getWorkflowInstanceId(),true);
  assertTrue(childCount3 > 0);
  assertEquals(allCount,rootCount + childCount1 + childCount2+ childCount3);
  WorkflowInstanceManagerUtil.deleteWorkflowInstance(workflowInstance.getWorkflowInstanceId());
}
