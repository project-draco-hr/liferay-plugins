{
  if (Validator.isNull(highlights)) {
    return StringPool.BLANK;
  }
  String defaultLanguageId=LocaleUtil.toLanguageId(LocaleUtil.getDefault());
  String queryLanguageId=LocaleUtil.toLanguageId(queryConfig.getLocale());
  boolean localizedSearch=true;
  if (queryLanguageId.equals(defaultLanguageId)) {
    localizedSearch=false;
  }
  String snippetField=StringPool.BLANK;
  if (localizedSearch) {
    String localizedName=DocumentImpl.getLocalizedName(queryConfig.getLocale(),Field.CONTENT);
    if (solrDocument.containsKey(localizedName)) {
      snippetField=localizedName;
    }
  }
 else {
    snippetField=Field.CONTENT;
  }
  String key=(String)solrDocument.getFieldValue(Field.UID);
  List<String> snippets=highlights.get(key).get(snippetField);
  String snippet=StringUtil.merge(snippets,"...");
  if (Validator.isNotNull(snippet)) {
    snippet=snippet + "...";
  }
 else {
    snippet=StringPool.BLANK;
  }
  Matcher matcher=Pattern.compile("<em>(.*?)</em>").matcher(snippet);
  while (matcher.find()) {
    queryTerms.add(matcher.group(1));
  }
  snippet=StringUtil.replace(snippet,"<em>","");
  snippet=StringUtil.replace(snippet,"</em>","");
  return snippet;
}
