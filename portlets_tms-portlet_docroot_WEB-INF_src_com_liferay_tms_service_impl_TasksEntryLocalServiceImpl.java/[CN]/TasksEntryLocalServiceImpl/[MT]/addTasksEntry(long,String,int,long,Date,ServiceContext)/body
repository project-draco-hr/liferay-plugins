{
  User user=UserLocalServiceUtil.getUserById(userId);
  long groupId=serviceContext.getScopeGroupId();
  Date now=new Date();
  long tasksEntryId=CounterLocalServiceUtil.increment();
  TasksEntry tasksEntry=tasksEntryPersistence.create(tasksEntryId);
  tasksEntry.setGroupId(groupId);
  tasksEntry.setCompanyId(user.getCompanyId());
  tasksEntry.setUserId(user.getUserId());
  tasksEntry.setUserName(user.getFullName());
  tasksEntry.setCreateDate(now);
  tasksEntry.setModifiedDate(now);
  tasksEntry.setTitle(title);
  tasksEntry.setPriority(priority);
  tasksEntry.setAssigneeUserId(assigneeUserId);
  tasksEntry.setDueDate(dueDate);
  tasksEntry.setStatus(TasksConstants.STATUS_OPEN);
  tasksEntryPersistence.update(tasksEntry);
  SocialActivityLocalServiceUtil.addActivity(userId,groupId,TasksEntry.class.getName(),tasksEntryId,TasksActivityKeys.ADD_TASK,StringPool.BLANK,0);
  updateTagsAsset(userId,tasksEntry,serviceContext.getTagsCategories(),serviceContext.getTagsEntries());
  return tasksEntry;
}
