{
  List<Attachment> attachments=attachmentPersistence.findByMessageId(messageId);
  for (  Attachment attachment : attachments) {
    deleteAttachment(attachment);
  }
  Message message=messagePersistence.findByPrimaryKey(messageId);
  String directoryPath=getDirectoryPath(messageId);
  try {
    DLServiceUtil.deleteDirectory(message.getCompanyId(),_PORTLET_ID,_REPOSITORY_ID,directoryPath);
  }
 catch (  NoSuchDirectoryException nsde) {
    if (_log.isDebugEnabled()) {
      _log.debug(nsde.getMessage());
    }
  }
}
