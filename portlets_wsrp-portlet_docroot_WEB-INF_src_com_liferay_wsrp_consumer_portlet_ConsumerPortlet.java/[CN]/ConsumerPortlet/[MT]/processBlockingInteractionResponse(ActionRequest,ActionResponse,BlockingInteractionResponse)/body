{
  UpdateResponse updateResponse=bir.getUpdateResponse();
  String redirectURL=bir.getRedirectURL();
  if (Validator.isNotNull(redirectURL)) {
    try {
      res.sendRedirect(redirectURL);
    }
 catch (    IOException e) {
      _log.error(e.getMessage(),e);
    }
    return;
  }
  MarkupContext markupContext=updateResponse.getMarkupContext();
  if (markupContext != null) {
    processMarkupContext(req,markupContext);
  }
  PortletContext portletContext=updateResponse.getPortletContext();
  if (portletContext != null) {
    processPortletContext(req,portletContext);
  }
  String navState=updateResponse.getNavigationalContext().getOpaqueValue();
  if (Validator.isNotNull(navState)) {
    res.setRenderParameter(WSRPSpecKeys.NAVIGATIONAL_STATE,navState);
  }
  String mode=updateResponse.getNewMode();
  if (Validator.isNotNull(mode)) {
    try {
      res.setPortletMode(WSRPMode.fromWSRP(mode).getPortlet());
    }
 catch (    PortletModeException e) {
      _log.error(e.getMessage(),e);
    }
  }
  String windowState=updateResponse.getNewWindowState();
  if (Validator.isNotNull(windowState)) {
    try {
      res.setWindowState(WSRPState.fromWSRP(windowState).getPortlet());
    }
 catch (    WindowStateException e) {
      _log.error(e.getMessage(),e);
    }
  }
  processSessionContext(req,updateResponse.getSessionContext());
}
