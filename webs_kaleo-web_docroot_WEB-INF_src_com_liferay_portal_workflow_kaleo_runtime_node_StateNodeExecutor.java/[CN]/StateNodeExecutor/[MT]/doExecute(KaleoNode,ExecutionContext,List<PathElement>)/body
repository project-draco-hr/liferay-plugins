{
  Map<String,Serializable> workflowContext=executionContext.getWorkflowContext();
  ServiceContext serviceContext=executionContext.getServiceContext();
  KaleoInstanceToken kaleoInstanceToken=executionContext.getKaleoInstanceToken();
  String transitionName=executionContext.getTransitionName();
  if (!currentKaleoNode.hasKaleoTransition()) {
    kaleoInstanceToken=kaleoInstanceTokenLocalService.completeKaleoInstanceToken(kaleoInstanceToken.getKaleoInstanceTokenId());
    if (kaleoInstanceToken.getParentKaleoInstanceTokenId() == KaleoInstanceTokenImpl.DEFAULT_PARENT_KALEO_INSTANCE_TOKEN_ID) {
      kaleoInstanceLocalService.completeKaleoInstance(kaleoInstanceToken.getKaleoInstanceId());
    }
    return;
  }
  KaleoTransition kaleoTransition=null;
  if (Validator.isNull(transitionName)) {
    kaleoTransition=currentKaleoNode.getDefaultKaleoTransition();
  }
 else {
    kaleoTransition=currentKaleoNode.getKaleoTransition(transitionName);
  }
  ExecutionContext newExecutionContext=new ExecutionContext(kaleoInstanceToken,workflowContext,serviceContext);
  PathElement pathElement=new PathElement(currentKaleoNode,kaleoTransition.getTargetKaleoNode(),newExecutionContext);
  remainingPathElements.add(pathElement);
}
