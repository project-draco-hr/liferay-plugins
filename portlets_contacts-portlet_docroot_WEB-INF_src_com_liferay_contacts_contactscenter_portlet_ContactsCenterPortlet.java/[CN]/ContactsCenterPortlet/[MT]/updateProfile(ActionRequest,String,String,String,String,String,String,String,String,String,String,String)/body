{
  ThemeDisplay themeDisplay=(ThemeDisplay)actionRequest.getAttribute(WebKeys.THEME_DISPLAY);
  User user=themeDisplay.getUser();
  Contact contact=user.getContact();
  Calendar cal=CalendarFactoryUtil.getCalendar();
  cal.setTime(user.getBirthday());
  int birthdayDay=cal.get(Calendar.DATE);
  int birthdayMonth=cal.get(Calendar.MONTH);
  int birthdayYear=cal.get(Calendar.YEAR);
  List<UserGroupRole> userGroupRoles=UsersAdminUtil.getUserGroupRoles(actionRequest);
  List<EmailAddress> emailAddresses=UsersAdminUtil.getEmailAddresses(actionRequest);
  List<AnnouncementsDelivery> deliveries=ListUtil.copy(AnnouncementsDeliveryLocalServiceUtil.getUserDeliveries(user.getUserId()));
  UserServiceUtil.updateUser(user.getUserId(),user.getPasswordUnencrypted(),user.getPasswordUnencrypted(),user.getPasswordUnencrypted(),user.getPasswordReset(),user.getReminderQueryQuestion(),user.getReminderQueryAnswer(),user.getScreenName(),user.getEmailAddress(),user.getFacebookId(),user.getOpenId(),user.getLanguageId(),user.getTimeZoneId(),user.getGreeting(),comments,user.getFirstName(),user.getMiddleName(),user.getLastName(),contact.getPrefixId(),contact.getSuffixId(),user.isMale(),birthdayMonth,birthdayDay,birthdayYear,sms,aimSn,facebookSn,icqSn,jabberSn,msnSn,mySpaceSn,skypeSn,twitterSn,ymSn,user.getJobTitle(),user.getGroupIds(),user.getOrganizationIds(),user.getRoleIds(),userGroupRoles,user.getUserGroupIds(),user.getAddresses(),emailAddresses,user.getPhones(),user.getWebsites(),deliveries,new ServiceContext());
}
