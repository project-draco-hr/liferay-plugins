{
  ThemeDisplay themeDisplay=(ThemeDisplay)actionRequest.getAttribute(WebKeys.THEME_DISPLAY);
  long[] userIds=StringUtil.split(ParamUtil.getString(actionRequest,"userIds"),0L);
  JSONObject jsonObject=JSONFactoryUtil.createJSONObject();
  JSONArray jsonArray=JSONFactoryUtil.createJSONArray();
  for (  long userId : userIds) {
    JSONObject userJSONObject=JSONFactoryUtil.createJSONObject();
    userJSONObject.put("success",true);
    userJSONObject.put("user",getUserJSON(userId,themeDisplay,(LiferayPortletResponse)actionResponse));
    jsonArray.put(userJSONObject);
  }
  jsonObject.put("contacts",jsonArray);
  String keywords=ParamUtil.getString(actionRequest,"keywords");
  String redirect=ParamUtil.getString(actionRequest,"redirect");
  String filterBy=ParamUtil.getString(actionRequest,"filterBy");
  int start=ParamUtil.getInteger(actionRequest,"start");
  int end=ParamUtil.getInteger(actionRequest,"end");
  JSONObject jsonContactListJSON=getContactListJSON(filterBy,keywords,redirect,themeDisplay,(LiferayPortletResponse)actionResponse,start,end);
  jsonObject.put("contactList",jsonContactListJSON);
  PortletConfig portletConfig=(PortletConfig)actionRequest.getAttribute(JavaConstants.JAVAX_PORTLET_CONFIG);
  jsonObject.put("message",LanguageUtil.get(portletConfig,themeDisplay.getLocale(),message));
  writeJSON(actionRequest,actionResponse,jsonObject);
}
