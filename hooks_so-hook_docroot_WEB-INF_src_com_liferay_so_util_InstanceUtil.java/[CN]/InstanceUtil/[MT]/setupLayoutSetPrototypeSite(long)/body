{
  LayoutSetPrototype layoutSetPrototype=addLayoutSetPrototype(companyId,"Default Social Office Site");
  ExpandoValueLocalServiceUtil.addValue(companyId,LayoutSetPrototype.class.getName(),ExpandoTableConstants.DEFAULT_TABLE_NAME,SocialOfficeConstants.LAYOUT_SET_PROTOTYPE_KEY,layoutSetPrototype.getLayoutSetPrototypeId(),SocialOfficeConstants.LAYOUT_SET_PROTOTYPE_KEY_SITE);
  Role role=RoleLocalServiceUtil.getRole(layoutSetPrototype.getCompanyId(),RoleConstants.SOCIAL_OFFICE_USER);
  ResourcePermissionLocalServiceUtil.setResourcePermissions(layoutSetPrototype.getCompanyId(),LayoutSetPrototype.class.getName(),ResourceConstants.SCOPE_INDIVIDUAL,String.valueOf(layoutSetPrototype.getPrimaryKey()),role.getRoleId(),new String[]{ActionKeys.VIEW});
  Group group=layoutSetPrototype.getGroup();
  LayoutLocalServiceUtil.deleteLayouts(group.getGroupId(),true,new ServiceContext());
  LayoutSetLocalServiceUtil.updateLookAndFeel(group.getGroupId(),"so_WAR_sotheme","01","",false);
  Layout layout=LayoutUtil.addLayout(group,true,LayoutConstants.DEFAULT_PARENT_LAYOUT_ID,getLocalizationMap("home"),null,PortletPropsValues.SITE_PROTOTYPE_LAYOUT_TEMPLATE);
  LayoutUtil.addPortlets(group,layout,"/home",PortletPropsKeys.SITE_PROTOTYPE_PORTLETS);
  LayoutUtil.configureRSS(layout);
  LayoutUtil.updatePermissions(layout,true);
  layout=LayoutUtil.addLayout(group,true,LayoutConstants.DEFAULT_PARENT_LAYOUT_ID,getLocalizationMap("calendar"),null,"1_column");
  LayoutUtil.addPortlets(group,layout,"/calendar",PortletPropsKeys.SITE_PROTOTYPE_PORTLETS);
  LayoutUtil.updatePermissions(layout,true);
  layout=LayoutUtil.addLayout(group,true,LayoutConstants.DEFAULT_PARENT_LAYOUT_ID,getLocalizationMap("documents"),null,"1_column");
  LayoutUtil.addPortlets(group,layout,"/documents",PortletPropsKeys.SITE_PROTOTYPE_PORTLETS);
  LayoutUtil.configureAssetPublisher(layout);
  LayoutUtil.updatePermissions(layout,true);
  layout=LayoutUtil.addLayout(group,true,LayoutConstants.DEFAULT_PARENT_LAYOUT_ID,getLocalizationMap("forums"),null,"1_column");
  LayoutUtil.addPortlets(group,layout,"/forums",PortletPropsKeys.SITE_PROTOTYPE_PORTLETS);
  LayoutUtil.removePortletBorder(layout,"73");
  LayoutUtil.removePortletBorder(layout,"19");
  LayoutUtil.configureAssetPublisher(layout);
  LayoutUtil.configureMessageBoards(layout);
  LayoutUtil.updatePermissions(layout,true);
  layout=LayoutUtil.addLayout(group,true,LayoutConstants.DEFAULT_PARENT_LAYOUT_ID,getLocalizationMap("blogs"),null,"2_columns_iii");
  LayoutUtil.addPortlets(group,layout,"/blog",PortletPropsKeys.SITE_PROTOTYPE_PORTLETS);
  LayoutUtil.configureAssetPublisher(layout);
  LayoutUtil.updatePermissions(layout,true);
  layout=LayoutUtil.addLayout(group,true,LayoutConstants.DEFAULT_PARENT_LAYOUT_ID,getLocalizationMap("wiki"),null,"1_column");
  LayoutUtil.addPortlets(group,layout,"/wiki",PortletPropsKeys.SITE_PROTOTYPE_PORTLETS);
  LayoutUtil.configureAssetPublisher(layout);
  LayoutUtil.updatePermissions(layout,true);
  layout=LayoutUtil.addLayout(group,true,LayoutConstants.DEFAULT_PARENT_LAYOUT_ID,getLocalizationMap("members"),null,"1_column");
  LayoutUtil.addPortlets(group,layout,"/members",PortletPropsKeys.SITE_PROTOTYPE_PORTLETS);
  LayoutUtil.removePortletBorder(layout,"2_WAR_soportlet");
  LayoutUtil.updatePermissions(layout,true);
}
