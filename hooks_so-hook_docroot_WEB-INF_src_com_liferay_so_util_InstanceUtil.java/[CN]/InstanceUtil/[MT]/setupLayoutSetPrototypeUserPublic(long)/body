{
  LayoutSetPrototype layoutSetPrototype=addLayoutSetPrototype(companyId,"Social Office User Profile");
  ExpandoValueLocalServiceUtil.addValue(companyId,LayoutSetPrototype.class.getName(),ExpandoTableConstants.DEFAULT_TABLE_NAME,SocialOfficeConstants.LAYOUT_SET_PROTOTYPE_KEY,layoutSetPrototype.getLayoutSetPrototypeId(),SocialOfficeConstants.LAYOUT_SET_PROTOTYPE_KEY_USER_PUBLIC);
  Role role=RoleLocalServiceUtil.getRole(layoutSetPrototype.getCompanyId(),RoleConstants.SOCIAL_OFFICE_USER);
  ResourcePermissionLocalServiceUtil.setResourcePermissions(layoutSetPrototype.getCompanyId(),LayoutSetPrototype.class.getName(),ResourceConstants.SCOPE_INDIVIDUAL,String.valueOf(layoutSetPrototype.getPrimaryKey()),role.getRoleId(),new String[]{ActionKeys.VIEW});
  Group group=layoutSetPrototype.getGroup();
  LayoutLocalServiceUtil.deleteLayouts(group.getGroupId(),true,new ServiceContext());
  LayoutSetLocalServiceUtil.updateLookAndFeel(group.getGroupId(),"so_WAR_sotheme","01","",false);
  Layout layout=LayoutUtil.addLayout(group,true,LayoutConstants.DEFAULT_PARENT_LAYOUT_ID,"Profile","1_2_columns_ii","/so/profile");
  LayoutUtil.addPortlets(group,layout,"/profile",PortletPropsKeys.USER_PUBLIC_LAYOUT_PORTLETS);
  LayoutUtil.updatePermissions(layout,true);
  LayoutLocalServiceUtil.updatePriority(layout,0);
  layout=LayoutUtil.addLayout(group,true,LayoutConstants.DEFAULT_PARENT_LAYOUT_ID,"Contacts","1_column","/so/contacts");
  LayoutUtil.addPortlets(group,layout,"/contacts",PortletPropsKeys.USER_PUBLIC_LAYOUT_PORTLETS);
  LayoutUtil.updatePermissions(layout,true);
  LayoutLocalServiceUtil.updatePriority(layout,1);
  layout=LayoutUtil.addLayout(group,true,LayoutConstants.DEFAULT_PARENT_LAYOUT_ID,"Microblogs","1_column","/so/microblogs");
  LayoutUtil.addPortlets(group,layout,"/microblogs",PortletPropsKeys.USER_PUBLIC_LAYOUT_PORTLETS);
  LayoutUtil.updatePermissions(layout,true);
  LayoutLocalServiceUtil.updatePriority(layout,2);
}
