{
  if (Validator.isNotNull(dirName)) {
    return dirName;
  }
  dirName="knowledgebase/temp/attachments/" + counterLocalService.increment();
  DLStoreUtil.addDirectory(serviceContext.getCompanyId(),CompanyConstants.SYSTEM,dirName);
  if (resourcePrimKey <= 0) {
    return dirName;
  }
  KBArticle kbArticle=getLatestKBArticle(resourcePrimKey,WorkflowConstants.STATUS_ANY);
  for (  String fileName : kbArticle.getAttachmentsFileNames()) {
    String shortFileName=FileUtil.getShortFileName(fileName);
    byte[] bytes=DLStoreUtil.getFileAsBytes(kbArticle.getCompanyId(),CompanyConstants.SYSTEM,fileName);
    addAttachment(dirName,shortFileName,bytes,serviceContext);
  }
  return dirName;
}
