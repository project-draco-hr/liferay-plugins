{
  if (!DLStoreUtil.hasDirectory(companyId,CompanyConstants.SYSTEM,_TEMP_DIR_NAME_PREFIX)) {
    return;
  }
  Date now=new Date();
  String[] dirNames=DLStoreUtil.getFileNames(companyId,CompanyConstants.SYSTEM,_TEMP_DIR_NAME_PREFIX);
  for (  String dirName : dirNames) {
    String[] attachmentDirNames=DLStoreUtil.getFileNames(companyId,CompanyConstants.SYSTEM,KnowledgeBaseUtil.trimLeadingSlash(dirName));
    for (    String attachmentDirName : attachmentDirNames) {
      String[] fileNames=DLStoreUtil.getFileNames(companyId,CompanyConstants.SYSTEM,KnowledgeBaseUtil.trimLeadingSlash(attachmentDirName));
      File file=null;
      for (      String fileName : fileNames) {
        try {
          file=DLStoreUtil.getFile(companyId,CompanyConstants.SYSTEM,KnowledgeBaseUtil.trimLeadingSlash(fileName));
        }
 catch (        Exception e) {
          if (_log.isWarnEnabled()) {
            _log.warn("Unable to get temp file: " + e.getMessage());
          }
        }
        if (file != null) {
          break;
        }
      }
      if ((file != null) && (now.getTime() - file.lastModified()) > Time.DAY) {
        DLStoreUtil.deleteDirectory(companyId,CompanyConstants.SYSTEM,dirName);
      }
    }
  }
}
