{
  if (kbArticle.getVersion() > oldVersion) {
    String oldDirName=KBArticleConstants.DIR_NAME_PREFIX + kbArticle.getResourcePrimKey();
    if (Validator.isNull(dirName)) {
      addKBArticleAttachments(userId,kbArticle,oldDirName,serviceContext);
    }
 else {
      addKBArticleAttachments(userId,kbArticle,dirName,serviceContext);
    }
  }
 else   if (Validator.isNotNull(dirName)) {
    deleteKBArticleAttachments(kbArticle,kbArticle.getClassPK());
    addKBArticleAttachments(userId,kbArticle,dirName,serviceContext);
  }
}
