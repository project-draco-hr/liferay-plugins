{
  try {
    ThemeDisplay themeDisplay=(ThemeDisplay)resourceRequest.getAttribute(WebKeys.THEME_DISPLAY);
    long[] groupIds=ParamUtil.getLongValues(resourceRequest,"groupIds");
    String rssType=ParamUtil.getString(resourceRequest,"rssType");
    double rssVersion=ParamUtil.getDouble(resourceRequest,"rssVersion");
    int rssMaxItems=ParamUtil.getInteger(resourceRequest,"rssMaxItems");
    String rssDisplayStyle=ParamUtil.getString(resourceRequest,"rssDisplayStyle");
    int rssAbstractLength=ParamUtil.getInteger(resourceRequest,"rssAbstractLength");
    String feedURL=PortalUtil.getPortalURL(themeDisplay) + PortalUtil.getLayoutURL(themeDisplay);
    String description=LanguageUtil.get(themeDisplay.getLocale(),"knowledge-base-articles");
    String rss=StringPool.BLANK;
    if (groupIds[0] != 0) {
      rss=KBArticleServiceUtil.getGroupsArticlesRSS(groupIds,rssMaxItems,rssType,rssVersion,rssDisplayStyle,rssAbstractLength,description,feedURL,themeDisplay);
    }
 else {
      rss=KBArticleServiceUtil.getCompanyArticlesRSS(themeDisplay.getCompanyId(),rssMaxItems,rssType,rssVersion,rssDisplayStyle,rssAbstractLength,description,feedURL,themeDisplay);
    }
    HttpServletResponse response=PortalUtil.getHttpServletResponse(resourceResponse);
    ServletResponseUtil.sendFile(response,null,rss.getBytes(StringPool.UTF8),ContentTypes.TEXT_XML_UTF8);
  }
 catch (  Exception e) {
    _log.error(e,e);
  }
}
