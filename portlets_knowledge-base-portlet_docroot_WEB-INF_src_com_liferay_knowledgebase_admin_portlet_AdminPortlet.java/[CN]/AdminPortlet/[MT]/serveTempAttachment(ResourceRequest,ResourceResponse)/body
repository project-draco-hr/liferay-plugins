{
  String portletId=PortalUtil.getPortletId(resourceRequest);
  long resourcePrimKey=ParamUtil.getLong(resourceRequest,"resourcePrimKey");
  String fileName=ParamUtil.getString(resourceRequest,"fileName");
  ServiceContext serviceContext=ServiceContextFactory.getInstance(KBArticle.class.getName(),resourceRequest);
  File file=KBArticleServiceUtil.getAttachmentFile(portletId,resourcePrimKey,fileName,serviceContext);
  String attachmentName=fileName.substring(fileName.lastIndexOf(CharPool.SLASH) + 1);
  String contentType=MimeTypesUtil.getContentType(file,attachmentName);
  PortletResponseUtil.sendFile(resourceRequest,resourceResponse,attachmentName,FileUtil.getBytes(file),contentType);
}
