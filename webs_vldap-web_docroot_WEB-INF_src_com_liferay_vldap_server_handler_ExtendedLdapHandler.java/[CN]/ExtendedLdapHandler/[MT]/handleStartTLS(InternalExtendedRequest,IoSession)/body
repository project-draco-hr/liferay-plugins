{
  SSLContext sslContext=LdapSslContextFactory.getSSLContext(true);
  SslFilter sslFilter=new SslFilter(sslContext);
  IoFilterChain ioFilterChain=ioSession.getFilterChain();
  ioFilterChain.addFirst("sslFilter",sslFilter);
  InternalExtendedResponse internalExtendedResponse=(InternalExtendedResponse)getInternalResponse(internalExtendedRequest);
  internalExtendedResponse.setResponseName(_START_TLS);
  Map<Object,Object> sessionAttributes=new HashMap<Object,Object>();
  sessionAttributes.put(SslFilter.DISABLE_ENCRYPTION_ONCE,true);
  internalExtendedResponse.put(VLDAPConstants.SESSION_ATTRIBUTES,sessionAttributes);
  return toList(internalExtendedResponse);
}
