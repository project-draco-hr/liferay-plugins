{
  KaleoTaskInstanceToken kaleoTaskInstanceToken=kaleoTaskInstanceTokenLocalService.getKaleoTaskInstanceToken(workflowTaskInstanceId);
  workflowContext=updateWorkflowContext(workflowContext,kaleoTaskInstanceToken);
  if (kaleoTaskInstanceToken.isCompleted()) {
    throw new WorkflowException("Cannot complete an already completed task " + workflowTaskInstanceId + " for user "+ serviceContext.getUserId());
  }
  serviceContext.setScopeGroupId(kaleoTaskInstanceToken.getGroupId());
  kaleoTaskInstanceToken=kaleoTaskInstanceTokenLocalService.completeKaleoTaskInstanceToken(kaleoTaskInstanceToken.getKaleoTaskInstanceTokenId(),serviceContext);
  kaleoLogLocalService.addTaskCompletionKaleoLog(kaleoTaskInstanceToken,comment,workflowContext,serviceContext);
  return new WorkflowTaskAdapter(kaleoTaskInstanceToken,workflowContext);
}
