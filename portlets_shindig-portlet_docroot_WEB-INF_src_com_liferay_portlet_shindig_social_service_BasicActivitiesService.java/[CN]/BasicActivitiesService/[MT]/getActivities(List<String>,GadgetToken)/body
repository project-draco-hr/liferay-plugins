{
  List<Activity> activities=new ArrayList<Activity>();
  try {
    User user=UserLocalServiceUtil.getUserById(Long.parseLong(token.getViewerId()));
    Company company=CompanyLocalServiceUtil.getCompanyById(user.getCompanyId());
    ThemeDisplay themeDisplay=new ThemeDisplay();
    themeDisplay.setCompany(company);
    themeDisplay.setLocale(user.getLocale());
    for (    String userId : userIds) {
      try {
        List<Activity> personActivities=new ArrayList<Activity>();
        List<SocialActivity> socialActivities=SocialActivityLocalServiceUtil.getUserActivities(Long.parseLong(userId),0,20);
        for (        SocialActivity socialActivity : socialActivities) {
          Activity activity=null;
          if (socialActivity.getClassName().equals(Activity.class.getName())) {
            activity=ShindigUtil.getActivity(socialActivity);
          }
 else {
            activity=new Activity(String.valueOf(socialActivity.getClassPK()),String.valueOf(socialActivity.getUserId()));
            SocialActivityFeedEntry socialActivityFeedEntry=SocialActivityInterpreterLocalServiceUtil.interpret(socialActivity,themeDisplay);
            activity.setBody(socialActivityFeedEntry.getBody());
            activity.setTitle(socialActivityFeedEntry.getTitle());
          }
          personActivities.add(activity);
        }
        activities.addAll(personActivities);
      }
 catch (      Exception e) {
        _log.error(e,e);
      }
    }
  }
 catch (  Exception e) {
    _log.error(e,e);
  }
  return new ResponseItem<List<Activity>>(activities);
}
