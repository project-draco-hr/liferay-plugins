{
  validateAccount(incomingHostName,incomingPort,incomingSecure,outgoingHostName,outgoingPort,outgoingSecure,login,password);
  try {
    AccountLocalServiceUtil.getAccount(user.getUserId(),address);
    throw new MailException("Address already exists");
  }
 catch (  NoSuchAccountException nsae) {
    long inboxFolderId=0;
    long draftFolderId=0;
    long sentFolderId=0;
    long trashFolderId=0;
    Account account=AccountLocalServiceUtil.addAccount(user.getUserId(),address,personalName,protocol,incomingHostName,incomingPort,incomingSecure,outgoingHostName,outgoingPort,outgoingSecure,login,password,savePassword,signature,useSignature,folderPrefix,inboxFolderId,draftFolderId,sentFolderId,trashFolderId,defaultSender);
    setAccount(account);
    synchronize();
    return account;
  }
}
